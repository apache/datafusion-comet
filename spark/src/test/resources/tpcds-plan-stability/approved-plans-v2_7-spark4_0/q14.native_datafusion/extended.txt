TakeOrderedAndProject
+- BroadcastHashJoin
   :- Filter
   :  :  +- Subquery
   :  :     +- HashAggregate
   :  :        +- CometNativeColumnarToRow
   :  :           +- CometColumnarExchange
   :  :              +- HashAggregate
   :  :                 +- Union
   :  :                    :- Project
   :  :                    :  +- BroadcastHashJoin
   :  :                    :     :- ColumnarToRow
   :  :                    :     :  +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :  :                    :     :        +- ReusedSubquery
   :  :                    :     +- BroadcastExchange
   :  :                    :        +- CometNativeColumnarToRow
   :  :                    :           +- CometProject
   :  :                    :              +- CometFilter
   :  :                    :                 +- CometNativeScan parquet spark_catalog.default.date_dim
   :  :                    :- Project
   :  :                    :  +- BroadcastHashJoin
   :  :                    :     :- ColumnarToRow
   :  :                    :     :  +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :  :                    :     :        +- ReusedSubquery
   :  :                    :     +- BroadcastExchange
   :  :                    :        +- CometNativeColumnarToRow
   :  :                    :           +- CometProject
   :  :                    :              +- CometFilter
   :  :                    :                 +- CometNativeScan parquet spark_catalog.default.date_dim
   :  :                    +- Project
   :  :                       +- BroadcastHashJoin
   :  :                          :- ColumnarToRow
   :  :                          :  +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :  :                          :        +- ReusedSubquery
   :  :                          +- BroadcastExchange
   :  :                             +- CometNativeColumnarToRow
   :  :                                +- CometProject
   :  :                                   +- CometFilter
   :  :                                      +- CometNativeScan parquet spark_catalog.default.date_dim
   :  +- HashAggregate
   :     +- CometNativeColumnarToRow
   :        +- CometColumnarExchange
   :           +- HashAggregate
   :              +- Project
   :                 +- BroadcastHashJoin
   :                    :- Project
   :                    :  +- BroadcastHashJoin
   :                    :     :- BroadcastHashJoin
   :                    :     :  :- Filter
   :                    :     :  :  +- ColumnarToRow
   :                    :     :  :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :                    :     :  :           +- SubqueryBroadcast
   :                    :     :  :              +- BroadcastExchange
   :                    :     :  :                 +- CometNativeColumnarToRow
   :                    :     :  :                    +- CometProject
   :                    :     :  :                       +- CometFilter
   :                    :     :  :                          :  +- ReusedSubquery
   :                    :     :  :                          +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    :     :  :                                +- Subquery
   :                    :     :  :                                   +- CometNativeColumnarToRow
   :                    :     :  :                                      +- CometProject
   :                    :     :  :                                         +- CometFilter
   :                    :     :  :                                            +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    :     :  +- BroadcastExchange
   :                    :     :     +- Project
   :                    :     :        +- BroadcastHashJoin
   :                    :     :           :- CometNativeColumnarToRow
   :                    :     :           :  +- CometFilter
   :                    :     :           :     +- CometNativeScan parquet spark_catalog.default.item
   :                    :     :           +- BroadcastExchange
   :                    :     :              +- BroadcastHashJoin
   :                    :     :                 :- CometNativeColumnarToRow
   :                    :     :                 :  +- CometHashAggregate
   :                    :     :                 :     +- CometColumnarExchange
   :                    :     :                 :        +- HashAggregate
   :                    :     :                 :           +- Project
   :                    :     :                 :              +- BroadcastHashJoin
   :                    :     :                 :                 :- Project
   :                    :     :                 :                 :  +- BroadcastHashJoin
   :                    :     :                 :                 :     :- Filter
   :                    :     :                 :                 :     :  +- ColumnarToRow
   :                    :     :                 :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :                    :     :                 :                 :     :           +- SubqueryBroadcast
   :                    :     :                 :                 :     :              +- BroadcastExchange
   :                    :     :                 :                 :     :                 +- CometNativeColumnarToRow
   :                    :     :                 :                 :     :                    +- CometProject
   :                    :     :                 :                 :     :                       +- CometFilter
   :                    :     :                 :                 :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    :     :                 :                 :     +- BroadcastExchange
   :                    :     :                 :                 :        +- BroadcastHashJoin
   :                    :     :                 :                 :           :- CometNativeColumnarToRow
   :                    :     :                 :                 :           :  +- CometFilter
   :                    :     :                 :                 :           :     +- CometNativeScan parquet spark_catalog.default.item
   :                    :     :                 :                 :           +- BroadcastExchange
   :                    :     :                 :                 :              +- Project
   :                    :     :                 :                 :                 +- BroadcastHashJoin
   :                    :     :                 :                 :                    :- Project
   :                    :     :                 :                 :                    :  +- BroadcastHashJoin
   :                    :     :                 :                 :                    :     :- Filter
   :                    :     :                 :                 :                    :     :  +- ColumnarToRow
   :                    :     :                 :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :                    :     :                 :                 :                    :     :           +- ReusedSubquery
   :                    :     :                 :                 :                    :     +- BroadcastExchange
   :                    :     :                 :                 :                    :        +- CometNativeColumnarToRow
   :                    :     :                 :                 :                    :           +- CometFilter
   :                    :     :                 :                 :                    :              +- CometNativeScan parquet spark_catalog.default.item
   :                    :     :                 :                 :                    +- BroadcastExchange
   :                    :     :                 :                 :                       +- CometNativeColumnarToRow
   :                    :     :                 :                 :                          +- CometProject
   :                    :     :                 :                 :                             +- CometFilter
   :                    :     :                 :                 :                                +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    :     :                 :                 +- BroadcastExchange
   :                    :     :                 :                    +- CometNativeColumnarToRow
   :                    :     :                 :                       +- CometProject
   :                    :     :                 :                          +- CometFilter
   :                    :     :                 :                             +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    :     :                 +- BroadcastExchange
   :                    :     :                    +- Project
   :                    :     :                       +- BroadcastHashJoin
   :                    :     :                          :- Project
   :                    :     :                          :  +- BroadcastHashJoin
   :                    :     :                          :     :- Filter
   :                    :     :                          :     :  +- ColumnarToRow
   :                    :     :                          :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :                    :     :                          :     :           +- ReusedSubquery
   :                    :     :                          :     +- BroadcastExchange
   :                    :     :                          :        +- CometNativeColumnarToRow
   :                    :     :                          :           +- CometFilter
   :                    :     :                          :              +- CometNativeScan parquet spark_catalog.default.item
   :                    :     :                          +- BroadcastExchange
   :                    :     :                             +- CometNativeColumnarToRow
   :                    :     :                                +- CometProject
   :                    :     :                                   +- CometFilter
   :                    :     :                                      +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    :     +- BroadcastExchange
   :                    :        +- BroadcastHashJoin
   :                    :           :- CometNativeColumnarToRow
   :                    :           :  +- CometFilter
   :                    :           :     +- CometNativeScan parquet spark_catalog.default.item
   :                    :           +- BroadcastExchange
   :                    :              +- Project
   :                    :                 +- BroadcastHashJoin
   :                    :                    :- CometNativeColumnarToRow
   :                    :                    :  +- CometFilter
   :                    :                    :     +- CometNativeScan parquet spark_catalog.default.item
   :                    :                    +- BroadcastExchange
   :                    :                       +- BroadcastHashJoin
   :                    :                          :- CometNativeColumnarToRow
   :                    :                          :  +- CometHashAggregate
   :                    :                          :     +- CometColumnarExchange
   :                    :                          :        +- HashAggregate
   :                    :                          :           +- Project
   :                    :                          :              +- BroadcastHashJoin
   :                    :                          :                 :- Project
   :                    :                          :                 :  +- BroadcastHashJoin
   :                    :                          :                 :     :- Filter
   :                    :                          :                 :     :  +- ColumnarToRow
   :                    :                          :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :                    :                          :                 :     :           +- SubqueryBroadcast
   :                    :                          :                 :     :              +- BroadcastExchange
   :                    :                          :                 :     :                 +- CometNativeColumnarToRow
   :                    :                          :                 :     :                    +- CometProject
   :                    :                          :                 :     :                       +- CometFilter
   :                    :                          :                 :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    :                          :                 :     +- BroadcastExchange
   :                    :                          :                 :        +- BroadcastHashJoin
   :                    :                          :                 :           :- CometNativeColumnarToRow
   :                    :                          :                 :           :  +- CometFilter
   :                    :                          :                 :           :     +- CometNativeScan parquet spark_catalog.default.item
   :                    :                          :                 :           +- BroadcastExchange
   :                    :                          :                 :              +- Project
   :                    :                          :                 :                 +- BroadcastHashJoin
   :                    :                          :                 :                    :- Project
   :                    :                          :                 :                    :  +- BroadcastHashJoin
   :                    :                          :                 :                    :     :- Filter
   :                    :                          :                 :                    :     :  +- ColumnarToRow
   :                    :                          :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :                    :                          :                 :                    :     :           +- ReusedSubquery
   :                    :                          :                 :                    :     +- BroadcastExchange
   :                    :                          :                 :                    :        +- CometNativeColumnarToRow
   :                    :                          :                 :                    :           +- CometFilter
   :                    :                          :                 :                    :              +- CometNativeScan parquet spark_catalog.default.item
   :                    :                          :                 :                    +- BroadcastExchange
   :                    :                          :                 :                       +- CometNativeColumnarToRow
   :                    :                          :                 :                          +- CometProject
   :                    :                          :                 :                             +- CometFilter
   :                    :                          :                 :                                +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    :                          :                 +- BroadcastExchange
   :                    :                          :                    +- CometNativeColumnarToRow
   :                    :                          :                       +- CometProject
   :                    :                          :                          +- CometFilter
   :                    :                          :                             +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    :                          +- BroadcastExchange
   :                    :                             +- Project
   :                    :                                +- BroadcastHashJoin
   :                    :                                   :- Project
   :                    :                                   :  +- BroadcastHashJoin
   :                    :                                   :     :- Filter
   :                    :                                   :     :  +- ColumnarToRow
   :                    :                                   :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
   :                    :                                   :     :           +- ReusedSubquery
   :                    :                                   :     +- BroadcastExchange
   :                    :                                   :        +- CometNativeColumnarToRow
   :                    :                                   :           +- CometFilter
   :                    :                                   :              +- CometNativeScan parquet spark_catalog.default.item
   :                    :                                   +- BroadcastExchange
   :                    :                                      +- CometNativeColumnarToRow
   :                    :                                         +- CometProject
   :                    :                                            +- CometFilter
   :                    :                                               +- CometNativeScan parquet spark_catalog.default.date_dim
   :                    +- BroadcastExchange
   :                       +- CometNativeColumnarToRow
   :                          +- CometProject
   :                             +- CometFilter
   :                                :  +- ReusedSubquery
   :                                +- CometNativeScan parquet spark_catalog.default.date_dim
   :                                      +- Subquery
   :                                         +- CometNativeColumnarToRow
   :                                            +- CometProject
   :                                               +- CometFilter
   :                                                  +- CometNativeScan parquet spark_catalog.default.date_dim
   +- BroadcastExchange
      +- Filter
         :  +- ReusedSubquery
         +- HashAggregate
            +- CometNativeColumnarToRow
               +- CometColumnarExchange
                  +- HashAggregate
                     +- Project
                        +- BroadcastHashJoin
                           :- Project
                           :  +- BroadcastHashJoin
                           :     :- BroadcastHashJoin
                           :     :  :- Filter
                           :     :  :  +- ColumnarToRow
                           :     :  :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :     :  :           +- SubqueryBroadcast
                           :     :  :              +- BroadcastExchange
                           :     :  :                 +- CometNativeColumnarToRow
                           :     :  :                    +- CometProject
                           :     :  :                       +- CometFilter
                           :     :  :                          :  +- ReusedSubquery
                           :     :  :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                           :     :  :                                +- Subquery
                           :     :  :                                   +- CometNativeColumnarToRow
                           :     :  :                                      +- CometProject
                           :     :  :                                         +- CometFilter
                           :     :  :                                            +- CometNativeScan parquet spark_catalog.default.date_dim
                           :     :  +- BroadcastExchange
                           :     :     +- Project
                           :     :        +- BroadcastHashJoin
                           :     :           :- CometNativeColumnarToRow
                           :     :           :  +- CometFilter
                           :     :           :     +- CometNativeScan parquet spark_catalog.default.item
                           :     :           +- BroadcastExchange
                           :     :              +- BroadcastHashJoin
                           :     :                 :- CometNativeColumnarToRow
                           :     :                 :  +- CometHashAggregate
                           :     :                 :     +- CometColumnarExchange
                           :     :                 :        +- HashAggregate
                           :     :                 :           +- Project
                           :     :                 :              +- BroadcastHashJoin
                           :     :                 :                 :- Project
                           :     :                 :                 :  +- BroadcastHashJoin
                           :     :                 :                 :     :- Filter
                           :     :                 :                 :     :  +- ColumnarToRow
                           :     :                 :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :     :                 :                 :     :           +- SubqueryBroadcast
                           :     :                 :                 :     :              +- BroadcastExchange
                           :     :                 :                 :     :                 +- CometNativeColumnarToRow
                           :     :                 :                 :     :                    +- CometProject
                           :     :                 :                 :     :                       +- CometFilter
                           :     :                 :                 :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                           :     :                 :                 :     +- BroadcastExchange
                           :     :                 :                 :        +- BroadcastHashJoin
                           :     :                 :                 :           :- CometNativeColumnarToRow
                           :     :                 :                 :           :  +- CometFilter
                           :     :                 :                 :           :     +- CometNativeScan parquet spark_catalog.default.item
                           :     :                 :                 :           +- BroadcastExchange
                           :     :                 :                 :              +- Project
                           :     :                 :                 :                 +- BroadcastHashJoin
                           :     :                 :                 :                    :- Project
                           :     :                 :                 :                    :  +- BroadcastHashJoin
                           :     :                 :                 :                    :     :- Filter
                           :     :                 :                 :                    :     :  +- ColumnarToRow
                           :     :                 :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :     :                 :                 :                    :     :           +- ReusedSubquery
                           :     :                 :                 :                    :     +- BroadcastExchange
                           :     :                 :                 :                    :        +- CometNativeColumnarToRow
                           :     :                 :                 :                    :           +- CometFilter
                           :     :                 :                 :                    :              +- CometNativeScan parquet spark_catalog.default.item
                           :     :                 :                 :                    +- BroadcastExchange
                           :     :                 :                 :                       +- CometNativeColumnarToRow
                           :     :                 :                 :                          +- CometProject
                           :     :                 :                 :                             +- CometFilter
                           :     :                 :                 :                                +- CometNativeScan parquet spark_catalog.default.date_dim
                           :     :                 :                 +- BroadcastExchange
                           :     :                 :                    +- CometNativeColumnarToRow
                           :     :                 :                       +- CometProject
                           :     :                 :                          +- CometFilter
                           :     :                 :                             +- CometNativeScan parquet spark_catalog.default.date_dim
                           :     :                 +- BroadcastExchange
                           :     :                    +- Project
                           :     :                       +- BroadcastHashJoin
                           :     :                          :- Project
                           :     :                          :  +- BroadcastHashJoin
                           :     :                          :     :- Filter
                           :     :                          :     :  +- ColumnarToRow
                           :     :                          :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :     :                          :     :           +- ReusedSubquery
                           :     :                          :     +- BroadcastExchange
                           :     :                          :        +- CometNativeColumnarToRow
                           :     :                          :           +- CometFilter
                           :     :                          :              +- CometNativeScan parquet spark_catalog.default.item
                           :     :                          +- BroadcastExchange
                           :     :                             +- CometNativeColumnarToRow
                           :     :                                +- CometProject
                           :     :                                   +- CometFilter
                           :     :                                      +- CometNativeScan parquet spark_catalog.default.date_dim
                           :     +- BroadcastExchange
                           :        +- BroadcastHashJoin
                           :           :- CometNativeColumnarToRow
                           :           :  +- CometFilter
                           :           :     +- CometNativeScan parquet spark_catalog.default.item
                           :           +- BroadcastExchange
                           :              +- Project
                           :                 +- BroadcastHashJoin
                           :                    :- CometNativeColumnarToRow
                           :                    :  +- CometFilter
                           :                    :     +- CometNativeScan parquet spark_catalog.default.item
                           :                    +- BroadcastExchange
                           :                       +- BroadcastHashJoin
                           :                          :- CometNativeColumnarToRow
                           :                          :  +- CometHashAggregate
                           :                          :     +- CometColumnarExchange
                           :                          :        +- HashAggregate
                           :                          :           +- Project
                           :                          :              +- BroadcastHashJoin
                           :                          :                 :- Project
                           :                          :                 :  +- BroadcastHashJoin
                           :                          :                 :     :- Filter
                           :                          :                 :     :  +- ColumnarToRow
                           :                          :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :                          :                 :     :           +- SubqueryBroadcast
                           :                          :                 :     :              +- BroadcastExchange
                           :                          :                 :     :                 +- CometNativeColumnarToRow
                           :                          :                 :     :                    +- CometProject
                           :                          :                 :     :                       +- CometFilter
                           :                          :                 :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                           :                          :                 :     +- BroadcastExchange
                           :                          :                 :        +- BroadcastHashJoin
                           :                          :                 :           :- CometNativeColumnarToRow
                           :                          :                 :           :  +- CometFilter
                           :                          :                 :           :     +- CometNativeScan parquet spark_catalog.default.item
                           :                          :                 :           +- BroadcastExchange
                           :                          :                 :              +- Project
                           :                          :                 :                 +- BroadcastHashJoin
                           :                          :                 :                    :- Project
                           :                          :                 :                    :  +- BroadcastHashJoin
                           :                          :                 :                    :     :- Filter
                           :                          :                 :                    :     :  +- ColumnarToRow
                           :                          :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :                          :                 :                    :     :           +- ReusedSubquery
                           :                          :                 :                    :     +- BroadcastExchange
                           :                          :                 :                    :        +- CometNativeColumnarToRow
                           :                          :                 :                    :           +- CometFilter
                           :                          :                 :                    :              +- CometNativeScan parquet spark_catalog.default.item
                           :                          :                 :                    +- BroadcastExchange
                           :                          :                 :                       +- CometNativeColumnarToRow
                           :                          :                 :                          +- CometProject
                           :                          :                 :                             +- CometFilter
                           :                          :                 :                                +- CometNativeScan parquet spark_catalog.default.date_dim
                           :                          :                 +- BroadcastExchange
                           :                          :                    +- CometNativeColumnarToRow
                           :                          :                       +- CometProject
                           :                          :                          +- CometFilter
                           :                          :                             +- CometNativeScan parquet spark_catalog.default.date_dim
                           :                          +- BroadcastExchange
                           :                             +- Project
                           :                                +- BroadcastHashJoin
                           :                                   :- Project
                           :                                   :  +- BroadcastHashJoin
                           :                                   :     :- Filter
                           :                                   :     :  +- ColumnarToRow
                           :                                   :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :                                   :     :           +- ReusedSubquery
                           :                                   :     +- BroadcastExchange
                           :                                   :        +- CometNativeColumnarToRow
                           :                                   :           +- CometFilter
                           :                                   :              +- CometNativeScan parquet spark_catalog.default.item
                           :                                   +- BroadcastExchange
                           :                                      +- CometNativeColumnarToRow
                           :                                         +- CometProject
                           :                                            +- CometFilter
                           :                                               +- CometNativeScan parquet spark_catalog.default.date_dim
                           +- BroadcastExchange
                              +- CometNativeColumnarToRow
                                 +- CometProject
                                    +- CometFilter
                                       :  +- ReusedSubquery
                                       +- CometNativeScan parquet spark_catalog.default.date_dim
                                             +- Subquery
                                                +- CometNativeColumnarToRow
                                                   +- CometProject
                                                      +- CometFilter
                                                         +- CometNativeScan parquet spark_catalog.default.date_dim

Comet accelerated 128 out of 337 eligible operators (37%). Final plan contains 69 transitions between Spark and Comet.