TakeOrderedAndProject
+- Filter
   +- HashAggregate
      +- HashAggregate
         +- Project
            +- BroadcastHashJoin
               :-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :  +- CometColumnarToRow
               :     +- CometSort
               :        +- CometExchange
               :           +- CometProject
               :              +- CometFilter
               :                 +- CometSortMergeJoin
               :                    :- CometSort
               :                    :  +- CometColumnarExchange
               :                    :     +- HashAggregate
               :                    :        +- CometColumnarToRow
               :                    :           +- CometColumnarExchange
               :                    :              +- HashAggregate
               :                    :                 +- Project
               :                    :                    +- BroadcastHashJoin
               :                    :                       :- Project
               :                    :                       :  +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :                    :                       :     +- CometColumnarToRow
               :                    :                       :        +- CometSort
               :                    :                       :           +- CometColumnarExchange
               :                    :                       :              +- HashAggregate
               :                    :                       :                 +- CometColumnarToRow
               :                    :                       :                    +- CometColumnarExchange
               :                    :                       :                       +- HashAggregate
               :                    :                       :                          +- Project
               :                    :                       :                             +- BroadcastHashJoin
               :                    :                       :                                :- Filter
               :                    :                       :                                :  +- ColumnarToRow
               :                    :                       :                                :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported]
               :                    :                       :                                :           +- SubqueryBroadcast
               :                    :                       :                                :              +- BroadcastExchange
               :                    :                       :                                :                 +- CometColumnarToRow
               :                    :                       :                                :                    +- CometProject
               :                    :                       :                                :                       +- CometFilter
               :                    :                       :                                :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
               :                    :                       :                                +- BroadcastExchange
               :                    :                       :                                   +- CometColumnarToRow
               :                    :                       :                                      +- CometProject
               :                    :                       :                                         +- CometFilter
               :                    :                       :                                            +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
               :                    :                       +- BroadcastExchange
               :                    :                          +- Project
               :                    :                             +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :                    :                                +- CometColumnarToRow
               :                    :                                   +- CometSort
               :                    :                                      +- CometColumnarExchange
               :                    :                                         +- HashAggregate
               :                    :                                            +- CometColumnarToRow
               :                    :                                               +- CometColumnarExchange
               :                    :                                                  +- HashAggregate
               :                    :                                                     +- Project
               :                    :                                                        +- BroadcastHashJoin
               :                    :                                                           :- Filter
               :                    :                                                           :  +- ColumnarToRow
               :                    :                                                           :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported]
               :                    :                                                           :           +- SubqueryBroadcast
               :                    :                                                           :              +- BroadcastExchange
               :                    :                                                           :                 +- CometColumnarToRow
               :                    :                                                           :                    +- CometProject
               :                    :                                                           :                       +- CometFilter
               :                    :                                                           :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
               :                    :                                                           +- BroadcastExchange
               :                    :                                                              +- CometColumnarToRow
               :                    :                                                                 +- CometProject
               :                    :                                                                    +- CometFilter
               :                    :                                                                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
               :                    +- CometSort
               :                       +- CometColumnarExchange
               :                          +- HashAggregate
               :                             +- CometColumnarToRow
               :                                +- CometColumnarExchange
               :                                   +- HashAggregate
               :                                      +- Project
               :                                         +- BroadcastHashJoin
               :                                            :- Project
               :                                            :  +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :                                            :     +- CometColumnarToRow
               :                                            :        +- CometSort
               :                                            :           +- CometColumnarExchange
               :                                            :              +- HashAggregate
               :                                            :                 +- CometColumnarToRow
               :                                            :                    +- CometColumnarExchange
               :                                            :                       +- HashAggregate
               :                                            :                          +- Project
               :                                            :                             +- BroadcastHashJoin
               :                                            :                                :- Filter
               :                                            :                                :  +- ColumnarToRow
               :                                            :                                :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported]
               :                                            :                                :           +- ReusedSubquery
               :                                            :                                +- BroadcastExchange
               :                                            :                                   +- CometColumnarToRow
               :                                            :                                      +- CometProject
               :                                            :                                         +- CometFilter
               :                                            :                                            +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
               :                                            +- BroadcastExchange
               :                                               +- Project
               :                                                  +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :                                                     +- CometColumnarToRow
               :                                                        +- CometSort
               :                                                           +- CometColumnarExchange
               :                                                              +- HashAggregate
               :                                                                 +- CometColumnarToRow
               :                                                                    +- CometColumnarExchange
               :                                                                       +- HashAggregate
               :                                                                          +- Project
               :                                                                             +- BroadcastHashJoin
               :                                                                                :- Filter
               :                                                                                :  +- ColumnarToRow
               :                                                                                :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported]
               :                                                                                :           +- ReusedSubquery
               :                                                                                +- BroadcastExchange
               :                                                                                   +- CometColumnarToRow
               :                                                                                      +- CometProject
               :                                                                                         +- CometFilter
               :                                                                                            +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
               +- BroadcastExchange
                  +- Project
                     +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                        +- CometColumnarToRow
                           +- CometSort
                              +- CometExchange
                                 +- CometProject
                                    +- CometFilter
                                       +- CometSortMergeJoin
                                          :- CometSort
                                          :  +- CometColumnarExchange
                                          :     +- HashAggregate
                                          :        +- CometColumnarToRow
                                          :           +- CometColumnarExchange
                                          :              +- HashAggregate
                                          :                 +- Project
                                          :                    +- BroadcastHashJoin
                                          :                       :- Project
                                          :                       :  +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                                          :                       :     +- CometColumnarToRow
                                          :                       :        +- CometSort
                                          :                       :           +- CometColumnarExchange
                                          :                       :              +- HashAggregate
                                          :                       :                 +- CometColumnarToRow
                                          :                       :                    +- CometColumnarExchange
                                          :                       :                       +- HashAggregate
                                          :                       :                          +- Project
                                          :                       :                             +- BroadcastHashJoin
                                          :                       :                                :- Filter
                                          :                       :                                :  +- ColumnarToRow
                                          :                       :                                :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported]
                                          :                       :                                :           +- SubqueryBroadcast
                                          :                       :                                :              +- BroadcastExchange
                                          :                       :                                :                 +- CometColumnarToRow
                                          :                       :                                :                    +- CometProject
                                          :                       :                                :                       +- CometFilter
                                          :                       :                                :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :                       :                                +- BroadcastExchange
                                          :                       :                                   +- CometColumnarToRow
                                          :                       :                                      +- CometProject
                                          :                       :                                         +- CometFilter
                                          :                       :                                            +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :                       +- BroadcastExchange
                                          :                          +- Project
                                          :                             +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                                          :                                +- CometColumnarToRow
                                          :                                   +- CometSort
                                          :                                      +- CometColumnarExchange
                                          :                                         +- HashAggregate
                                          :                                            +- CometColumnarToRow
                                          :                                               +- CometColumnarExchange
                                          :                                                  +- HashAggregate
                                          :                                                     +- Project
                                          :                                                        +- BroadcastHashJoin
                                          :                                                           :- Filter
                                          :                                                           :  +- ColumnarToRow
                                          :                                                           :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported]
                                          :                                                           :           +- SubqueryBroadcast
                                          :                                                           :              +- BroadcastExchange
                                          :                                                           :                 +- CometColumnarToRow
                                          :                                                           :                    +- CometProject
                                          :                                                           :                       +- CometFilter
                                          :                                                           :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :                                                           +- BroadcastExchange
                                          :                                                              +- CometColumnarToRow
                                          :                                                                 +- CometProject
                                          :                                                                    +- CometFilter
                                          :                                                                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          +- CometSort
                                             +- CometColumnarExchange
                                                +- HashAggregate
                                                   +- CometColumnarToRow
                                                      +- CometColumnarExchange
                                                         +- HashAggregate
                                                            +- Project
                                                               +- BroadcastHashJoin
                                                                  :- Project
                                                                  :  +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                                                                  :     +- CometColumnarToRow
                                                                  :        +- CometSort
                                                                  :           +- CometColumnarExchange
                                                                  :              +- HashAggregate
                                                                  :                 +- CometColumnarToRow
                                                                  :                    +- CometColumnarExchange
                                                                  :                       +- HashAggregate
                                                                  :                          +- Project
                                                                  :                             +- BroadcastHashJoin
                                                                  :                                :- Filter
                                                                  :                                :  +- ColumnarToRow
                                                                  :                                :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported]
                                                                  :                                :           +- ReusedSubquery
                                                                  :                                +- BroadcastExchange
                                                                  :                                   +- CometColumnarToRow
                                                                  :                                      +- CometProject
                                                                  :                                         +- CometFilter
                                                                  :                                            +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                                                  +- BroadcastExchange
                                                                     +- Project
                                                                        +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                                                                           +- CometColumnarToRow
                                                                              +- CometSort
                                                                                 +- CometColumnarExchange
                                                                                    +- HashAggregate
                                                                                       +- CometColumnarToRow
                                                                                          +- CometColumnarExchange
                                                                                             +- HashAggregate
                                                                                                +- Project
                                                                                                   +- BroadcastHashJoin
                                                                                                      :- Filter
                                                                                                      :  +- ColumnarToRow
                                                                                                      :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported]
                                                                                                      :           +- ReusedSubquery
                                                                                                      +- BroadcastExchange
                                                                                                         +- CometColumnarToRow
                                                                                                            +- CometProject
                                                                                                               +- CometFilter
                                                                                                                  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim

Comet accelerated 82 out of 196 eligible operators (41%). Final plan contains 42 transitions between Spark and Comet.