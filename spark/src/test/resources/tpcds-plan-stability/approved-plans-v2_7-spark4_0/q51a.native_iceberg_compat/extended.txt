CometColumnarToRow
+- CometTakeOrderedAndProject
   +- CometFilter
      +- CometHashAggregate
         +- CometHashAggregate
            +- CometProject
               +- CometBroadcastHashJoin
                  :- CometWindowExec
                  :  +- CometSort
                  :     +- CometExchange
                  :        +- CometProject
                  :           +- CometFilter
                  :              +- CometSortMergeJoin
                  :                 :- CometSort
                  :                 :  +- CometExchange
                  :                 :     +- CometHashAggregate
                  :                 :        +- CometExchange
                  :                 :           +- CometHashAggregate
                  :                 :              +- CometProject
                  :                 :                 +- CometBroadcastHashJoin
                  :                 :                    :- CometProject
                  :                 :                    :  +- CometWindowExec
                  :                 :                    :     +- CometSort
                  :                 :                    :        +- CometColumnarExchange
                  :                 :                    :           +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(ws_item_sk#1 AS item_sk#2, d_date#3, MakeDecimal(sum(UnscaledValue(ws_sales_price#4))#5,17,2) AS sumws#6, ws_item_sk#1)]
                  :                 :                    :              +- CometColumnarToRow
                  :                 :                    :                 +- CometExchange
                  :                 :                    :                    +- CometHashAggregate
                  :                 :                    :                       +- CometProject
                  :                 :                    :                          +- CometBroadcastHashJoin
                  :                 :                    :                             :- CometFilter
                  :                 :                    :                             :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_sales
                  :                 :                    :                             :        +- SubqueryBroadcast
                  :                 :                    :                             :           +- BroadcastExchange
                  :                 :                    :                             :              +- CometColumnarToRow
                  :                 :                    :                             :                 +- CometProject
                  :                 :                    :                             :                    +- CometFilter
                  :                 :                    :                             :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                 :                    :                             +- CometBroadcastExchange
                  :                 :                    :                                +- CometProject
                  :                 :                    :                                   +- CometFilter
                  :                 :                    :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                 :                    +- CometBroadcastExchange
                  :                 :                       +- CometProject
                  :                 :                          +- CometWindowExec
                  :                 :                             +- CometSort
                  :                 :                                +- CometColumnarExchange
                  :                 :                                   +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(ws_item_sk#1 AS item_sk#2, d_date#3, MakeDecimal(sum(UnscaledValue(ws_sales_price#4))#5,17,2) AS sumws#6, ws_item_sk#1)]
                  :                 :                                      +- CometColumnarToRow
                  :                 :                                         +- CometExchange
                  :                 :                                            +- CometHashAggregate
                  :                 :                                               +- CometProject
                  :                 :                                                  +- CometBroadcastHashJoin
                  :                 :                                                     :- CometFilter
                  :                 :                                                     :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_sales
                  :                 :                                                     :        +- SubqueryBroadcast
                  :                 :                                                     :           +- BroadcastExchange
                  :                 :                                                     :              +- CometColumnarToRow
                  :                 :                                                     :                 +- CometProject
                  :                 :                                                     :                    +- CometFilter
                  :                 :                                                     :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                 :                                                     +- CometBroadcastExchange
                  :                 :                                                        +- CometProject
                  :                 :                                                           +- CometFilter
                  :                 :                                                              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                 +- CometSort
                  :                    +- CometExchange
                  :                       +- CometHashAggregate
                  :                          +- CometExchange
                  :                             +- CometHashAggregate
                  :                                +- CometProject
                  :                                   +- CometBroadcastHashJoin
                  :                                      :- CometProject
                  :                                      :  +- CometWindowExec
                  :                                      :     +- CometSort
                  :                                      :        +- CometColumnarExchange
                  :                                      :           +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(ss_item_sk#7 AS item_sk#8, d_date#9, MakeDecimal(sum(UnscaledValue(ss_sales_price#10))#11,17,2) AS sumss#12, ss_item_sk#7)]
                  :                                      :              +- CometColumnarToRow
                  :                                      :                 +- CometExchange
                  :                                      :                    +- CometHashAggregate
                  :                                      :                       +- CometProject
                  :                                      :                          +- CometBroadcastHashJoin
                  :                                      :                             :- CometFilter
                  :                                      :                             :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                  :                                      :                             :        +- ReusedSubquery
                  :                                      :                             +- CometBroadcastExchange
                  :                                      :                                +- CometProject
                  :                                      :                                   +- CometFilter
                  :                                      :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                                      +- CometBroadcastExchange
                  :                                         +- CometProject
                  :                                            +- CometWindowExec
                  :                                               +- CometSort
                  :                                                  +- CometColumnarExchange
                  :                                                     +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(ss_item_sk#7 AS item_sk#8, d_date#9, MakeDecimal(sum(UnscaledValue(ss_sales_price#10))#11,17,2) AS sumss#12, ss_item_sk#7)]
                  :                                                        +- CometColumnarToRow
                  :                                                           +- CometExchange
                  :                                                              +- CometHashAggregate
                  :                                                                 +- CometProject
                  :                                                                    +- CometBroadcastHashJoin
                  :                                                                       :- CometFilter
                  :                                                                       :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                  :                                                                       :        +- ReusedSubquery
                  :                                                                       +- CometBroadcastExchange
                  :                                                                          +- CometProject
                  :                                                                             +- CometFilter
                  :                                                                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  +- CometBroadcastExchange
                     +- CometProject
                        +- CometWindowExec
                           +- CometSort
                              +- CometExchange
                                 +- CometProject
                                    +- CometFilter
                                       +- CometSortMergeJoin
                                          :- CometSort
                                          :  +- CometExchange
                                          :     +- CometHashAggregate
                                          :        +- CometExchange
                                          :           +- CometHashAggregate
                                          :              +- CometProject
                                          :                 +- CometBroadcastHashJoin
                                          :                    :- CometProject
                                          :                    :  +- CometWindowExec
                                          :                    :     +- CometSort
                                          :                    :        +- CometColumnarExchange
                                          :                    :           +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(ws_item_sk#1 AS item_sk#2, d_date#3, MakeDecimal(sum(UnscaledValue(ws_sales_price#4))#5,17,2) AS sumws#6, ws_item_sk#1)]
                                          :                    :              +- CometColumnarToRow
                                          :                    :                 +- CometExchange
                                          :                    :                    +- CometHashAggregate
                                          :                    :                       +- CometProject
                                          :                    :                          +- CometBroadcastHashJoin
                                          :                    :                             :- CometFilter
                                          :                    :                             :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_sales
                                          :                    :                             :        +- SubqueryBroadcast
                                          :                    :                             :           +- BroadcastExchange
                                          :                    :                             :              +- CometColumnarToRow
                                          :                    :                             :                 +- CometProject
                                          :                    :                             :                    +- CometFilter
                                          :                    :                             :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :                    :                             +- CometBroadcastExchange
                                          :                    :                                +- CometProject
                                          :                    :                                   +- CometFilter
                                          :                    :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :                    +- CometBroadcastExchange
                                          :                       +- CometProject
                                          :                          +- CometWindowExec
                                          :                             +- CometSort
                                          :                                +- CometColumnarExchange
                                          :                                   +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(ws_item_sk#1 AS item_sk#2, d_date#3, MakeDecimal(sum(UnscaledValue(ws_sales_price#4))#5,17,2) AS sumws#6, ws_item_sk#1)]
                                          :                                      +- CometColumnarToRow
                                          :                                         +- CometExchange
                                          :                                            +- CometHashAggregate
                                          :                                               +- CometProject
                                          :                                                  +- CometBroadcastHashJoin
                                          :                                                     :- CometFilter
                                          :                                                     :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_sales
                                          :                                                     :        +- SubqueryBroadcast
                                          :                                                     :           +- BroadcastExchange
                                          :                                                     :              +- CometColumnarToRow
                                          :                                                     :                 +- CometProject
                                          :                                                     :                    +- CometFilter
                                          :                                                     :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :                                                     +- CometBroadcastExchange
                                          :                                                        +- CometProject
                                          :                                                           +- CometFilter
                                          :                                                              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          +- CometSort
                                             +- CometExchange
                                                +- CometHashAggregate
                                                   +- CometExchange
                                                      +- CometHashAggregate
                                                         +- CometProject
                                                            +- CometBroadcastHashJoin
                                                               :- CometProject
                                                               :  +- CometWindowExec
                                                               :     +- CometSort
                                                               :        +- CometColumnarExchange
                                                               :           +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(ss_item_sk#7 AS item_sk#8, d_date#9, MakeDecimal(sum(UnscaledValue(ss_sales_price#10))#11,17,2) AS sumss#12, ss_item_sk#7)]
                                                               :              +- CometColumnarToRow
                                                               :                 +- CometExchange
                                                               :                    +- CometHashAggregate
                                                               :                       +- CometProject
                                                               :                          +- CometBroadcastHashJoin
                                                               :                             :- CometFilter
                                                               :                             :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                                                               :                             :        +- ReusedSubquery
                                                               :                             +- CometBroadcastExchange
                                                               :                                +- CometProject
                                                               :                                   +- CometFilter
                                                               :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                                               +- CometBroadcastExchange
                                                                  +- CometProject
                                                                     +- CometWindowExec
                                                                        +- CometSort
                                                                           +- CometColumnarExchange
                                                                              +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(ss_item_sk#7 AS item_sk#8, d_date#9, MakeDecimal(sum(UnscaledValue(ss_sales_price#10))#11,17,2) AS sumss#12, ss_item_sk#7)]
                                                                                 +- CometColumnarToRow
                                                                                    +- CometExchange
                                                                                       +- CometHashAggregate
                                                                                          +- CometProject
                                                                                             +- CometBroadcastHashJoin
                                                                                                :- CometFilter
                                                                                                :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                                                                                                :        +- ReusedSubquery
                                                                                                +- CometBroadcastExchange
                                                                                                   +- CometProject
                                                                                                      +- CometFilter
                                                                                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim

Comet accelerated 176 out of 196 eligible operators (89%). Final plan contains 13 transitions between Spark and Comet.