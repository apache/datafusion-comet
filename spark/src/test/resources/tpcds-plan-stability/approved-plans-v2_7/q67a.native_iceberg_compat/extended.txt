TakeOrderedAndProject
+- Filter
   +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
      +- CometColumnarToRow
         +- CometSort
            +- CometColumnarExchange
               +- Union
                  :- HashAggregate
                  :  +- CometColumnarToRow
                  :     +- CometColumnarExchange
                  :        +- HashAggregate
                  :           +- Project
                  :              +- BroadcastHashJoin
                  :                 :- Project
                  :                 :  +- BroadcastHashJoin
                  :                 :     :- Project
                  :                 :     :  +- BroadcastHashJoin
                  :                 :     :     :- Filter
                  :                 :     :     :  +- ColumnarToRow
                  :                 :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                 :     :     :           +- SubqueryBroadcast
                  :                 :     :     :              +- CometColumnarToRow
                  :                 :     :     :                 +- CometBroadcastExchange
                  :                 :     :     :                    +- CometProject
                  :                 :     :     :                       +- CometFilter
                  :                 :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                 :     :     +- BroadcastExchange
                  :                 :     :        +- CometColumnarToRow
                  :                 :     :           +- CometProject
                  :                 :     :              +- CometFilter
                  :                 :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                 :     +- BroadcastExchange
                  :                 :        +- CometColumnarToRow
                  :                 :           +- CometProject
                  :                 :              +- CometFilter
                  :                 :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :                 +- BroadcastExchange
                  :                    +- CometColumnarToRow
                  :                       +- CometProject
                  :                          +- CometFilter
                  :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :- HashAggregate
                  :  +- CometColumnarToRow
                  :     +- CometColumnarExchange
                  :        +- HashAggregate
                  :           +- HashAggregate
                  :              +- CometColumnarToRow
                  :                 +- CometColumnarExchange
                  :                    +- HashAggregate
                  :                       +- Project
                  :                          +- BroadcastHashJoin
                  :                             :- Project
                  :                             :  +- BroadcastHashJoin
                  :                             :     :- Project
                  :                             :     :  +- BroadcastHashJoin
                  :                             :     :     :- Filter
                  :                             :     :     :  +- ColumnarToRow
                  :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                             :     :     :           +- SubqueryBroadcast
                  :                             :     :     :              +- CometColumnarToRow
                  :                             :     :     :                 +- CometBroadcastExchange
                  :                             :     :     :                    +- CometProject
                  :                             :     :     :                       +- CometFilter
                  :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     :     +- BroadcastExchange
                  :                             :     :        +- CometColumnarToRow
                  :                             :     :           +- CometProject
                  :                             :     :              +- CometFilter
                  :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     +- BroadcastExchange
                  :                             :        +- CometColumnarToRow
                  :                             :           +- CometProject
                  :                             :              +- CometFilter
                  :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :                             +- BroadcastExchange
                  :                                +- CometColumnarToRow
                  :                                   +- CometProject
                  :                                      +- CometFilter
                  :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :- HashAggregate
                  :  +- CometColumnarToRow
                  :     +- CometColumnarExchange
                  :        +- HashAggregate
                  :           +- HashAggregate
                  :              +- CometColumnarToRow
                  :                 +- CometColumnarExchange
                  :                    +- HashAggregate
                  :                       +- Project
                  :                          +- BroadcastHashJoin
                  :                             :- Project
                  :                             :  +- BroadcastHashJoin
                  :                             :     :- Project
                  :                             :     :  +- BroadcastHashJoin
                  :                             :     :     :- Filter
                  :                             :     :     :  +- ColumnarToRow
                  :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                             :     :     :           +- SubqueryBroadcast
                  :                             :     :     :              +- CometColumnarToRow
                  :                             :     :     :                 +- CometBroadcastExchange
                  :                             :     :     :                    +- CometProject
                  :                             :     :     :                       +- CometFilter
                  :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     :     +- BroadcastExchange
                  :                             :     :        +- CometColumnarToRow
                  :                             :     :           +- CometProject
                  :                             :     :              +- CometFilter
                  :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     +- BroadcastExchange
                  :                             :        +- CometColumnarToRow
                  :                             :           +- CometProject
                  :                             :              +- CometFilter
                  :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :                             +- BroadcastExchange
                  :                                +- CometColumnarToRow
                  :                                   +- CometProject
                  :                                      +- CometFilter
                  :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :- HashAggregate
                  :  +- CometColumnarToRow
                  :     +- CometColumnarExchange
                  :        +- HashAggregate
                  :           +- HashAggregate
                  :              +- CometColumnarToRow
                  :                 +- CometColumnarExchange
                  :                    +- HashAggregate
                  :                       +- Project
                  :                          +- BroadcastHashJoin
                  :                             :- Project
                  :                             :  +- BroadcastHashJoin
                  :                             :     :- Project
                  :                             :     :  +- BroadcastHashJoin
                  :                             :     :     :- Filter
                  :                             :     :     :  +- ColumnarToRow
                  :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                             :     :     :           +- SubqueryBroadcast
                  :                             :     :     :              +- CometColumnarToRow
                  :                             :     :     :                 +- CometBroadcastExchange
                  :                             :     :     :                    +- CometProject
                  :                             :     :     :                       +- CometFilter
                  :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     :     +- BroadcastExchange
                  :                             :     :        +- CometColumnarToRow
                  :                             :     :           +- CometProject
                  :                             :     :              +- CometFilter
                  :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     +- BroadcastExchange
                  :                             :        +- CometColumnarToRow
                  :                             :           +- CometProject
                  :                             :              +- CometFilter
                  :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :                             +- BroadcastExchange
                  :                                +- CometColumnarToRow
                  :                                   +- CometProject
                  :                                      +- CometFilter
                  :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :- HashAggregate
                  :  +- CometColumnarToRow
                  :     +- CometColumnarExchange
                  :        +- HashAggregate
                  :           +- HashAggregate
                  :              +- CometColumnarToRow
                  :                 +- CometColumnarExchange
                  :                    +- HashAggregate
                  :                       +- Project
                  :                          +- BroadcastHashJoin
                  :                             :- Project
                  :                             :  +- BroadcastHashJoin
                  :                             :     :- Project
                  :                             :     :  +- BroadcastHashJoin
                  :                             :     :     :- Filter
                  :                             :     :     :  +- ColumnarToRow
                  :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                             :     :     :           +- SubqueryBroadcast
                  :                             :     :     :              +- CometColumnarToRow
                  :                             :     :     :                 +- CometBroadcastExchange
                  :                             :     :     :                    +- CometProject
                  :                             :     :     :                       +- CometFilter
                  :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     :     +- BroadcastExchange
                  :                             :     :        +- CometColumnarToRow
                  :                             :     :           +- CometProject
                  :                             :     :              +- CometFilter
                  :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     +- BroadcastExchange
                  :                             :        +- CometColumnarToRow
                  :                             :           +- CometProject
                  :                             :              +- CometFilter
                  :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :                             +- BroadcastExchange
                  :                                +- CometColumnarToRow
                  :                                   +- CometProject
                  :                                      +- CometFilter
                  :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :- HashAggregate
                  :  +- CometColumnarToRow
                  :     +- CometColumnarExchange
                  :        +- HashAggregate
                  :           +- HashAggregate
                  :              +- CometColumnarToRow
                  :                 +- CometColumnarExchange
                  :                    +- HashAggregate
                  :                       +- Project
                  :                          +- BroadcastHashJoin
                  :                             :- Project
                  :                             :  +- BroadcastHashJoin
                  :                             :     :- Project
                  :                             :     :  +- BroadcastHashJoin
                  :                             :     :     :- Filter
                  :                             :     :     :  +- ColumnarToRow
                  :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                             :     :     :           +- SubqueryBroadcast
                  :                             :     :     :              +- CometColumnarToRow
                  :                             :     :     :                 +- CometBroadcastExchange
                  :                             :     :     :                    +- CometProject
                  :                             :     :     :                       +- CometFilter
                  :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     :     +- BroadcastExchange
                  :                             :     :        +- CometColumnarToRow
                  :                             :     :           +- CometProject
                  :                             :     :              +- CometFilter
                  :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     +- BroadcastExchange
                  :                             :        +- CometColumnarToRow
                  :                             :           +- CometProject
                  :                             :              +- CometFilter
                  :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :                             +- BroadcastExchange
                  :                                +- CometColumnarToRow
                  :                                   +- CometProject
                  :                                      +- CometFilter
                  :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :- HashAggregate
                  :  +- CometColumnarToRow
                  :     +- CometColumnarExchange
                  :        +- HashAggregate
                  :           +- HashAggregate
                  :              +- CometColumnarToRow
                  :                 +- CometColumnarExchange
                  :                    +- HashAggregate
                  :                       +- Project
                  :                          +- BroadcastHashJoin
                  :                             :- Project
                  :                             :  +- BroadcastHashJoin
                  :                             :     :- Project
                  :                             :     :  +- BroadcastHashJoin
                  :                             :     :     :- Filter
                  :                             :     :     :  +- ColumnarToRow
                  :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                             :     :     :           +- SubqueryBroadcast
                  :                             :     :     :              +- CometColumnarToRow
                  :                             :     :     :                 +- CometBroadcastExchange
                  :                             :     :     :                    +- CometProject
                  :                             :     :     :                       +- CometFilter
                  :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     :     +- BroadcastExchange
                  :                             :     :        +- CometColumnarToRow
                  :                             :     :           +- CometProject
                  :                             :     :              +- CometFilter
                  :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     +- BroadcastExchange
                  :                             :        +- CometColumnarToRow
                  :                             :           +- CometProject
                  :                             :              +- CometFilter
                  :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :                             +- BroadcastExchange
                  :                                +- CometColumnarToRow
                  :                                   +- CometProject
                  :                                      +- CometFilter
                  :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :- HashAggregate
                  :  +- CometColumnarToRow
                  :     +- CometColumnarExchange
                  :        +- HashAggregate
                  :           +- HashAggregate
                  :              +- CometColumnarToRow
                  :                 +- CometColumnarExchange
                  :                    +- HashAggregate
                  :                       +- Project
                  :                          +- BroadcastHashJoin
                  :                             :- Project
                  :                             :  +- BroadcastHashJoin
                  :                             :     :- Project
                  :                             :     :  +- BroadcastHashJoin
                  :                             :     :     :- Filter
                  :                             :     :     :  +- ColumnarToRow
                  :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                             :     :     :           +- SubqueryBroadcast
                  :                             :     :     :              +- CometColumnarToRow
                  :                             :     :     :                 +- CometBroadcastExchange
                  :                             :     :     :                    +- CometProject
                  :                             :     :     :                       +- CometFilter
                  :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     :     +- BroadcastExchange
                  :                             :     :        +- CometColumnarToRow
                  :                             :     :           +- CometProject
                  :                             :     :              +- CometFilter
                  :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                             :     +- BroadcastExchange
                  :                             :        +- CometColumnarToRow
                  :                             :           +- CometProject
                  :                             :              +- CometFilter
                  :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :                             +- BroadcastExchange
                  :                                +- CometColumnarToRow
                  :                                   +- CometProject
                  :                                      +- CometFilter
                  :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  +- HashAggregate
                     +- CometColumnarToRow
                        +- CometColumnarExchange
                           +- HashAggregate
                              +- HashAggregate
                                 +- CometColumnarToRow
                                    +- CometColumnarExchange
                                       +- HashAggregate
                                          +- Project
                                             +- BroadcastHashJoin
                                                :- Project
                                                :  +- BroadcastHashJoin
                                                :     :- Project
                                                :     :  +- BroadcastHashJoin
                                                :     :     :- Filter
                                                :     :     :  +- ColumnarToRow
                                                :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                                :     :     :           +- SubqueryBroadcast
                                                :     :     :              +- CometColumnarToRow
                                                :     :     :                 +- CometBroadcastExchange
                                                :     :     :                    +- CometProject
                                                :     :     :                       +- CometFilter
                                                :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                                :     :     +- BroadcastExchange
                                                :     :        +- CometColumnarToRow
                                                :     :           +- CometProject
                                                :     :              +- CometFilter
                                                :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                                :     +- BroadcastExchange
                                                :        +- CometColumnarToRow
                                                :           +- CometProject
                                                :              +- CometFilter
                                                :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                                                +- BroadcastExchange
                                                   +- CometColumnarToRow
                                                      +- CometProject
                                                         +- CometFilter
                                                            +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item

Comet accelerated 136 out of 282 eligible operators (48%). Final plan contains 63 transitions between Spark and Comet.