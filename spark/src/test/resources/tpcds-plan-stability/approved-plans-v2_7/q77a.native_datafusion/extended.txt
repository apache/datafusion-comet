CometColumnarToRow
+- CometTakeOrderedAndProject
   +- CometHashAggregate
      +- CometColumnarExchange
         +- HashAggregate
            +- Union
               :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :  +- CometColumnarToRow
               :     +- CometColumnarExchange
               :        +- HashAggregate
               :           +- Union
               :              :- Project
               :              :  +- BroadcastHashJoin
               :              :     :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :              :     :  +- CometColumnarToRow
               :              :     :     +- CometColumnarExchange
               :              :     :        +- HashAggregate
               :              :     :           +- Project
               :              :     :              +- BroadcastHashJoin
               :              :     :                 :- Project
               :              :     :                 :  +- BroadcastHashJoin
               :              :     :                 :     :- Filter
               :              :     :                 :     :  +- ColumnarToRow
               :              :     :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :              :     :                 :     :           +- SubqueryBroadcast
               :              :     :                 :     :              +- BroadcastExchange
               :              :     :                 :     :                 +- CometColumnarToRow
               :              :     :                 :     :                    +- CometProject
               :              :     :                 :     :                       +- CometFilter
               :              :     :                 :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
               :              :     :                 :     +- BroadcastExchange
               :              :     :                 :        +- CometColumnarToRow
               :              :     :                 :           +- CometProject
               :              :     :                 :              +- CometFilter
               :              :     :                 :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :              :     :                 +- BroadcastExchange
               :              :     :                    +- CometColumnarToRow
               :              :     :                       +- CometFilter
               :              :     :                          +- CometNativeScan parquet spark_catalog.default.store
               :              :     +- BroadcastExchange
               :              :        +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :              :           +- CometColumnarToRow
               :              :              +- CometColumnarExchange
               :              :                 +- HashAggregate
               :              :                    +- Project
               :              :                       +- BroadcastHashJoin
               :              :                          :- Project
               :              :                          :  +- BroadcastHashJoin
               :              :                          :     :- Filter
               :              :                          :     :  +- ColumnarToRow
               :              :                          :     :     +-  Scan parquet spark_catalog.default.store_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :              :                          :     :           +- ReusedSubquery
               :              :                          :     +- BroadcastExchange
               :              :                          :        +- CometColumnarToRow
               :              :                          :           +- CometProject
               :              :                          :              +- CometFilter
               :              :                          :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :              :                          +- BroadcastExchange
               :              :                             +- CometColumnarToRow
               :              :                                +- CometFilter
               :              :                                   +- CometNativeScan parquet spark_catalog.default.store
               :              :- Project
               :              :  +- BroadcastNestedLoopJoin
               :              :     :- BroadcastExchange
               :              :     :  +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :              :     :     +- CometColumnarToRow
               :              :     :        +- CometColumnarExchange
               :              :     :           +- HashAggregate
               :              :     :              +- Project
               :              :     :                 +- BroadcastHashJoin
               :              :     :                    :- ColumnarToRow
               :              :     :                    :  +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :              :     :                    :        +- ReusedSubquery
               :              :     :                    +- BroadcastExchange
               :              :     :                       +- CometColumnarToRow
               :              :     :                          +- CometProject
               :              :     :                             +- CometFilter
               :              :     :                                +- CometNativeScan parquet spark_catalog.default.date_dim
               :              :     +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :              :        +- CometColumnarToRow
               :              :           +- CometColumnarExchange
               :              :              +- HashAggregate
               :              :                 +- Project
               :              :                    +- BroadcastHashJoin
               :              :                       :- ColumnarToRow
               :              :                       :  +-  Scan parquet spark_catalog.default.catalog_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :              :                       :        +- ReusedSubquery
               :              :                       +- BroadcastExchange
               :              :                          +- CometColumnarToRow
               :              :                             +- CometProject
               :              :                                +- CometFilter
               :              :                                   +- CometNativeScan parquet spark_catalog.default.date_dim
               :              +- Project
               :                 +- BroadcastHashJoin
               :                    :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :                    :  +- CometColumnarToRow
               :                    :     +- CometColumnarExchange
               :                    :        +- HashAggregate
               :                    :           +- Project
               :                    :              +- BroadcastHashJoin
               :                    :                 :- Project
               :                    :                 :  +- BroadcastHashJoin
               :                    :                 :     :- Filter
               :                    :                 :     :  +- ColumnarToRow
               :                    :                 :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                    :                 :     :           +- ReusedSubquery
               :                    :                 :     +- BroadcastExchange
               :                    :                 :        +- CometColumnarToRow
               :                    :                 :           +- CometProject
               :                    :                 :              +- CometFilter
               :                    :                 :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                    :                 +- BroadcastExchange
               :                    :                    +- CometColumnarToRow
               :                    :                       +- CometFilter
               :                    :                          +- CometNativeScan parquet spark_catalog.default.web_page
               :                    +- BroadcastExchange
               :                       +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :                          +- CometColumnarToRow
               :                             +- CometColumnarExchange
               :                                +- HashAggregate
               :                                   +- Project
               :                                      +- BroadcastHashJoin
               :                                         :- Project
               :                                         :  +- BroadcastHashJoin
               :                                         :     :- Filter
               :                                         :     :  +- ColumnarToRow
               :                                         :     :     +-  Scan parquet spark_catalog.default.web_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                                         :     :           +- ReusedSubquery
               :                                         :     +- BroadcastExchange
               :                                         :        +- CometColumnarToRow
               :                                         :           +- CometProject
               :                                         :              +- CometFilter
               :                                         :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                                         +- BroadcastExchange
               :                                            +- CometColumnarToRow
               :                                               +- CometFilter
               :                                                  +- CometNativeScan parquet spark_catalog.default.web_page
               :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :  +- CometColumnarToRow
               :     +- CometColumnarExchange
               :        +- HashAggregate
               :           +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :              +- CometColumnarToRow
               :                 +- CometColumnarExchange
               :                    +- HashAggregate
               :                       +- Union
               :                          :- Project
               :                          :  +- BroadcastHashJoin
               :                          :     :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :                          :     :  +- CometColumnarToRow
               :                          :     :     +- CometColumnarExchange
               :                          :     :        +- HashAggregate
               :                          :     :           +- Project
               :                          :     :              +- BroadcastHashJoin
               :                          :     :                 :- Project
               :                          :     :                 :  +- BroadcastHashJoin
               :                          :     :                 :     :- Filter
               :                          :     :                 :     :  +- ColumnarToRow
               :                          :     :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                          :     :                 :     :           +- SubqueryBroadcast
               :                          :     :                 :     :              +- BroadcastExchange
               :                          :     :                 :     :                 +- CometColumnarToRow
               :                          :     :                 :     :                    +- CometProject
               :                          :     :                 :     :                       +- CometFilter
               :                          :     :                 :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
               :                          :     :                 :     +- BroadcastExchange
               :                          :     :                 :        +- CometColumnarToRow
               :                          :     :                 :           +- CometProject
               :                          :     :                 :              +- CometFilter
               :                          :     :                 :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                          :     :                 +- BroadcastExchange
               :                          :     :                    +- CometColumnarToRow
               :                          :     :                       +- CometFilter
               :                          :     :                          +- CometNativeScan parquet spark_catalog.default.store
               :                          :     +- BroadcastExchange
               :                          :        +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :                          :           +- CometColumnarToRow
               :                          :              +- CometColumnarExchange
               :                          :                 +- HashAggregate
               :                          :                    +- Project
               :                          :                       +- BroadcastHashJoin
               :                          :                          :- Project
               :                          :                          :  +- BroadcastHashJoin
               :                          :                          :     :- Filter
               :                          :                          :     :  +- ColumnarToRow
               :                          :                          :     :     +-  Scan parquet spark_catalog.default.store_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                          :                          :     :           +- ReusedSubquery
               :                          :                          :     +- BroadcastExchange
               :                          :                          :        +- CometColumnarToRow
               :                          :                          :           +- CometProject
               :                          :                          :              +- CometFilter
               :                          :                          :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                          :                          +- BroadcastExchange
               :                          :                             +- CometColumnarToRow
               :                          :                                +- CometFilter
               :                          :                                   +- CometNativeScan parquet spark_catalog.default.store
               :                          :- Project
               :                          :  +- BroadcastNestedLoopJoin
               :                          :     :- BroadcastExchange
               :                          :     :  +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :                          :     :     +- CometColumnarToRow
               :                          :     :        +- CometColumnarExchange
               :                          :     :           +- HashAggregate
               :                          :     :              +- Project
               :                          :     :                 +- BroadcastHashJoin
               :                          :     :                    :- ColumnarToRow
               :                          :     :                    :  +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                          :     :                    :        +- ReusedSubquery
               :                          :     :                    +- BroadcastExchange
               :                          :     :                       +- CometColumnarToRow
               :                          :     :                          +- CometProject
               :                          :     :                             +- CometFilter
               :                          :     :                                +- CometNativeScan parquet spark_catalog.default.date_dim
               :                          :     +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :                          :        +- CometColumnarToRow
               :                          :           +- CometColumnarExchange
               :                          :              +- HashAggregate
               :                          :                 +- Project
               :                          :                    +- BroadcastHashJoin
               :                          :                       :- ColumnarToRow
               :                          :                       :  +-  Scan parquet spark_catalog.default.catalog_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                          :                       :        +- ReusedSubquery
               :                          :                       +- BroadcastExchange
               :                          :                          +- CometColumnarToRow
               :                          :                             +- CometProject
               :                          :                                +- CometFilter
               :                          :                                   +- CometNativeScan parquet spark_catalog.default.date_dim
               :                          +- Project
               :                             +- BroadcastHashJoin
               :                                :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :                                :  +- CometColumnarToRow
               :                                :     +- CometColumnarExchange
               :                                :        +- HashAggregate
               :                                :           +- Project
               :                                :              +- BroadcastHashJoin
               :                                :                 :- Project
               :                                :                 :  +- BroadcastHashJoin
               :                                :                 :     :- Filter
               :                                :                 :     :  +- ColumnarToRow
               :                                :                 :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                                :                 :     :           +- ReusedSubquery
               :                                :                 :     +- BroadcastExchange
               :                                :                 :        +- CometColumnarToRow
               :                                :                 :           +- CometProject
               :                                :                 :              +- CometFilter
               :                                :                 :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                                :                 +- BroadcastExchange
               :                                :                    +- CometColumnarToRow
               :                                :                       +- CometFilter
               :                                :                          +- CometNativeScan parquet spark_catalog.default.web_page
               :                                +- BroadcastExchange
               :                                   +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
               :                                      +- CometColumnarToRow
               :                                         +- CometColumnarExchange
               :                                            +- HashAggregate
               :                                               +- Project
               :                                                  +- BroadcastHashJoin
               :                                                     :- Project
               :                                                     :  +- BroadcastHashJoin
               :                                                     :     :- Filter
               :                                                     :     :  +- ColumnarToRow
               :                                                     :     :     +-  Scan parquet spark_catalog.default.web_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                                                     :     :           +- ReusedSubquery
               :                                                     :     +- BroadcastExchange
               :                                                     :        +- CometColumnarToRow
               :                                                     :           +- CometProject
               :                                                     :              +- CometFilter
               :                                                     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                                                     +- BroadcastExchange
               :                                                        +- CometColumnarToRow
               :                                                           +- CometFilter
               :                                                              +- CometNativeScan parquet spark_catalog.default.web_page
               +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                  +- CometColumnarToRow
                     +- CometColumnarExchange
                        +- HashAggregate
                           +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                              +- CometColumnarToRow
                                 +- CometColumnarExchange
                                    +- HashAggregate
                                       +- Union
                                          :- Project
                                          :  +- BroadcastHashJoin
                                          :     :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                                          :     :  +- CometColumnarToRow
                                          :     :     +- CometColumnarExchange
                                          :     :        +- HashAggregate
                                          :     :           +- Project
                                          :     :              +- BroadcastHashJoin
                                          :     :                 :- Project
                                          :     :                 :  +- BroadcastHashJoin
                                          :     :                 :     :- Filter
                                          :     :                 :     :  +- ColumnarToRow
                                          :     :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                          :     :                 :     :           +- SubqueryBroadcast
                                          :     :                 :     :              +- BroadcastExchange
                                          :     :                 :     :                 +- CometColumnarToRow
                                          :     :                 :     :                    +- CometProject
                                          :     :                 :     :                       +- CometFilter
                                          :     :                 :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                                          :     :                 :     +- BroadcastExchange
                                          :     :                 :        +- CometColumnarToRow
                                          :     :                 :           +- CometProject
                                          :     :                 :              +- CometFilter
                                          :     :                 :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                          :     :                 +- BroadcastExchange
                                          :     :                    +- CometColumnarToRow
                                          :     :                       +- CometFilter
                                          :     :                          +- CometNativeScan parquet spark_catalog.default.store
                                          :     +- BroadcastExchange
                                          :        +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                                          :           +- CometColumnarToRow
                                          :              +- CometColumnarExchange
                                          :                 +- HashAggregate
                                          :                    +- Project
                                          :                       +- BroadcastHashJoin
                                          :                          :- Project
                                          :                          :  +- BroadcastHashJoin
                                          :                          :     :- Filter
                                          :                          :     :  +- ColumnarToRow
                                          :                          :     :     +-  Scan parquet spark_catalog.default.store_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                          :                          :     :           +- ReusedSubquery
                                          :                          :     +- BroadcastExchange
                                          :                          :        +- CometColumnarToRow
                                          :                          :           +- CometProject
                                          :                          :              +- CometFilter
                                          :                          :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                          :                          +- BroadcastExchange
                                          :                             +- CometColumnarToRow
                                          :                                +- CometFilter
                                          :                                   +- CometNativeScan parquet spark_catalog.default.store
                                          :- Project
                                          :  +- BroadcastNestedLoopJoin
                                          :     :- BroadcastExchange
                                          :     :  +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                                          :     :     +- CometColumnarToRow
                                          :     :        +- CometColumnarExchange
                                          :     :           +- HashAggregate
                                          :     :              +- Project
                                          :     :                 +- BroadcastHashJoin
                                          :     :                    :- ColumnarToRow
                                          :     :                    :  +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                          :     :                    :        +- ReusedSubquery
                                          :     :                    +- BroadcastExchange
                                          :     :                       +- CometColumnarToRow
                                          :     :                          +- CometProject
                                          :     :                             +- CometFilter
                                          :     :                                +- CometNativeScan parquet spark_catalog.default.date_dim
                                          :     +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                                          :        +- CometColumnarToRow
                                          :           +- CometColumnarExchange
                                          :              +- HashAggregate
                                          :                 +- Project
                                          :                    +- BroadcastHashJoin
                                          :                       :- ColumnarToRow
                                          :                       :  +-  Scan parquet spark_catalog.default.catalog_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                          :                       :        +- ReusedSubquery
                                          :                       +- BroadcastExchange
                                          :                          +- CometColumnarToRow
                                          :                             +- CometProject
                                          :                                +- CometFilter
                                          :                                   +- CometNativeScan parquet spark_catalog.default.date_dim
                                          +- Project
                                             +- BroadcastHashJoin
                                                :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                                                :  +- CometColumnarToRow
                                                :     +- CometColumnarExchange
                                                :        +- HashAggregate
                                                :           +- Project
                                                :              +- BroadcastHashJoin
                                                :                 :- Project
                                                :                 :  +- BroadcastHashJoin
                                                :                 :     :- Filter
                                                :                 :     :  +- ColumnarToRow
                                                :                 :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                                :                 :     :           +- ReusedSubquery
                                                :                 :     +- BroadcastExchange
                                                :                 :        +- CometColumnarToRow
                                                :                 :           +- CometProject
                                                :                 :              +- CometFilter
                                                :                 :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                                :                 +- BroadcastExchange
                                                :                    +- CometColumnarToRow
                                                :                       +- CometFilter
                                                :                          +- CometNativeScan parquet spark_catalog.default.web_page
                                                +- BroadcastExchange
                                                   +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                                                      +- CometColumnarToRow
                                                         +- CometColumnarExchange
                                                            +- HashAggregate
                                                               +- Project
                                                                  +- BroadcastHashJoin
                                                                     :- Project
                                                                     :  +- BroadcastHashJoin
                                                                     :     :- Filter
                                                                     :     :  +- ColumnarToRow
                                                                     :     :     +-  Scan parquet spark_catalog.default.web_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                                                     :     :           +- ReusedSubquery
                                                                     :     +- BroadcastExchange
                                                                     :        +- CometColumnarToRow
                                                                     :           +- CometProject
                                                                     :              +- CometFilter
                                                                     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                                                     +- BroadcastExchange
                                                                        +- CometColumnarToRow
                                                                           +- CometFilter
                                                                              +- CometNativeScan parquet spark_catalog.default.web_page

Comet accelerated 113 out of 332 eligible operators (34%). Final plan contains 75 transitions between Spark and Comet.