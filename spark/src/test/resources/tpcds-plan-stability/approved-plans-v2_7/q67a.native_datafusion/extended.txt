TakeOrderedAndProject
+- Filter
   +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
      +- CometColumnarToRow
         +- CometSort
            +- CometExchange
               +- CometUnion
                  :- CometHashAggregate
                  :  +- CometColumnarExchange
                  :     +- HashAggregate
                  :        +- Project
                  :           +- BroadcastHashJoin
                  :              :- Project
                  :              :  +- BroadcastHashJoin
                  :              :     :- Project
                  :              :     :  +- BroadcastHashJoin
                  :              :     :     :- Filter
                  :              :     :     :  +- ColumnarToRow
                  :              :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                  :              :     :     :           +- SubqueryBroadcast
                  :              :     :     :              +- BroadcastExchange
                  :              :     :     :                 +- CometColumnarToRow
                  :              :     :     :                    +- CometProject
                  :              :     :     :                       +- CometFilter
                  :              :     :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                  :              :     :     +- BroadcastExchange
                  :              :     :        +- CometColumnarToRow
                  :              :     :           +- CometProject
                  :              :     :              +- CometFilter
                  :              :     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                  :              :     +- BroadcastExchange
                  :              :        +- CometColumnarToRow
                  :              :           +- CometProject
                  :              :              +- CometFilter
                  :              :                 +- CometNativeScan parquet spark_catalog.default.store
                  :              +- BroadcastExchange
                  :                 +- CometColumnarToRow
                  :                    +- CometProject
                  :                       +- CometFilter
                  :                          +- CometNativeScan parquet spark_catalog.default.item
                  :- CometHashAggregate
                  :  +- CometExchange
                  :     +- CometHashAggregate
                  :        +- CometHashAggregate
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- Project
                  :                       :  +- BroadcastHashJoin
                  :                       :     :- Project
                  :                       :     :  +- BroadcastHashJoin
                  :                       :     :     :- Filter
                  :                       :     :     :  +- ColumnarToRow
                  :                       :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                  :                       :     :     :           +- SubqueryBroadcast
                  :                       :     :     :              +- BroadcastExchange
                  :                       :     :     :                 +- CometColumnarToRow
                  :                       :     :     :                    +- CometProject
                  :                       :     :     :                       +- CometFilter
                  :                       :     :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     :     +- BroadcastExchange
                  :                       :     :        +- CometColumnarToRow
                  :                       :     :           +- CometProject
                  :                       :     :              +- CometFilter
                  :                       :     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     +- BroadcastExchange
                  :                       :        +- CometColumnarToRow
                  :                       :           +- CometProject
                  :                       :              +- CometFilter
                  :                       :                 +- CometNativeScan parquet spark_catalog.default.store
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometNativeScan parquet spark_catalog.default.item
                  :- CometHashAggregate
                  :  +- CometExchange
                  :     +- CometHashAggregate
                  :        +- CometHashAggregate
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- Project
                  :                       :  +- BroadcastHashJoin
                  :                       :     :- Project
                  :                       :     :  +- BroadcastHashJoin
                  :                       :     :     :- Filter
                  :                       :     :     :  +- ColumnarToRow
                  :                       :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                  :                       :     :     :           +- SubqueryBroadcast
                  :                       :     :     :              +- BroadcastExchange
                  :                       :     :     :                 +- CometColumnarToRow
                  :                       :     :     :                    +- CometProject
                  :                       :     :     :                       +- CometFilter
                  :                       :     :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     :     +- BroadcastExchange
                  :                       :     :        +- CometColumnarToRow
                  :                       :     :           +- CometProject
                  :                       :     :              +- CometFilter
                  :                       :     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     +- BroadcastExchange
                  :                       :        +- CometColumnarToRow
                  :                       :           +- CometProject
                  :                       :              +- CometFilter
                  :                       :                 +- CometNativeScan parquet spark_catalog.default.store
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometNativeScan parquet spark_catalog.default.item
                  :- CometHashAggregate
                  :  +- CometExchange
                  :     +- CometHashAggregate
                  :        +- CometHashAggregate
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- Project
                  :                       :  +- BroadcastHashJoin
                  :                       :     :- Project
                  :                       :     :  +- BroadcastHashJoin
                  :                       :     :     :- Filter
                  :                       :     :     :  +- ColumnarToRow
                  :                       :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                  :                       :     :     :           +- SubqueryBroadcast
                  :                       :     :     :              +- BroadcastExchange
                  :                       :     :     :                 +- CometColumnarToRow
                  :                       :     :     :                    +- CometProject
                  :                       :     :     :                       +- CometFilter
                  :                       :     :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     :     +- BroadcastExchange
                  :                       :     :        +- CometColumnarToRow
                  :                       :     :           +- CometProject
                  :                       :     :              +- CometFilter
                  :                       :     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     +- BroadcastExchange
                  :                       :        +- CometColumnarToRow
                  :                       :           +- CometProject
                  :                       :              +- CometFilter
                  :                       :                 +- CometNativeScan parquet spark_catalog.default.store
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometNativeScan parquet spark_catalog.default.item
                  :- CometHashAggregate
                  :  +- CometExchange
                  :     +- CometHashAggregate
                  :        +- CometHashAggregate
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- Project
                  :                       :  +- BroadcastHashJoin
                  :                       :     :- Project
                  :                       :     :  +- BroadcastHashJoin
                  :                       :     :     :- Filter
                  :                       :     :     :  +- ColumnarToRow
                  :                       :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                  :                       :     :     :           +- SubqueryBroadcast
                  :                       :     :     :              +- BroadcastExchange
                  :                       :     :     :                 +- CometColumnarToRow
                  :                       :     :     :                    +- CometProject
                  :                       :     :     :                       +- CometFilter
                  :                       :     :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     :     +- BroadcastExchange
                  :                       :     :        +- CometColumnarToRow
                  :                       :     :           +- CometProject
                  :                       :     :              +- CometFilter
                  :                       :     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     +- BroadcastExchange
                  :                       :        +- CometColumnarToRow
                  :                       :           +- CometProject
                  :                       :              +- CometFilter
                  :                       :                 +- CometNativeScan parquet spark_catalog.default.store
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometNativeScan parquet spark_catalog.default.item
                  :- CometHashAggregate
                  :  +- CometExchange
                  :     +- CometHashAggregate
                  :        +- CometHashAggregate
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- Project
                  :                       :  +- BroadcastHashJoin
                  :                       :     :- Project
                  :                       :     :  +- BroadcastHashJoin
                  :                       :     :     :- Filter
                  :                       :     :     :  +- ColumnarToRow
                  :                       :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                  :                       :     :     :           +- SubqueryBroadcast
                  :                       :     :     :              +- BroadcastExchange
                  :                       :     :     :                 +- CometColumnarToRow
                  :                       :     :     :                    +- CometProject
                  :                       :     :     :                       +- CometFilter
                  :                       :     :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     :     +- BroadcastExchange
                  :                       :     :        +- CometColumnarToRow
                  :                       :     :           +- CometProject
                  :                       :     :              +- CometFilter
                  :                       :     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     +- BroadcastExchange
                  :                       :        +- CometColumnarToRow
                  :                       :           +- CometProject
                  :                       :              +- CometFilter
                  :                       :                 +- CometNativeScan parquet spark_catalog.default.store
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometNativeScan parquet spark_catalog.default.item
                  :- CometHashAggregate
                  :  +- CometExchange
                  :     +- CometHashAggregate
                  :        +- CometHashAggregate
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- Project
                  :                       :  +- BroadcastHashJoin
                  :                       :     :- Project
                  :                       :     :  +- BroadcastHashJoin
                  :                       :     :     :- Filter
                  :                       :     :     :  +- ColumnarToRow
                  :                       :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                  :                       :     :     :           +- SubqueryBroadcast
                  :                       :     :     :              +- BroadcastExchange
                  :                       :     :     :                 +- CometColumnarToRow
                  :                       :     :     :                    +- CometProject
                  :                       :     :     :                       +- CometFilter
                  :                       :     :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     :     +- BroadcastExchange
                  :                       :     :        +- CometColumnarToRow
                  :                       :     :           +- CometProject
                  :                       :     :              +- CometFilter
                  :                       :     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     +- BroadcastExchange
                  :                       :        +- CometColumnarToRow
                  :                       :           +- CometProject
                  :                       :              +- CometFilter
                  :                       :                 +- CometNativeScan parquet spark_catalog.default.store
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometNativeScan parquet spark_catalog.default.item
                  :- CometHashAggregate
                  :  +- CometExchange
                  :     +- CometHashAggregate
                  :        +- CometHashAggregate
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- Project
                  :                       :  +- BroadcastHashJoin
                  :                       :     :- Project
                  :                       :     :  +- BroadcastHashJoin
                  :                       :     :     :- Filter
                  :                       :     :     :  +- ColumnarToRow
                  :                       :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                  :                       :     :     :           +- SubqueryBroadcast
                  :                       :     :     :              +- BroadcastExchange
                  :                       :     :     :                 +- CometColumnarToRow
                  :                       :     :     :                    +- CometProject
                  :                       :     :     :                       +- CometFilter
                  :                       :     :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     :     +- BroadcastExchange
                  :                       :     :        +- CometColumnarToRow
                  :                       :     :           +- CometProject
                  :                       :     :              +- CometFilter
                  :                       :     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                  :                       :     +- BroadcastExchange
                  :                       :        +- CometColumnarToRow
                  :                       :           +- CometProject
                  :                       :              +- CometFilter
                  :                       :                 +- CometNativeScan parquet spark_catalog.default.store
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometNativeScan parquet spark_catalog.default.item
                  +- CometHashAggregate
                     +- CometExchange
                        +- CometHashAggregate
                           +- CometHashAggregate
                              +- CometColumnarExchange
                                 +- HashAggregate
                                    +- Project
                                       +- BroadcastHashJoin
                                          :- Project
                                          :  +- BroadcastHashJoin
                                          :     :- Project
                                          :     :  +- BroadcastHashJoin
                                          :     :     :- Filter
                                          :     :     :  +- ColumnarToRow
                                          :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                          :     :     :           +- SubqueryBroadcast
                                          :     :     :              +- BroadcastExchange
                                          :     :     :                 +- CometColumnarToRow
                                          :     :     :                    +- CometProject
                                          :     :     :                       +- CometFilter
                                          :     :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                                          :     :     +- BroadcastExchange
                                          :     :        +- CometColumnarToRow
                                          :     :           +- CometProject
                                          :     :              +- CometFilter
                                          :     :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                          :     +- BroadcastExchange
                                          :        +- CometColumnarToRow
                                          :           +- CometProject
                                          :              +- CometFilter
                                          :                 +- CometNativeScan parquet spark_catalog.default.store
                                          +- BroadcastExchange
                                             +- CometColumnarToRow
                                                +- CometProject
                                                   +- CometFilter
                                                      +- CometNativeScan parquet spark_catalog.default.item

Comet accelerated 153 out of 282 eligible operators (54%). Final plan contains 46 transitions between Spark and Comet.