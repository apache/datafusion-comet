== Physical Plan ==
* CometColumnarToRow (90)
+- CometTakeOrderedAndProject (89)
   +- CometHashAggregate (88)
      +- CometColumnarExchange (87)
         +- * HashAggregate (86)
            +- * Expand (85)
               +- Union (84)
                  :- * CometColumnarToRow (31)
                  :  +- CometProject (30)
                  :     +- CometBroadcastHashJoin (29)
                  :        :- CometHashAggregate (15)
                  :        :  +- CometColumnarExchange (14)
                  :        :     +- * HashAggregate (13)
                  :        :        +- * Project (12)
                  :        :           +- * BroadcastHashJoin Inner BuildRight (11)
                  :        :              :- * Project (6)
                  :        :              :  +- * BroadcastHashJoin Inner BuildRight (5)
                  :        :              :     :- * Filter (3)
                  :        :              :     :  +- * ColumnarToRow (2)
                  :        :              :     :     +- Scan parquet spark_catalog.default.store_sales (1)
                  :        :              :     +- ReusedExchange (4)
                  :        :              +- BroadcastExchange (10)
                  :        :                 +- * CometColumnarToRow (9)
                  :        :                    +- CometFilter (8)
                  :        :                       +- CometNativeScan parquet spark_catalog.default.store (7)
                  :        +- CometBroadcastExchange (28)
                  :           +- CometHashAggregate (27)
                  :              +- CometColumnarExchange (26)
                  :                 +- * HashAggregate (25)
                  :                    +- * Project (24)
                  :                       +- * BroadcastHashJoin Inner BuildRight (23)
                  :                          :- * Project (21)
                  :                          :  +- * BroadcastHashJoin Inner BuildRight (20)
                  :                          :     :- * Filter (18)
                  :                          :     :  +- * ColumnarToRow (17)
                  :                          :     :     +- Scan parquet spark_catalog.default.store_returns (16)
                  :                          :     +- ReusedExchange (19)
                  :                          +- ReusedExchange (22)
                  :- * Project (52)
                  :  +- * BroadcastNestedLoopJoin Inner BuildLeft (51)
                  :     :- BroadcastExchange (41)
                  :     :  +- * CometColumnarToRow (40)
                  :     :     +- CometHashAggregate (39)
                  :     :        +- CometColumnarExchange (38)
                  :     :           +- * HashAggregate (37)
                  :     :              +- * Project (36)
                  :     :                 +- * BroadcastHashJoin Inner BuildRight (35)
                  :     :                    :- * ColumnarToRow (33)
                  :     :                    :  +- Scan parquet spark_catalog.default.catalog_sales (32)
                  :     :                    +- ReusedExchange (34)
                  :     +- * CometColumnarToRow (50)
                  :        +- CometHashAggregate (49)
                  :           +- CometColumnarExchange (48)
                  :              +- * HashAggregate (47)
                  :                 +- * Project (46)
                  :                    +- * BroadcastHashJoin Inner BuildRight (45)
                  :                       :- * ColumnarToRow (43)
                  :                       :  +- Scan parquet spark_catalog.default.catalog_returns (42)
                  :                       +- ReusedExchange (44)
                  +- * CometColumnarToRow (83)
                     +- CometProject (82)
                        +- CometBroadcastHashJoin (81)
                           :- CometHashAggregate (67)
                           :  +- CometColumnarExchange (66)
                           :     +- * HashAggregate (65)
                           :        +- * Project (64)
                           :           +- * BroadcastHashJoin Inner BuildRight (63)
                           :              :- * Project (58)
                           :              :  +- * BroadcastHashJoin Inner BuildRight (57)
                           :              :     :- * Filter (55)
                           :              :     :  +- * ColumnarToRow (54)
                           :              :     :     +- Scan parquet spark_catalog.default.web_sales (53)
                           :              :     +- ReusedExchange (56)
                           :              +- BroadcastExchange (62)
                           :                 +- * CometColumnarToRow (61)
                           :                    +- CometFilter (60)
                           :                       +- CometNativeScan parquet spark_catalog.default.web_page (59)
                           +- CometBroadcastExchange (80)
                              +- CometHashAggregate (79)
                                 +- CometColumnarExchange (78)
                                    +- * HashAggregate (77)
                                       +- * Project (76)
                                          +- * BroadcastHashJoin Inner BuildRight (75)
                                             :- * Project (73)
                                             :  +- * BroadcastHashJoin Inner BuildRight (72)
                                             :     :- * Filter (70)
                                             :     :  +- * ColumnarToRow (69)
                                             :     :     +- Scan parquet spark_catalog.default.web_returns (68)
                                             :     +- ReusedExchange (71)
                                             +- ReusedExchange (74)


(1) Scan parquet spark_catalog.default.store_sales
Output [4]: [ss_store_sk#1, ss_ext_sales_price#2, ss_net_profit#3, ss_sold_date_sk#4]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(ss_sold_date_sk#4), dynamicpruningexpression(ss_sold_date_sk#4 IN dynamicpruning#5)]
PushedFilters: [IsNotNull(ss_store_sk)]
ReadSchema: struct<ss_store_sk:int,ss_ext_sales_price:decimal(7,2),ss_net_profit:decimal(7,2)>

(2) ColumnarToRow [codegen id : 3]
Input [4]: [ss_store_sk#1, ss_ext_sales_price#2, ss_net_profit#3, ss_sold_date_sk#4]

(3) Filter [codegen id : 3]
Input [4]: [ss_store_sk#1, ss_ext_sales_price#2, ss_net_profit#3, ss_sold_date_sk#4]
Condition : isnotnull(ss_store_sk#1)

(4) ReusedExchange [Reuses operator id: 95]
Output [1]: [d_date_sk#6]

(5) BroadcastHashJoin [codegen id : 3]
Left keys [1]: [ss_sold_date_sk#4]
Right keys [1]: [d_date_sk#6]
Join type: Inner
Join condition: None

(6) Project [codegen id : 3]
Output [3]: [ss_store_sk#1, ss_ext_sales_price#2, ss_net_profit#3]
Input [5]: [ss_store_sk#1, ss_ext_sales_price#2, ss_net_profit#3, ss_sold_date_sk#4, d_date_sk#6]

(7) CometNativeScan parquet spark_catalog.default.store
Output [1]: [s_store_sk#7]
Batched: true
Location [not included in comparison]/{warehouse_dir}/store]
PushedFilters: [IsNotNull(s_store_sk)]
ReadSchema: struct<s_store_sk:int>

(8) CometFilter
Input [1]: [s_store_sk#7]
Condition : isnotnull(s_store_sk#7)

(9) CometColumnarToRow [codegen id : 2]
Input [1]: [s_store_sk#7]

(10) BroadcastExchange
Input [1]: [s_store_sk#7]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1]

(11) BroadcastHashJoin [codegen id : 3]
Left keys [1]: [ss_store_sk#1]
Right keys [1]: [s_store_sk#7]
Join type: Inner
Join condition: None

(12) Project [codegen id : 3]
Output [3]: [ss_ext_sales_price#2, ss_net_profit#3, s_store_sk#7]
Input [4]: [ss_store_sk#1, ss_ext_sales_price#2, ss_net_profit#3, s_store_sk#7]

(13) HashAggregate [codegen id : 3]
Input [3]: [ss_ext_sales_price#2, ss_net_profit#3, s_store_sk#7]
Keys [1]: [s_store_sk#7]
Functions [2]: [partial_sum(UnscaledValue(ss_ext_sales_price#2)), partial_sum(UnscaledValue(ss_net_profit#3))]
Aggregate Attributes [2]: [sum#8, sum#9]
Results [3]: [s_store_sk#7, sum#10, sum#11]

(14) CometColumnarExchange
Input [3]: [s_store_sk#7, sum#10, sum#11]
Arguments: hashpartitioning(s_store_sk#7, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=2]

(15) CometHashAggregate
Input [3]: [s_store_sk#7, sum#10, sum#11]
Keys [1]: [s_store_sk#7]
Functions [2]: [sum(UnscaledValue(ss_ext_sales_price#2)), sum(UnscaledValue(ss_net_profit#3))]

(16) Scan parquet spark_catalog.default.store_returns
Output [4]: [sr_store_sk#12, sr_return_amt#13, sr_net_loss#14, sr_returned_date_sk#15]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(sr_returned_date_sk#15), dynamicpruningexpression(sr_returned_date_sk#15 IN dynamicpruning#5)]
PushedFilters: [IsNotNull(sr_store_sk)]
ReadSchema: struct<sr_store_sk:int,sr_return_amt:decimal(7,2),sr_net_loss:decimal(7,2)>

(17) ColumnarToRow [codegen id : 6]
Input [4]: [sr_store_sk#12, sr_return_amt#13, sr_net_loss#14, sr_returned_date_sk#15]

(18) Filter [codegen id : 6]
Input [4]: [sr_store_sk#12, sr_return_amt#13, sr_net_loss#14, sr_returned_date_sk#15]
Condition : isnotnull(sr_store_sk#12)

(19) ReusedExchange [Reuses operator id: 95]
Output [1]: [d_date_sk#16]

(20) BroadcastHashJoin [codegen id : 6]
Left keys [1]: [sr_returned_date_sk#15]
Right keys [1]: [d_date_sk#16]
Join type: Inner
Join condition: None

(21) Project [codegen id : 6]
Output [3]: [sr_store_sk#12, sr_return_amt#13, sr_net_loss#14]
Input [5]: [sr_store_sk#12, sr_return_amt#13, sr_net_loss#14, sr_returned_date_sk#15, d_date_sk#16]

(22) ReusedExchange [Reuses operator id: 10]
Output [1]: [s_store_sk#17]

(23) BroadcastHashJoin [codegen id : 6]
Left keys [1]: [sr_store_sk#12]
Right keys [1]: [s_store_sk#17]
Join type: Inner
Join condition: None

(24) Project [codegen id : 6]
Output [3]: [sr_return_amt#13, sr_net_loss#14, s_store_sk#17]
Input [4]: [sr_store_sk#12, sr_return_amt#13, sr_net_loss#14, s_store_sk#17]

(25) HashAggregate [codegen id : 6]
Input [3]: [sr_return_amt#13, sr_net_loss#14, s_store_sk#17]
Keys [1]: [s_store_sk#17]
Functions [2]: [partial_sum(UnscaledValue(sr_return_amt#13)), partial_sum(UnscaledValue(sr_net_loss#14))]
Aggregate Attributes [2]: [sum#18, sum#19]
Results [3]: [s_store_sk#17, sum#20, sum#21]

(26) CometColumnarExchange
Input [3]: [s_store_sk#17, sum#20, sum#21]
Arguments: hashpartitioning(s_store_sk#17, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=3]

(27) CometHashAggregate
Input [3]: [s_store_sk#17, sum#20, sum#21]
Keys [1]: [s_store_sk#17]
Functions [2]: [sum(UnscaledValue(sr_return_amt#13)), sum(UnscaledValue(sr_net_loss#14))]

(28) CometBroadcastExchange
Input [3]: [s_store_sk#17, returns#22, profit_loss#23]
Arguments: [s_store_sk#17, returns#22, profit_loss#23]

(29) CometBroadcastHashJoin
Left output [3]: [s_store_sk#7, sales#24, profit#25]
Right output [3]: [s_store_sk#17, returns#22, profit_loss#23]
Arguments: [s_store_sk#7], [s_store_sk#17], LeftOuter, BuildRight

(30) CometProject
Input [6]: [s_store_sk#7, sales#24, profit#25, s_store_sk#17, returns#22, profit_loss#23]
Arguments: [sales#24, returns#26, profit#27, channel#28, id#29], [sales#24, coalesce(returns#22, 0.00) AS returns#26, (profit#25 - coalesce(profit_loss#23, 0.00)) AS profit#27, store channel AS channel#28, s_store_sk#7 AS id#29]

(31) CometColumnarToRow [codegen id : 7]
Input [5]: [sales#24, returns#26, profit#27, channel#28, id#29]

(32) Scan parquet spark_catalog.default.catalog_sales
Output [4]: [cs_call_center_sk#30, cs_ext_sales_price#31, cs_net_profit#32, cs_sold_date_sk#33]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(cs_sold_date_sk#33), dynamicpruningexpression(cs_sold_date_sk#33 IN dynamicpruning#5)]
ReadSchema: struct<cs_call_center_sk:int,cs_ext_sales_price:decimal(7,2),cs_net_profit:decimal(7,2)>

(33) ColumnarToRow [codegen id : 9]
Input [4]: [cs_call_center_sk#30, cs_ext_sales_price#31, cs_net_profit#32, cs_sold_date_sk#33]

(34) ReusedExchange [Reuses operator id: 95]
Output [1]: [d_date_sk#34]

(35) BroadcastHashJoin [codegen id : 9]
Left keys [1]: [cs_sold_date_sk#33]
Right keys [1]: [d_date_sk#34]
Join type: Inner
Join condition: None

(36) Project [codegen id : 9]
Output [3]: [cs_call_center_sk#30, cs_ext_sales_price#31, cs_net_profit#32]
Input [5]: [cs_call_center_sk#30, cs_ext_sales_price#31, cs_net_profit#32, cs_sold_date_sk#33, d_date_sk#34]

(37) HashAggregate [codegen id : 9]
Input [3]: [cs_call_center_sk#30, cs_ext_sales_price#31, cs_net_profit#32]
Keys [1]: [cs_call_center_sk#30]
Functions [2]: [partial_sum(UnscaledValue(cs_ext_sales_price#31)), partial_sum(UnscaledValue(cs_net_profit#32))]
Aggregate Attributes [2]: [sum#35, sum#36]
Results [3]: [cs_call_center_sk#30, sum#37, sum#38]

(38) CometColumnarExchange
Input [3]: [cs_call_center_sk#30, sum#37, sum#38]
Arguments: hashpartitioning(cs_call_center_sk#30, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=4]

(39) CometHashAggregate
Input [3]: [cs_call_center_sk#30, sum#37, sum#38]
Keys [1]: [cs_call_center_sk#30]
Functions [2]: [sum(UnscaledValue(cs_ext_sales_price#31)), sum(UnscaledValue(cs_net_profit#32))]

(40) CometColumnarToRow [codegen id : 10]
Input [3]: [cs_call_center_sk#30, sales#39, profit#40]

(41) BroadcastExchange
Input [3]: [cs_call_center_sk#30, sales#39, profit#40]
Arguments: IdentityBroadcastMode, [plan_id=5]

(42) Scan parquet spark_catalog.default.catalog_returns
Output [3]: [cr_return_amount#41, cr_net_loss#42, cr_returned_date_sk#43]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(cr_returned_date_sk#43), dynamicpruningexpression(cr_returned_date_sk#43 IN dynamicpruning#5)]
ReadSchema: struct<cr_return_amount:decimal(7,2),cr_net_loss:decimal(7,2)>

(43) ColumnarToRow [codegen id : 12]
Input [3]: [cr_return_amount#41, cr_net_loss#42, cr_returned_date_sk#43]

(44) ReusedExchange [Reuses operator id: 95]
Output [1]: [d_date_sk#44]

(45) BroadcastHashJoin [codegen id : 12]
Left keys [1]: [cr_returned_date_sk#43]
Right keys [1]: [d_date_sk#44]
Join type: Inner
Join condition: None

(46) Project [codegen id : 12]
Output [2]: [cr_return_amount#41, cr_net_loss#42]
Input [4]: [cr_return_amount#41, cr_net_loss#42, cr_returned_date_sk#43, d_date_sk#44]

(47) HashAggregate [codegen id : 12]
Input [2]: [cr_return_amount#41, cr_net_loss#42]
Keys: []
Functions [2]: [partial_sum(UnscaledValue(cr_return_amount#41)), partial_sum(UnscaledValue(cr_net_loss#42))]
Aggregate Attributes [2]: [sum#45, sum#46]
Results [2]: [sum#47, sum#48]

(48) CometColumnarExchange
Input [2]: [sum#47, sum#48]
Arguments: SinglePartition, ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=6]

(49) CometHashAggregate
Input [2]: [sum#47, sum#48]
Keys: []
Functions [2]: [sum(UnscaledValue(cr_return_amount#41)), sum(UnscaledValue(cr_net_loss#42))]

(50) CometColumnarToRow
Input [2]: [returns#49, profit_loss#50]

(51) BroadcastNestedLoopJoin [codegen id : 13]
Join type: Inner
Join condition: None

(52) Project [codegen id : 13]
Output [5]: [sales#39, returns#49, (profit#40 - profit_loss#50) AS profit#51, catalog channel AS channel#52, cs_call_center_sk#30 AS id#53]
Input [5]: [cs_call_center_sk#30, sales#39, profit#40, returns#49, profit_loss#50]

(53) Scan parquet spark_catalog.default.web_sales
Output [4]: [ws_web_page_sk#54, ws_ext_sales_price#55, ws_net_profit#56, ws_sold_date_sk#57]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(ws_sold_date_sk#57), dynamicpruningexpression(ws_sold_date_sk#57 IN dynamicpruning#5)]
PushedFilters: [IsNotNull(ws_web_page_sk)]
ReadSchema: struct<ws_web_page_sk:int,ws_ext_sales_price:decimal(7,2),ws_net_profit:decimal(7,2)>

(54) ColumnarToRow [codegen id : 16]
Input [4]: [ws_web_page_sk#54, ws_ext_sales_price#55, ws_net_profit#56, ws_sold_date_sk#57]

(55) Filter [codegen id : 16]
Input [4]: [ws_web_page_sk#54, ws_ext_sales_price#55, ws_net_profit#56, ws_sold_date_sk#57]
Condition : isnotnull(ws_web_page_sk#54)

(56) ReusedExchange [Reuses operator id: 95]
Output [1]: [d_date_sk#58]

(57) BroadcastHashJoin [codegen id : 16]
Left keys [1]: [ws_sold_date_sk#57]
Right keys [1]: [d_date_sk#58]
Join type: Inner
Join condition: None

(58) Project [codegen id : 16]
Output [3]: [ws_web_page_sk#54, ws_ext_sales_price#55, ws_net_profit#56]
Input [5]: [ws_web_page_sk#54, ws_ext_sales_price#55, ws_net_profit#56, ws_sold_date_sk#57, d_date_sk#58]

(59) CometNativeScan parquet spark_catalog.default.web_page
Output [1]: [wp_web_page_sk#59]
Batched: true
Location [not included in comparison]/{warehouse_dir}/web_page]
PushedFilters: [IsNotNull(wp_web_page_sk)]
ReadSchema: struct<wp_web_page_sk:int>

(60) CometFilter
Input [1]: [wp_web_page_sk#59]
Condition : isnotnull(wp_web_page_sk#59)

(61) CometColumnarToRow [codegen id : 15]
Input [1]: [wp_web_page_sk#59]

(62) BroadcastExchange
Input [1]: [wp_web_page_sk#59]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]

(63) BroadcastHashJoin [codegen id : 16]
Left keys [1]: [ws_web_page_sk#54]
Right keys [1]: [wp_web_page_sk#59]
Join type: Inner
Join condition: None

(64) Project [codegen id : 16]
Output [3]: [ws_ext_sales_price#55, ws_net_profit#56, wp_web_page_sk#59]
Input [4]: [ws_web_page_sk#54, ws_ext_sales_price#55, ws_net_profit#56, wp_web_page_sk#59]

(65) HashAggregate [codegen id : 16]
Input [3]: [ws_ext_sales_price#55, ws_net_profit#56, wp_web_page_sk#59]
Keys [1]: [wp_web_page_sk#59]
Functions [2]: [partial_sum(UnscaledValue(ws_ext_sales_price#55)), partial_sum(UnscaledValue(ws_net_profit#56))]
Aggregate Attributes [2]: [sum#60, sum#61]
Results [3]: [wp_web_page_sk#59, sum#62, sum#63]

(66) CometColumnarExchange
Input [3]: [wp_web_page_sk#59, sum#62, sum#63]
Arguments: hashpartitioning(wp_web_page_sk#59, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=8]

(67) CometHashAggregate
Input [3]: [wp_web_page_sk#59, sum#62, sum#63]
Keys [1]: [wp_web_page_sk#59]
Functions [2]: [sum(UnscaledValue(ws_ext_sales_price#55)), sum(UnscaledValue(ws_net_profit#56))]

(68) Scan parquet spark_catalog.default.web_returns
Output [4]: [wr_web_page_sk#64, wr_return_amt#65, wr_net_loss#66, wr_returned_date_sk#67]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(wr_returned_date_sk#67), dynamicpruningexpression(wr_returned_date_sk#67 IN dynamicpruning#5)]
PushedFilters: [IsNotNull(wr_web_page_sk)]
ReadSchema: struct<wr_web_page_sk:int,wr_return_amt:decimal(7,2),wr_net_loss:decimal(7,2)>

(69) ColumnarToRow [codegen id : 19]
Input [4]: [wr_web_page_sk#64, wr_return_amt#65, wr_net_loss#66, wr_returned_date_sk#67]

(70) Filter [codegen id : 19]
Input [4]: [wr_web_page_sk#64, wr_return_amt#65, wr_net_loss#66, wr_returned_date_sk#67]
Condition : isnotnull(wr_web_page_sk#64)

(71) ReusedExchange [Reuses operator id: 95]
Output [1]: [d_date_sk#68]

(72) BroadcastHashJoin [codegen id : 19]
Left keys [1]: [wr_returned_date_sk#67]
Right keys [1]: [d_date_sk#68]
Join type: Inner
Join condition: None

(73) Project [codegen id : 19]
Output [3]: [wr_web_page_sk#64, wr_return_amt#65, wr_net_loss#66]
Input [5]: [wr_web_page_sk#64, wr_return_amt#65, wr_net_loss#66, wr_returned_date_sk#67, d_date_sk#68]

(74) ReusedExchange [Reuses operator id: 62]
Output [1]: [wp_web_page_sk#69]

(75) BroadcastHashJoin [codegen id : 19]
Left keys [1]: [wr_web_page_sk#64]
Right keys [1]: [wp_web_page_sk#69]
Join type: Inner
Join condition: None

(76) Project [codegen id : 19]
Output [3]: [wr_return_amt#65, wr_net_loss#66, wp_web_page_sk#69]
Input [4]: [wr_web_page_sk#64, wr_return_amt#65, wr_net_loss#66, wp_web_page_sk#69]

(77) HashAggregate [codegen id : 19]
Input [3]: [wr_return_amt#65, wr_net_loss#66, wp_web_page_sk#69]
Keys [1]: [wp_web_page_sk#69]
Functions [2]: [partial_sum(UnscaledValue(wr_return_amt#65)), partial_sum(UnscaledValue(wr_net_loss#66))]
Aggregate Attributes [2]: [sum#70, sum#71]
Results [3]: [wp_web_page_sk#69, sum#72, sum#73]

(78) CometColumnarExchange
Input [3]: [wp_web_page_sk#69, sum#72, sum#73]
Arguments: hashpartitioning(wp_web_page_sk#69, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=9]

(79) CometHashAggregate
Input [3]: [wp_web_page_sk#69, sum#72, sum#73]
Keys [1]: [wp_web_page_sk#69]
Functions [2]: [sum(UnscaledValue(wr_return_amt#65)), sum(UnscaledValue(wr_net_loss#66))]

(80) CometBroadcastExchange
Input [3]: [wp_web_page_sk#69, returns#74, profit_loss#75]
Arguments: [wp_web_page_sk#69, returns#74, profit_loss#75]

(81) CometBroadcastHashJoin
Left output [3]: [wp_web_page_sk#59, sales#76, profit#77]
Right output [3]: [wp_web_page_sk#69, returns#74, profit_loss#75]
Arguments: [wp_web_page_sk#59], [wp_web_page_sk#69], LeftOuter, BuildRight

(82) CometProject
Input [6]: [wp_web_page_sk#59, sales#76, profit#77, wp_web_page_sk#69, returns#74, profit_loss#75]
Arguments: [sales#76, returns#78, profit#79, channel#80, id#81], [sales#76, coalesce(returns#74, 0.00) AS returns#78, (profit#77 - coalesce(profit_loss#75, 0.00)) AS profit#79, web channel AS channel#80, wp_web_page_sk#59 AS id#81]

(83) CometColumnarToRow [codegen id : 20]
Input [5]: [sales#76, returns#78, profit#79, channel#80, id#81]

(84) Union

(85) Expand [codegen id : 21]
Input [5]: [sales#24, returns#26, profit#27, channel#28, id#29]
Arguments: [[sales#24, returns#26, profit#27, channel#28, id#29, 0], [sales#24, returns#26, profit#27, channel#28, null, 1], [sales#24, returns#26, profit#27, null, null, 3]], [sales#24, returns#26, profit#27, channel#82, id#83, spark_grouping_id#84]

(86) HashAggregate [codegen id : 21]
Input [6]: [sales#24, returns#26, profit#27, channel#82, id#83, spark_grouping_id#84]
Keys [3]: [channel#82, id#83, spark_grouping_id#84]
Functions [3]: [partial_sum(sales#24), partial_sum(returns#26), partial_sum(profit#27)]
Aggregate Attributes [6]: [sum#85, isEmpty#86, sum#87, isEmpty#88, sum#89, isEmpty#90]
Results [9]: [channel#82, id#83, spark_grouping_id#84, sum#91, isEmpty#92, sum#93, isEmpty#94, sum#95, isEmpty#96]

(87) CometColumnarExchange
Input [9]: [channel#82, id#83, spark_grouping_id#84, sum#91, isEmpty#92, sum#93, isEmpty#94, sum#95, isEmpty#96]
Arguments: hashpartitioning(channel#82, id#83, spark_grouping_id#84, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=10]

(88) CometHashAggregate
Input [9]: [channel#82, id#83, spark_grouping_id#84, sum#91, isEmpty#92, sum#93, isEmpty#94, sum#95, isEmpty#96]
Keys [3]: [channel#82, id#83, spark_grouping_id#84]
Functions [3]: [sum(sales#24), sum(returns#26), sum(profit#27)]

(89) CometTakeOrderedAndProject
Input [5]: [channel#82, id#83, sales#97, returns#98, profit#99]
Arguments: TakeOrderedAndProject(limit=100, orderBy=[channel#82 ASC NULLS FIRST,id#83 ASC NULLS FIRST], output=[channel#82,id#83,sales#97,returns#98,profit#99]), [channel#82, id#83, sales#97, returns#98, profit#99], 100, 0, [channel#82 ASC NULLS FIRST, id#83 ASC NULLS FIRST], [channel#82, id#83, sales#97, returns#98, profit#99]

(90) CometColumnarToRow [codegen id : 22]
Input [5]: [channel#82, id#83, sales#97, returns#98, profit#99]

===== Subqueries =====

Subquery:1 Hosting operator id = 1 Hosting Expression = ss_sold_date_sk#4 IN dynamicpruning#5
BroadcastExchange (95)
+- * CometColumnarToRow (94)
   +- CometProject (93)
      +- CometFilter (92)
         +- CometNativeScan parquet spark_catalog.default.date_dim (91)


(91) CometNativeScan parquet spark_catalog.default.date_dim
Output [2]: [d_date_sk#6, d_date#100]
Batched: true
Location [not included in comparison]/{warehouse_dir}/date_dim]
PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2000-08-03), LessThanOrEqual(d_date,2000-09-02), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_date:date>

(92) CometFilter
Input [2]: [d_date_sk#6, d_date#100]
Condition : (((isnotnull(d_date#100) AND (d_date#100 >= 2000-08-03)) AND (d_date#100 <= 2000-09-02)) AND isnotnull(d_date_sk#6))

(93) CometProject
Input [2]: [d_date_sk#6, d_date#100]
Arguments: [d_date_sk#6], [d_date_sk#6]

(94) CometColumnarToRow [codegen id : 1]
Input [1]: [d_date_sk#6]

(95) BroadcastExchange
Input [1]: [d_date_sk#6]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=11]

Subquery:2 Hosting operator id = 16 Hosting Expression = sr_returned_date_sk#15 IN dynamicpruning#5

Subquery:3 Hosting operator id = 32 Hosting Expression = cs_sold_date_sk#33 IN dynamicpruning#5

Subquery:4 Hosting operator id = 42 Hosting Expression = cr_returned_date_sk#43 IN dynamicpruning#5

Subquery:5 Hosting operator id = 53 Hosting Expression = ws_sold_date_sk#57 IN dynamicpruning#5

Subquery:6 Hosting operator id = 68 Hosting Expression = wr_returned_date_sk#67 IN dynamicpruning#5


