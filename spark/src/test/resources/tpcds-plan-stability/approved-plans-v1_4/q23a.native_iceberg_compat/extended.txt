CometColumnarToRow
+- CometHashAggregate
   +- CometExchange
      +- CometHashAggregate
         +- CometUnion
            :- CometProject
            :  +- CometBroadcastHashJoin
            :     :- CometProject
            :     :  +- CometSortMergeJoin
            :     :     :- CometSort
            :     :     :  +- CometColumnarExchange
            :     :     :     +- Project
            :     :     :        +- BroadcastHashJoin
            :     :     :           :- ColumnarToRow
            :     :     :           :  +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
            :     :     :           :        +- SubqueryBroadcast
            :     :     :           :           +- BroadcastExchange
            :     :     :           :              +- CometColumnarToRow
            :     :     :           :                 +- CometProject
            :     :     :           :                    +- CometFilter
            :     :     :           :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :     :     :           +- BroadcastExchange
            :     :     :              +- Project
            :     :     :                 +- Filter
            :     :     :                    +- HashAggregate
            :     :     :                       +- CometColumnarToRow
            :     :     :                          +- CometColumnarExchange
            :     :     :                             +- HashAggregate
            :     :     :                                +- Project
            :     :     :                                   +- BroadcastHashJoin
            :     :     :                                      :- Project
            :     :     :                                      :  +- BroadcastHashJoin
            :     :     :                                      :     :- Filter
            :     :     :                                      :     :  +- ColumnarToRow
            :     :     :                                      :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
            :     :     :                                      :     :           +- SubqueryBroadcast
            :     :     :                                      :     :              +- BroadcastExchange
            :     :     :                                      :     :                 +- CometColumnarToRow
            :     :     :                                      :     :                    +- CometProject
            :     :     :                                      :     :                       +- CometFilter
            :     :     :                                      :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :     :     :                                      :     +- BroadcastExchange
            :     :     :                                      :        +- CometColumnarToRow
            :     :     :                                      :           +- CometProject
            :     :     :                                      :              +- CometFilter
            :     :     :                                      :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :     :     :                                      +- BroadcastExchange
            :     :     :                                         +- CometColumnarToRow
            :     :     :                                            +- CometFilter
            :     :     :                                               +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
            :     :     +- CometSort
            :     :        +- CometProject
            :     :           +- CometFilter
            :     :              :  +- Subquery
            :     :              :     +- HashAggregate
            :     :              :        +- CometColumnarToRow
            :     :              :           +- CometColumnarExchange
            :     :              :              +- HashAggregate
            :     :              :                 +- HashAggregate
            :     :              :                    +- CometColumnarToRow
            :     :              :                       +- CometColumnarExchange
            :     :              :                          +- HashAggregate
            :     :              :                             +- Project
            :     :              :                                +- BroadcastHashJoin
            :     :              :                                   :- Project
            :     :              :                                   :  +- BroadcastHashJoin
            :     :              :                                   :     :- Filter
            :     :              :                                   :     :  +- ColumnarToRow
            :     :              :                                   :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
            :     :              :                                   :     :           +- SubqueryBroadcast
            :     :              :                                   :     :              +- BroadcastExchange
            :     :              :                                   :     :                 +- CometColumnarToRow
            :     :              :                                   :     :                    +- CometProject
            :     :              :                                   :     :                       +- CometFilter
            :     :              :                                   :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :     :              :                                   :     +- BroadcastExchange
            :     :              :                                   :        +- CometColumnarToRow
            :     :              :                                   :           +- CometFilter
            :     :              :                                   :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer
            :     :              :                                   +- BroadcastExchange
            :     :              :                                      +- CometColumnarToRow
            :     :              :                                         +- CometProject
            :     :              :                                            +- CometFilter
            :     :              :                                               +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :     :              +- CometHashAggregate
            :     :                 +- CometExchange
            :     :                    +- CometHashAggregate
            :     :                       +- CometProject
            :     :                          +- CometBroadcastHashJoin
            :     :                             :- CometProject
            :     :                             :  +- CometFilter
            :     :                             :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
            :     :                             +- CometBroadcastExchange
            :     :                                +- CometFilter
            :     :                                   +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer
            :     +- CometBroadcastExchange
            :        +- CometProject
            :           +- CometFilter
            :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            +- CometProject
               +- CometBroadcastHashJoin
                  :- CometProject
                  :  +- CometSortMergeJoin
                  :     :- CometSort
                  :     :  +- CometColumnarExchange
                  :     :     +- Project
                  :     :        +- BroadcastHashJoin
                  :     :           :- ColumnarToRow
                  :     :           :  +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :     :           :        +- ReusedSubquery
                  :     :           +- BroadcastExchange
                  :     :              +- Project
                  :     :                 +- Filter
                  :     :                    +- HashAggregate
                  :     :                       +- CometColumnarToRow
                  :     :                          +- CometColumnarExchange
                  :     :                             +- HashAggregate
                  :     :                                +- Project
                  :     :                                   +- BroadcastHashJoin
                  :     :                                      :- Project
                  :     :                                      :  +- BroadcastHashJoin
                  :     :                                      :     :- Filter
                  :     :                                      :     :  +- ColumnarToRow
                  :     :                                      :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :     :                                      :     :           +- SubqueryBroadcast
                  :     :                                      :     :              +- BroadcastExchange
                  :     :                                      :     :                 +- CometColumnarToRow
                  :     :                                      :     :                    +- CometProject
                  :     :                                      :     :                       +- CometFilter
                  :     :                                      :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :     :                                      :     +- BroadcastExchange
                  :     :                                      :        +- CometColumnarToRow
                  :     :                                      :           +- CometProject
                  :     :                                      :              +- CometFilter
                  :     :                                      :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :     :                                      +- BroadcastExchange
                  :     :                                         +- CometColumnarToRow
                  :     :                                            +- CometFilter
                  :     :                                               +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :     +- CometSort
                  :        +- CometProject
                  :           +- CometFilter
                  :              :  +- ReusedSubquery
                  :              +- CometHashAggregate
                  :                 +- CometExchange
                  :                    +- CometHashAggregate
                  :                       +- CometProject
                  :                          +- CometBroadcastHashJoin
                  :                             :- CometProject
                  :                             :  +- CometFilter
                  :                             :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                  :                             +- CometBroadcastExchange
                  :                                +- CometFilter
                  :                                   +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer
                  +- CometBroadcastExchange
                     +- CometProject
                        +- CometFilter
                           +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim

Comet accelerated 83 out of 138 eligible operators (60%). Final plan contains 20 transitions between Spark and Comet.