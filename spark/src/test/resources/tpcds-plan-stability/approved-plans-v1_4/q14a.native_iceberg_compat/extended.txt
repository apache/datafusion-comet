TakeOrderedAndProject
+- HashAggregate
   +- CometColumnarToRow
      +- CometColumnarExchange
         +- HashAggregate
            +- Expand
               +- Union
                  :- Project
                  :  +- Filter
                  :     :  +- Subquery
                  :     :     +- HashAggregate
                  :     :        +- CometColumnarToRow
                  :     :           +- CometColumnarExchange
                  :     :              +- HashAggregate
                  :     :                 +- Union
                  :     :                    :- Project
                  :     :                    :  +- BroadcastHashJoin
                  :     :                    :     :- ColumnarToRow
                  :     :                    :     :  +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :     :                    :     :        +- ReusedSubquery
                  :     :                    :     +- BroadcastExchange
                  :     :                    :        +- CometColumnarToRow
                  :     :                    :           +- CometProject
                  :     :                    :              +- CometFilter
                  :     :                    :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :     :                    :- Project
                  :     :                    :  +- BroadcastHashJoin
                  :     :                    :     :- ColumnarToRow
                  :     :                    :     :  +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :     :                    :     :        +- ReusedSubquery
                  :     :                    :     +- BroadcastExchange
                  :     :                    :        +- CometColumnarToRow
                  :     :                    :           +- CometProject
                  :     :                    :              +- CometFilter
                  :     :                    :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :     :                    +- Project
                  :     :                       +- BroadcastHashJoin
                  :     :                          :- ColumnarToRow
                  :     :                          :  +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :     :                          :        +- ReusedSubquery
                  :     :                          +- BroadcastExchange
                  :     :                             +- CometColumnarToRow
                  :     :                                +- CometProject
                  :     :                                   +- CometFilter
                  :     :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :     +- HashAggregate
                  :        +- CometColumnarToRow
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- Project
                  :                       :  +- BroadcastHashJoin
                  :                       :     :- BroadcastHashJoin
                  :                       :     :  :- Filter
                  :                       :     :  :  +- ColumnarToRow
                  :                       :     :  :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :     :  :           +- SubqueryBroadcast
                  :                       :     :  :              +- BroadcastExchange
                  :                       :     :  :                 +- CometColumnarToRow
                  :                       :     :  :                    +- CometProject
                  :                       :     :  :                       +- CometFilter
                  :                       :     :  :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :     :  +- BroadcastExchange
                  :                       :     :     +- Project
                  :                       :     :        +- BroadcastHashJoin
                  :                       :     :           :- CometColumnarToRow
                  :                       :     :           :  +- CometFilter
                  :                       :     :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :     :           +- BroadcastExchange
                  :                       :     :              +- BroadcastHashJoin
                  :                       :     :                 :- CometColumnarToRow
                  :                       :     :                 :  +- CometHashAggregate
                  :                       :     :                 :     +- CometColumnarExchange
                  :                       :     :                 :        +- HashAggregate
                  :                       :     :                 :           +- Project
                  :                       :     :                 :              +- BroadcastHashJoin
                  :                       :     :                 :                 :- Project
                  :                       :     :                 :                 :  +- BroadcastHashJoin
                  :                       :     :                 :                 :     :- Filter
                  :                       :     :                 :                 :     :  +- ColumnarToRow
                  :                       :     :                 :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :     :                 :                 :     :           +- SubqueryBroadcast
                  :                       :     :                 :                 :     :              +- BroadcastExchange
                  :                       :     :                 :                 :     :                 +- CometColumnarToRow
                  :                       :     :                 :                 :     :                    +- CometProject
                  :                       :     :                 :                 :     :                       +- CometFilter
                  :                       :     :                 :                 :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :     :                 :                 :     +- BroadcastExchange
                  :                       :     :                 :                 :        +- BroadcastHashJoin
                  :                       :     :                 :                 :           :- CometColumnarToRow
                  :                       :     :                 :                 :           :  +- CometFilter
                  :                       :     :                 :                 :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :     :                 :                 :           +- BroadcastExchange
                  :                       :     :                 :                 :              +- Project
                  :                       :     :                 :                 :                 +- BroadcastHashJoin
                  :                       :     :                 :                 :                    :- Project
                  :                       :     :                 :                 :                    :  +- BroadcastHashJoin
                  :                       :     :                 :                 :                    :     :- Filter
                  :                       :     :                 :                 :                    :     :  +- ColumnarToRow
                  :                       :     :                 :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :     :                 :                 :                    :     :           +- ReusedSubquery
                  :                       :     :                 :                 :                    :     +- BroadcastExchange
                  :                       :     :                 :                 :                    :        +- CometColumnarToRow
                  :                       :     :                 :                 :                    :           +- CometFilter
                  :                       :     :                 :                 :                    :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :     :                 :                 :                    +- BroadcastExchange
                  :                       :     :                 :                 :                       +- CometColumnarToRow
                  :                       :     :                 :                 :                          +- CometProject
                  :                       :     :                 :                 :                             +- CometFilter
                  :                       :     :                 :                 :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :     :                 :                 +- BroadcastExchange
                  :                       :     :                 :                    +- CometColumnarToRow
                  :                       :     :                 :                       +- CometProject
                  :                       :     :                 :                          +- CometFilter
                  :                       :     :                 :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :     :                 +- BroadcastExchange
                  :                       :     :                    +- Project
                  :                       :     :                       +- BroadcastHashJoin
                  :                       :     :                          :- Project
                  :                       :     :                          :  +- BroadcastHashJoin
                  :                       :     :                          :     :- Filter
                  :                       :     :                          :     :  +- ColumnarToRow
                  :                       :     :                          :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :     :                          :     :           +- ReusedSubquery
                  :                       :     :                          :     +- BroadcastExchange
                  :                       :     :                          :        +- CometColumnarToRow
                  :                       :     :                          :           +- CometFilter
                  :                       :     :                          :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :     :                          +- BroadcastExchange
                  :                       :     :                             +- CometColumnarToRow
                  :                       :     :                                +- CometProject
                  :                       :     :                                   +- CometFilter
                  :                       :     :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :     +- BroadcastExchange
                  :                       :        +- BroadcastHashJoin
                  :                       :           :- CometColumnarToRow
                  :                       :           :  +- CometFilter
                  :                       :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :           +- BroadcastExchange
                  :                       :              +- Project
                  :                       :                 +- BroadcastHashJoin
                  :                       :                    :- CometColumnarToRow
                  :                       :                    :  +- CometFilter
                  :                       :                    :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :                    +- BroadcastExchange
                  :                       :                       +- BroadcastHashJoin
                  :                       :                          :- CometColumnarToRow
                  :                       :                          :  +- CometHashAggregate
                  :                       :                          :     +- CometColumnarExchange
                  :                       :                          :        +- HashAggregate
                  :                       :                          :           +- Project
                  :                       :                          :              +- BroadcastHashJoin
                  :                       :                          :                 :- Project
                  :                       :                          :                 :  +- BroadcastHashJoin
                  :                       :                          :                 :     :- Filter
                  :                       :                          :                 :     :  +- ColumnarToRow
                  :                       :                          :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :                          :                 :     :           +- SubqueryBroadcast
                  :                       :                          :                 :     :              +- BroadcastExchange
                  :                       :                          :                 :     :                 +- CometColumnarToRow
                  :                       :                          :                 :     :                    +- CometProject
                  :                       :                          :                 :     :                       +- CometFilter
                  :                       :                          :                 :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :                          :                 :     +- BroadcastExchange
                  :                       :                          :                 :        +- BroadcastHashJoin
                  :                       :                          :                 :           :- CometColumnarToRow
                  :                       :                          :                 :           :  +- CometFilter
                  :                       :                          :                 :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :                          :                 :           +- BroadcastExchange
                  :                       :                          :                 :              +- Project
                  :                       :                          :                 :                 +- BroadcastHashJoin
                  :                       :                          :                 :                    :- Project
                  :                       :                          :                 :                    :  +- BroadcastHashJoin
                  :                       :                          :                 :                    :     :- Filter
                  :                       :                          :                 :                    :     :  +- ColumnarToRow
                  :                       :                          :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :                          :                 :                    :     :           +- ReusedSubquery
                  :                       :                          :                 :                    :     +- BroadcastExchange
                  :                       :                          :                 :                    :        +- CometColumnarToRow
                  :                       :                          :                 :                    :           +- CometFilter
                  :                       :                          :                 :                    :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :                          :                 :                    +- BroadcastExchange
                  :                       :                          :                 :                       +- CometColumnarToRow
                  :                       :                          :                 :                          +- CometProject
                  :                       :                          :                 :                             +- CometFilter
                  :                       :                          :                 :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :                          :                 +- BroadcastExchange
                  :                       :                          :                    +- CometColumnarToRow
                  :                       :                          :                       +- CometProject
                  :                       :                          :                          +- CometFilter
                  :                       :                          :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :                          +- BroadcastExchange
                  :                       :                             +- Project
                  :                       :                                +- BroadcastHashJoin
                  :                       :                                   :- Project
                  :                       :                                   :  +- BroadcastHashJoin
                  :                       :                                   :     :- Filter
                  :                       :                                   :     :  +- ColumnarToRow
                  :                       :                                   :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :                                   :     :           +- ReusedSubquery
                  :                       :                                   :     +- BroadcastExchange
                  :                       :                                   :        +- CometColumnarToRow
                  :                       :                                   :           +- CometFilter
                  :                       :                                   :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :                                   +- BroadcastExchange
                  :                       :                                      +- CometColumnarToRow
                  :                       :                                         +- CometProject
                  :                       :                                            +- CometFilter
                  :                       :                                               +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :- Project
                  :  +- Filter
                  :     :  +- ReusedSubquery
                  :     +- HashAggregate
                  :        +- CometColumnarToRow
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- Project
                  :                       :  +- BroadcastHashJoin
                  :                       :     :- BroadcastHashJoin
                  :                       :     :  :- Filter
                  :                       :     :  :  +- ColumnarToRow
                  :                       :     :  :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :     :  :           +- ReusedSubquery
                  :                       :     :  +- BroadcastExchange
                  :                       :     :     +- Project
                  :                       :     :        +- BroadcastHashJoin
                  :                       :     :           :- CometColumnarToRow
                  :                       :     :           :  +- CometFilter
                  :                       :     :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :     :           +- BroadcastExchange
                  :                       :     :              +- BroadcastHashJoin
                  :                       :     :                 :- CometColumnarToRow
                  :                       :     :                 :  +- CometHashAggregate
                  :                       :     :                 :     +- CometColumnarExchange
                  :                       :     :                 :        +- HashAggregate
                  :                       :     :                 :           +- Project
                  :                       :     :                 :              +- BroadcastHashJoin
                  :                       :     :                 :                 :- Project
                  :                       :     :                 :                 :  +- BroadcastHashJoin
                  :                       :     :                 :                 :     :- Filter
                  :                       :     :                 :                 :     :  +- ColumnarToRow
                  :                       :     :                 :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :     :                 :                 :     :           +- SubqueryBroadcast
                  :                       :     :                 :                 :     :              +- BroadcastExchange
                  :                       :     :                 :                 :     :                 +- CometColumnarToRow
                  :                       :     :                 :                 :     :                    +- CometProject
                  :                       :     :                 :                 :     :                       +- CometFilter
                  :                       :     :                 :                 :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :     :                 :                 :     +- BroadcastExchange
                  :                       :     :                 :                 :        +- BroadcastHashJoin
                  :                       :     :                 :                 :           :- CometColumnarToRow
                  :                       :     :                 :                 :           :  +- CometFilter
                  :                       :     :                 :                 :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :     :                 :                 :           +- BroadcastExchange
                  :                       :     :                 :                 :              +- Project
                  :                       :     :                 :                 :                 +- BroadcastHashJoin
                  :                       :     :                 :                 :                    :- Project
                  :                       :     :                 :                 :                    :  +- BroadcastHashJoin
                  :                       :     :                 :                 :                    :     :- Filter
                  :                       :     :                 :                 :                    :     :  +- ColumnarToRow
                  :                       :     :                 :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :     :                 :                 :                    :     :           +- ReusedSubquery
                  :                       :     :                 :                 :                    :     +- BroadcastExchange
                  :                       :     :                 :                 :                    :        +- CometColumnarToRow
                  :                       :     :                 :                 :                    :           +- CometFilter
                  :                       :     :                 :                 :                    :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :     :                 :                 :                    +- BroadcastExchange
                  :                       :     :                 :                 :                       +- CometColumnarToRow
                  :                       :     :                 :                 :                          +- CometProject
                  :                       :     :                 :                 :                             +- CometFilter
                  :                       :     :                 :                 :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :     :                 :                 +- BroadcastExchange
                  :                       :     :                 :                    +- CometColumnarToRow
                  :                       :     :                 :                       +- CometProject
                  :                       :     :                 :                          +- CometFilter
                  :                       :     :                 :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :     :                 +- BroadcastExchange
                  :                       :     :                    +- Project
                  :                       :     :                       +- BroadcastHashJoin
                  :                       :     :                          :- Project
                  :                       :     :                          :  +- BroadcastHashJoin
                  :                       :     :                          :     :- Filter
                  :                       :     :                          :     :  +- ColumnarToRow
                  :                       :     :                          :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :     :                          :     :           +- ReusedSubquery
                  :                       :     :                          :     +- BroadcastExchange
                  :                       :     :                          :        +- CometColumnarToRow
                  :                       :     :                          :           +- CometFilter
                  :                       :     :                          :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :     :                          +- BroadcastExchange
                  :                       :     :                             +- CometColumnarToRow
                  :                       :     :                                +- CometProject
                  :                       :     :                                   +- CometFilter
                  :                       :     :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :     +- BroadcastExchange
                  :                       :        +- BroadcastHashJoin
                  :                       :           :- CometColumnarToRow
                  :                       :           :  +- CometFilter
                  :                       :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :           +- BroadcastExchange
                  :                       :              +- Project
                  :                       :                 +- BroadcastHashJoin
                  :                       :                    :- CometColumnarToRow
                  :                       :                    :  +- CometFilter
                  :                       :                    :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :                    +- BroadcastExchange
                  :                       :                       +- BroadcastHashJoin
                  :                       :                          :- CometColumnarToRow
                  :                       :                          :  +- CometHashAggregate
                  :                       :                          :     +- CometColumnarExchange
                  :                       :                          :        +- HashAggregate
                  :                       :                          :           +- Project
                  :                       :                          :              +- BroadcastHashJoin
                  :                       :                          :                 :- Project
                  :                       :                          :                 :  +- BroadcastHashJoin
                  :                       :                          :                 :     :- Filter
                  :                       :                          :                 :     :  +- ColumnarToRow
                  :                       :                          :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :                          :                 :     :           +- SubqueryBroadcast
                  :                       :                          :                 :     :              +- BroadcastExchange
                  :                       :                          :                 :     :                 +- CometColumnarToRow
                  :                       :                          :                 :     :                    +- CometProject
                  :                       :                          :                 :     :                       +- CometFilter
                  :                       :                          :                 :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :                          :                 :     +- BroadcastExchange
                  :                       :                          :                 :        +- BroadcastHashJoin
                  :                       :                          :                 :           :- CometColumnarToRow
                  :                       :                          :                 :           :  +- CometFilter
                  :                       :                          :                 :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :                          :                 :           +- BroadcastExchange
                  :                       :                          :                 :              +- Project
                  :                       :                          :                 :                 +- BroadcastHashJoin
                  :                       :                          :                 :                    :- Project
                  :                       :                          :                 :                    :  +- BroadcastHashJoin
                  :                       :                          :                 :                    :     :- Filter
                  :                       :                          :                 :                    :     :  +- ColumnarToRow
                  :                       :                          :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :                          :                 :                    :     :           +- ReusedSubquery
                  :                       :                          :                 :                    :     +- BroadcastExchange
                  :                       :                          :                 :                    :        +- CometColumnarToRow
                  :                       :                          :                 :                    :           +- CometFilter
                  :                       :                          :                 :                    :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :                          :                 :                    +- BroadcastExchange
                  :                       :                          :                 :                       +- CometColumnarToRow
                  :                       :                          :                 :                          +- CometProject
                  :                       :                          :                 :                             +- CometFilter
                  :                       :                          :                 :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :                          :                 +- BroadcastExchange
                  :                       :                          :                    +- CometColumnarToRow
                  :                       :                          :                       +- CometProject
                  :                       :                          :                          +- CometFilter
                  :                       :                          :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       :                          +- BroadcastExchange
                  :                       :                             +- Project
                  :                       :                                +- BroadcastHashJoin
                  :                       :                                   :- Project
                  :                       :                                   :  +- BroadcastHashJoin
                  :                       :                                   :     :- Filter
                  :                       :                                   :     :  +- ColumnarToRow
                  :                       :                                   :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :                                   :     :           +- ReusedSubquery
                  :                       :                                   :     +- BroadcastExchange
                  :                       :                                   :        +- CometColumnarToRow
                  :                       :                                   :           +- CometFilter
                  :                       :                                   :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                  :                       :                                   +- BroadcastExchange
                  :                       :                                      +- CometColumnarToRow
                  :                       :                                         +- CometProject
                  :                       :                                            +- CometFilter
                  :                       :                                               +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  +- Project
                     +- Filter
                        :  +- ReusedSubquery
                        +- HashAggregate
                           +- CometColumnarToRow
                              +- CometColumnarExchange
                                 +- HashAggregate
                                    +- Project
                                       +- BroadcastHashJoin
                                          :- Project
                                          :  +- BroadcastHashJoin
                                          :     :- BroadcastHashJoin
                                          :     :  :- Filter
                                          :     :  :  +- ColumnarToRow
                                          :     :  :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                          :     :  :           +- ReusedSubquery
                                          :     :  +- BroadcastExchange
                                          :     :     +- Project
                                          :     :        +- BroadcastHashJoin
                                          :     :           :- CometColumnarToRow
                                          :     :           :  +- CometFilter
                                          :     :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :     :           +- BroadcastExchange
                                          :     :              +- BroadcastHashJoin
                                          :     :                 :- CometColumnarToRow
                                          :     :                 :  +- CometHashAggregate
                                          :     :                 :     +- CometColumnarExchange
                                          :     :                 :        +- HashAggregate
                                          :     :                 :           +- Project
                                          :     :                 :              +- BroadcastHashJoin
                                          :     :                 :                 :- Project
                                          :     :                 :                 :  +- BroadcastHashJoin
                                          :     :                 :                 :     :- Filter
                                          :     :                 :                 :     :  +- ColumnarToRow
                                          :     :                 :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                          :     :                 :                 :     :           +- SubqueryBroadcast
                                          :     :                 :                 :     :              +- BroadcastExchange
                                          :     :                 :                 :     :                 +- CometColumnarToRow
                                          :     :                 :                 :     :                    +- CometProject
                                          :     :                 :                 :     :                       +- CometFilter
                                          :     :                 :                 :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :     :                 :                 :     +- BroadcastExchange
                                          :     :                 :                 :        +- BroadcastHashJoin
                                          :     :                 :                 :           :- CometColumnarToRow
                                          :     :                 :                 :           :  +- CometFilter
                                          :     :                 :                 :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :     :                 :                 :           +- BroadcastExchange
                                          :     :                 :                 :              +- Project
                                          :     :                 :                 :                 +- BroadcastHashJoin
                                          :     :                 :                 :                    :- Project
                                          :     :                 :                 :                    :  +- BroadcastHashJoin
                                          :     :                 :                 :                    :     :- Filter
                                          :     :                 :                 :                    :     :  +- ColumnarToRow
                                          :     :                 :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                          :     :                 :                 :                    :     :           +- ReusedSubquery
                                          :     :                 :                 :                    :     +- BroadcastExchange
                                          :     :                 :                 :                    :        +- CometColumnarToRow
                                          :     :                 :                 :                    :           +- CometFilter
                                          :     :                 :                 :                    :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :     :                 :                 :                    +- BroadcastExchange
                                          :     :                 :                 :                       +- CometColumnarToRow
                                          :     :                 :                 :                          +- CometProject
                                          :     :                 :                 :                             +- CometFilter
                                          :     :                 :                 :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :     :                 :                 +- BroadcastExchange
                                          :     :                 :                    +- CometColumnarToRow
                                          :     :                 :                       +- CometProject
                                          :     :                 :                          +- CometFilter
                                          :     :                 :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :     :                 +- BroadcastExchange
                                          :     :                    +- Project
                                          :     :                       +- BroadcastHashJoin
                                          :     :                          :- Project
                                          :     :                          :  +- BroadcastHashJoin
                                          :     :                          :     :- Filter
                                          :     :                          :     :  +- ColumnarToRow
                                          :     :                          :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                          :     :                          :     :           +- ReusedSubquery
                                          :     :                          :     +- BroadcastExchange
                                          :     :                          :        +- CometColumnarToRow
                                          :     :                          :           +- CometFilter
                                          :     :                          :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :     :                          +- BroadcastExchange
                                          :     :                             +- CometColumnarToRow
                                          :     :                                +- CometProject
                                          :     :                                   +- CometFilter
                                          :     :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :     +- BroadcastExchange
                                          :        +- BroadcastHashJoin
                                          :           :- CometColumnarToRow
                                          :           :  +- CometFilter
                                          :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :           +- BroadcastExchange
                                          :              +- Project
                                          :                 +- BroadcastHashJoin
                                          :                    :- CometColumnarToRow
                                          :                    :  +- CometFilter
                                          :                    :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :                    +- BroadcastExchange
                                          :                       +- BroadcastHashJoin
                                          :                          :- CometColumnarToRow
                                          :                          :  +- CometHashAggregate
                                          :                          :     +- CometColumnarExchange
                                          :                          :        +- HashAggregate
                                          :                          :           +- Project
                                          :                          :              +- BroadcastHashJoin
                                          :                          :                 :- Project
                                          :                          :                 :  +- BroadcastHashJoin
                                          :                          :                 :     :- Filter
                                          :                          :                 :     :  +- ColumnarToRow
                                          :                          :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                          :                          :                 :     :           +- SubqueryBroadcast
                                          :                          :                 :     :              +- BroadcastExchange
                                          :                          :                 :     :                 +- CometColumnarToRow
                                          :                          :                 :     :                    +- CometProject
                                          :                          :                 :     :                       +- CometFilter
                                          :                          :                 :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :                          :                 :     +- BroadcastExchange
                                          :                          :                 :        +- BroadcastHashJoin
                                          :                          :                 :           :- CometColumnarToRow
                                          :                          :                 :           :  +- CometFilter
                                          :                          :                 :           :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :                          :                 :           +- BroadcastExchange
                                          :                          :                 :              +- Project
                                          :                          :                 :                 +- BroadcastHashJoin
                                          :                          :                 :                    :- Project
                                          :                          :                 :                    :  +- BroadcastHashJoin
                                          :                          :                 :                    :     :- Filter
                                          :                          :                 :                    :     :  +- ColumnarToRow
                                          :                          :                 :                    :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                          :                          :                 :                    :     :           +- ReusedSubquery
                                          :                          :                 :                    :     +- BroadcastExchange
                                          :                          :                 :                    :        +- CometColumnarToRow
                                          :                          :                 :                    :           +- CometFilter
                                          :                          :                 :                    :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :                          :                 :                    +- BroadcastExchange
                                          :                          :                 :                       +- CometColumnarToRow
                                          :                          :                 :                          +- CometProject
                                          :                          :                 :                             +- CometFilter
                                          :                          :                 :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :                          :                 +- BroadcastExchange
                                          :                          :                    +- CometColumnarToRow
                                          :                          :                       +- CometProject
                                          :                          :                          +- CometFilter
                                          :                          :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :                          +- BroadcastExchange
                                          :                             +- Project
                                          :                                +- BroadcastHashJoin
                                          :                                   :- Project
                                          :                                   :  +- BroadcastHashJoin
                                          :                                   :     :- Filter
                                          :                                   :     :  +- ColumnarToRow
                                          :                                   :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                          :                                   :     :           +- ReusedSubquery
                                          :                                   :     +- BroadcastExchange
                                          :                                   :        +- CometColumnarToRow
                                          :                                   :           +- CometFilter
                                          :                                   :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :                                   +- BroadcastExchange
                                          :                                      +- CometColumnarToRow
                                          :                                         +- CometProject
                                          :                                            +- CometFilter
                                          :                                               +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          +- BroadcastExchange
                                             +- CometColumnarToRow
                                                +- CometProject
                                                   +- CometFilter
                                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim

Comet accelerated 164 out of 458 eligible operators (35%). Final plan contains 93 transitions between Spark and Comet.