TakeOrderedAndProject
+- Project
   +- Filter
      +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
         +- CometNativeColumnarToRow
            +- CometSort
               +- CometColumnarExchange
                  +- HashAggregate
                     +- CometNativeColumnarToRow
                        +- CometColumnarExchange
                           +- HashAggregate
                              +- Project
                                 +- BroadcastHashJoin
                                    :- Project
                                    :  +- BroadcastHashJoin
                                    :     :- Project
                                    :     :  +- BroadcastHashJoin
                                    :     :     :- CometNativeColumnarToRow
                                    :     :     :  +- CometProject
                                    :     :     :     +- CometFilter
                                    :     :     :        +- CometNativeScan parquet spark_catalog.default.item
                                    :     :     +- BroadcastExchange
                                    :     :        +- Filter
                                    :     :           +- ColumnarToRow
                                    :     :              +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                    :     :                    +- SubqueryBroadcast
                                    :     :                       +- BroadcastExchange
                                    :     :                          +- CometNativeColumnarToRow
                                    :     :                             +- CometProject
                                    :     :                                +- CometFilter
                                    :     :                                   +- CometNativeScan parquet spark_catalog.default.date_dim
                                    :     +- BroadcastExchange
                                    :        +- CometNativeColumnarToRow
                                    :           +- CometProject
                                    :              +- CometFilter
                                    :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                    +- BroadcastExchange
                                       +- CometNativeColumnarToRow
                                          +- CometFilter
                                             +- CometNativeScan parquet spark_catalog.default.store

Comet accelerated 14 out of 33 eligible operators (42%). Final plan contains 7 transitions between Spark and Comet.