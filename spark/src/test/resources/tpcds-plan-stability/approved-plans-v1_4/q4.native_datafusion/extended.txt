TakeOrderedAndProject
+- Project
   +- BroadcastHashJoin
      :- Project
      :  +- BroadcastHashJoin
      :     :- Project
      :     :  +- BroadcastHashJoin
      :     :     :- Project
      :     :     :  +- BroadcastHashJoin
      :     :     :     :- BroadcastHashJoin
      :     :     :     :  :- Filter
      :     :     :     :  :  +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
      :     :     :     :  :     +- CometColumnarToRow
      :     :     :     :  :        +- CometColumnarExchange
      :     :     :     :  :           +- HashAggregate
      :     :     :     :  :              +- Project
      :     :     :     :  :                 +- BroadcastHashJoin
      :     :     :     :  :                    :- Project
      :     :     :     :  :                    :  +- BroadcastHashJoin
      :     :     :     :  :                    :     :- CometColumnarToRow
      :     :     :     :  :                    :     :  +- CometProject
      :     :     :     :  :                    :     :     +- CometFilter
      :     :     :     :  :                    :     :        +- CometNativeScan parquet spark_catalog.default.customer
      :     :     :     :  :                    :     +- BroadcastExchange
      :     :     :     :  :                    :        +- Filter
      :     :     :     :  :                    :           +- ColumnarToRow
      :     :     :     :  :                    :              +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
      :     :     :     :  :                    :                    +- SubqueryBroadcast
      :     :     :     :  :                    :                       +- BroadcastExchange
      :     :     :     :  :                    :                          +- CometColumnarToRow
      :     :     :     :  :                    :                             +- CometFilter
      :     :     :     :  :                    :                                +- CometNativeScan parquet spark_catalog.default.date_dim
      :     :     :     :  :                    +- BroadcastExchange
      :     :     :     :  :                       +- CometColumnarToRow
      :     :     :     :  :                          +- CometFilter
      :     :     :     :  :                             +- CometNativeScan parquet spark_catalog.default.date_dim
      :     :     :     :  +- BroadcastExchange
      :     :     :     :     +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
      :     :     :     :        +- CometColumnarToRow
      :     :     :     :           +- CometColumnarExchange
      :     :     :     :              +- HashAggregate
      :     :     :     :                 +- Project
      :     :     :     :                    +- BroadcastHashJoin
      :     :     :     :                       :- Project
      :     :     :     :                       :  +- BroadcastHashJoin
      :     :     :     :                       :     :- CometColumnarToRow
      :     :     :     :                       :     :  +- CometProject
      :     :     :     :                       :     :     +- CometFilter
      :     :     :     :                       :     :        +- CometNativeScan parquet spark_catalog.default.customer
      :     :     :     :                       :     +- BroadcastExchange
      :     :     :     :                       :        +- Filter
      :     :     :     :                       :           +- ColumnarToRow
      :     :     :     :                       :              +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
      :     :     :     :                       :                    +- SubqueryBroadcast
      :     :     :     :                       :                       +- BroadcastExchange
      :     :     :     :                       :                          +- CometColumnarToRow
      :     :     :     :                       :                             +- CometFilter
      :     :     :     :                       :                                +- CometNativeScan parquet spark_catalog.default.date_dim
      :     :     :     :                       +- BroadcastExchange
      :     :     :     :                          +- CometColumnarToRow
      :     :     :     :                             +- CometFilter
      :     :     :     :                                +- CometNativeScan parquet spark_catalog.default.date_dim
      :     :     :     +- BroadcastExchange
      :     :     :        +- Filter
      :     :     :           +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
      :     :     :              +- CometColumnarToRow
      :     :     :                 +- CometColumnarExchange
      :     :     :                    +- HashAggregate
      :     :     :                       +- Project
      :     :     :                          +- BroadcastHashJoin
      :     :     :                             :- Project
      :     :     :                             :  +- BroadcastHashJoin
      :     :     :                             :     :- CometColumnarToRow
      :     :     :                             :     :  +- CometProject
      :     :     :                             :     :     +- CometFilter
      :     :     :                             :     :        +- CometNativeScan parquet spark_catalog.default.customer
      :     :     :                             :     +- BroadcastExchange
      :     :     :                             :        +- Filter
      :     :     :                             :           +- ColumnarToRow
      :     :     :                             :              +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
      :     :     :                             :                    +- ReusedSubquery
      :     :     :                             +- BroadcastExchange
      :     :     :                                +- CometColumnarToRow
      :     :     :                                   +- CometFilter
      :     :     :                                      +- CometNativeScan parquet spark_catalog.default.date_dim
      :     :     +- BroadcastExchange
      :     :        +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
      :     :           +- CometColumnarToRow
      :     :              +- CometColumnarExchange
      :     :                 +- HashAggregate
      :     :                    +- Project
      :     :                       +- BroadcastHashJoin
      :     :                          :- Project
      :     :                          :  +- BroadcastHashJoin
      :     :                          :     :- CometColumnarToRow
      :     :                          :     :  +- CometProject
      :     :                          :     :     +- CometFilter
      :     :                          :     :        +- CometNativeScan parquet spark_catalog.default.customer
      :     :                          :     +- BroadcastExchange
      :     :                          :        +- Filter
      :     :                          :           +- ColumnarToRow
      :     :                          :              +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
      :     :                          :                    +- ReusedSubquery
      :     :                          +- BroadcastExchange
      :     :                             +- CometColumnarToRow
      :     :                                +- CometFilter
      :     :                                   +- CometNativeScan parquet spark_catalog.default.date_dim
      :     +- BroadcastExchange
      :        +- Filter
      :           +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
      :              +- CometColumnarToRow
      :                 +- CometColumnarExchange
      :                    +- HashAggregate
      :                       +- Project
      :                          +- BroadcastHashJoin
      :                             :- Project
      :                             :  +- BroadcastHashJoin
      :                             :     :- CometColumnarToRow
      :                             :     :  +- CometProject
      :                             :     :     +- CometFilter
      :                             :     :        +- CometNativeScan parquet spark_catalog.default.customer
      :                             :     +- BroadcastExchange
      :                             :        +- Filter
      :                             :           +- ColumnarToRow
      :                             :              +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
      :                             :                    +- ReusedSubquery
      :                             +- BroadcastExchange
      :                                +- CometColumnarToRow
      :                                   +- CometFilter
      :                                      +- CometNativeScan parquet spark_catalog.default.date_dim
      +- BroadcastExchange
         +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
            +- CometColumnarToRow
               +- CometColumnarExchange
                  +- HashAggregate
                     +- Project
                        +- BroadcastHashJoin
                           :- Project
                           :  +- BroadcastHashJoin
                           :     :- CometColumnarToRow
                           :     :  +- CometProject
                           :     :     +- CometFilter
                           :     :        +- CometNativeScan parquet spark_catalog.default.customer
                           :     +- BroadcastExchange
                           :        +- Filter
                           :           +- ColumnarToRow
                           :              +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :                    +- ReusedSubquery
                           +- BroadcastExchange
                              +- CometColumnarToRow
                                 +- CometFilter
                                    +- CometNativeScan parquet spark_catalog.default.date_dim

Comet accelerated 40 out of 126 eligible operators (31%). Final plan contains 26 transitions between Spark and Comet.