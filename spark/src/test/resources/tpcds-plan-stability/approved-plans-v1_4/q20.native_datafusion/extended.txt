TakeOrderedAndProject
+- Project
   +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
      +- CometColumnarToRow
         +- CometSort
            +- CometColumnarExchange
               +- HashAggregate
                  +- CometColumnarToRow
                     +- CometColumnarExchange
                        +- HashAggregate
                           +- Project
                              +- BroadcastHashJoin
                                 :- Project
                                 :  +- BroadcastHashJoin
                                 :     :- Filter
                                 :     :  +- ColumnarToRow
                                 :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: native_datafusion scan with DPP requires AQE to be enabled. DPP subqueries are not properly prepared in non-AQE mode.]
                                 :     :           +- SubqueryBroadcast
                                 :     :              +- BroadcastExchange
                                 :     :                 +- CometColumnarToRow
                                 :     :                    +- CometProject
                                 :     :                       +- CometFilter
                                 :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                                 :     +- BroadcastExchange
                                 :        +- CometColumnarToRow
                                 :           +- CometProject
                                 :              +- CometFilter
                                 :                 +- CometNativeScan parquet spark_catalog.default.item
                                 +- BroadcastExchange
                                    +- CometColumnarToRow
                                       +- CometProject
                                          +- CometFilter
                                             +- CometNativeScan parquet spark_catalog.default.date_dim

Comet accelerated 12 out of 27 eligible operators (44%). Final plan contains 6 transitions between Spark and Comet.