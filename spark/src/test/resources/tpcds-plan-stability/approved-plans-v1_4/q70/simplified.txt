WholeStageCodegen (1)
  CometColumnarToRow
    InputAdapter
      CometTakeOrderedAndProject [total_sum,s_state,s_county,lochierarchy,rank_within_parent]
        CometProject [total_sum,s_state,s_county,lochierarchy,rank_within_parent]
          CometWindowExec [total_sum,s_state,s_county,lochierarchy,_w0,_w1,_w2,rank_within_parent]
            CometSort [total_sum,s_state,s_county,lochierarchy,_w0,_w1,_w2]
              CometExchange [_w1,_w2] #1
                CometHashAggregate [sum] [total_sum,s_state,s_county,lochierarchy,_w0,_w1,_w2,sum(UnscaledValue(ss_net_profit)),spark_grouping_id]
                  CometExchange [s_state,s_county,spark_grouping_id] #2
                    CometHashAggregate [ss_net_profit] [s_state,s_county,spark_grouping_id,sum]
                      CometExpand [s_state,s_county] [ss_net_profit,s_state,s_county,spark_grouping_id]
                        CometProject [ss_net_profit,s_state,s_county]
                          CometBroadcastHashJoin [ss_store_sk,ss_net_profit,s_store_sk,s_county,s_state]
                            CometProject [ss_store_sk,ss_net_profit]
                              CometBroadcastHashJoin [ss_store_sk,ss_net_profit,ss_sold_date_sk,d_date_sk]
                                CometFilter [ss_store_sk,ss_net_profit,ss_sold_date_sk]
                                  CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales [ss_store_sk,ss_net_profit,ss_sold_date_sk]
                                    SubqueryBroadcast [d_date_sk] #1
                                      BroadcastExchange #3
                                        WholeStageCodegen (1)
                                          CometColumnarToRow
                                            InputAdapter
                                              CometProject [d_date_sk]
                                                CometFilter [d_date_sk,d_month_seq]
                                                  CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim [d_date_sk,d_month_seq]
                                CometBroadcastExchange [d_date_sk] #4
                                  CometProject [d_date_sk]
                                    CometFilter [d_date_sk,d_month_seq]
                                      CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim [d_date_sk,d_month_seq]
                            CometBroadcastExchange [s_store_sk,s_county,s_state] #5
                              CometProject [s_state] [s_store_sk,s_county,s_state]
                                CometBroadcastHashJoin [s_store_sk,s_county,s_state,s_state]
                                  CometFilter [s_store_sk,s_county,s_state]
                                    CometScan [native_iceberg_compat] parquet spark_catalog.default.store [s_store_sk,s_county,s_state]
                                  CometBroadcastExchange [s_state] #6
                                    CometProject [s_state]
                                      CometFilter [s_state,_w0,ranking]
                                        CometWindowExec [s_state,_w0,ranking]
                                          CometSort [s_state,_w0]
                                            CometHashAggregate [sum] [s_state,_w0,sum(UnscaledValue(ss_net_profit))]
                                              CometExchange [s_state] #7
                                                CometHashAggregate [ss_net_profit] [s_state,sum]
                                                  CometProject [ss_net_profit,s_state]
                                                    CometBroadcastHashJoin [ss_net_profit,ss_sold_date_sk,s_state,d_date_sk]
                                                      CometProject [ss_net_profit,ss_sold_date_sk,s_state]
                                                        CometBroadcastHashJoin [ss_store_sk,ss_net_profit,ss_sold_date_sk,s_store_sk,s_state]
                                                          CometFilter [ss_store_sk,ss_net_profit,ss_sold_date_sk]
                                                            CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales [ss_store_sk,ss_net_profit,ss_sold_date_sk]
                                                              ReusedSubquery [d_date_sk] #1
                                                          CometBroadcastExchange [s_store_sk,s_state] #8
                                                            CometProject [s_state] [s_store_sk,s_state]
                                                              CometFilter [s_store_sk,s_state]
                                                                CometScan [native_iceberg_compat] parquet spark_catalog.default.store [s_store_sk,s_state]
                                                      ReusedExchange [d_date_sk] #4
