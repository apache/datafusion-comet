TakeOrderedAndProject
+- HashAggregate
   +- CometColumnarToRow
      +- CometColumnarExchange
         +- HashAggregate
            +- Expand
               +- Union
                  :- Project
                  :  +- BroadcastHashJoin
                  :     :- HashAggregate
                  :     :  +- CometColumnarToRow
                  :     :     +- CometColumnarExchange
                  :     :        +- HashAggregate
                  :     :           +- Project
                  :     :              +- BroadcastHashJoin
                  :     :                 :- Project
                  :     :                 :  +- BroadcastHashJoin
                  :     :                 :     :- Filter
                  :     :                 :     :  +- ColumnarToRow
                  :     :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :     :                 :     :           +- SubqueryBroadcast
                  :     :                 :     :              +- CometColumnarToRow
                  :     :                 :     :                 +- CometBroadcastExchange
                  :     :                 :     :                    +- CometProject
                  :     :                 :     :                       +- CometFilter
                  :     :                 :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :     :                 :     +- BroadcastExchange
                  :     :                 :        +- CometColumnarToRow
                  :     :                 :           +- CometProject
                  :     :                 :              +- CometFilter
                  :     :                 :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :     :                 +- BroadcastExchange
                  :     :                    +- CometColumnarToRow
                  :     :                       +- CometFilter
                  :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :     +- BroadcastExchange
                  :        +- HashAggregate
                  :           +- CometColumnarToRow
                  :              +- CometColumnarExchange
                  :                 +- HashAggregate
                  :                    +- Project
                  :                       +- BroadcastHashJoin
                  :                          :- Project
                  :                          :  +- BroadcastHashJoin
                  :                          :     :- Filter
                  :                          :     :  +- ColumnarToRow
                  :                          :     :     +-  Scan parquet spark_catalog.default.store_returns [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                          :     :           +- ReusedSubquery
                  :                          :     +- BroadcastExchange
                  :                          :        +- CometColumnarToRow
                  :                          :           +- CometProject
                  :                          :              +- CometFilter
                  :                          :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :                          +- BroadcastExchange
                  :                             +- CometColumnarToRow
                  :                                +- CometFilter
                  :                                   +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                  :- Project
                  :  +- BroadcastNestedLoopJoin
                  :     :- BroadcastExchange
                  :     :  +- HashAggregate
                  :     :     +- CometColumnarToRow
                  :     :        +- CometColumnarExchange
                  :     :           +- HashAggregate
                  :     :              +- Project
                  :     :                 +- BroadcastHashJoin
                  :     :                    :- ColumnarToRow
                  :     :                    :  +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :     :                    :        +- ReusedSubquery
                  :     :                    +- BroadcastExchange
                  :     :                       +- CometColumnarToRow
                  :     :                          +- CometProject
                  :     :                             +- CometFilter
                  :     :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  :     +- HashAggregate
                  :        +- CometColumnarToRow
                  :           +- CometColumnarExchange
                  :              +- HashAggregate
                  :                 +- Project
                  :                    +- BroadcastHashJoin
                  :                       :- ColumnarToRow
                  :                       :  +-  Scan parquet spark_catalog.default.catalog_returns [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                  :                       :        +- ReusedSubquery
                  :                       +- BroadcastExchange
                  :                          +- CometColumnarToRow
                  :                             +- CometProject
                  :                                +- CometFilter
                  :                                   +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                  +- Project
                     +- BroadcastHashJoin
                        :- HashAggregate
                        :  +- CometColumnarToRow
                        :     +- CometColumnarExchange
                        :        +- HashAggregate
                        :           +- Project
                        :              +- BroadcastHashJoin
                        :                 :- Project
                        :                 :  +- BroadcastHashJoin
                        :                 :     :- Filter
                        :                 :     :  +- ColumnarToRow
                        :                 :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                        :                 :     :           +- ReusedSubquery
                        :                 :     +- BroadcastExchange
                        :                 :        +- CometColumnarToRow
                        :                 :           +- CometProject
                        :                 :              +- CometFilter
                        :                 :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                        :                 +- BroadcastExchange
                        :                    +- CometColumnarToRow
                        :                       +- CometFilter
                        :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_page
                        +- BroadcastExchange
                           +- HashAggregate
                              +- CometColumnarToRow
                                 +- CometColumnarExchange
                                    +- HashAggregate
                                       +- Project
                                          +- BroadcastHashJoin
                                             :- Project
                                             :  +- BroadcastHashJoin
                                             :     :- Filter
                                             :     :  +- ColumnarToRow
                                             :     :     +-  Scan parquet spark_catalog.default.web_returns [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                             :     :           +- ReusedSubquery
                                             :     +- BroadcastExchange
                                             :        +- CometColumnarToRow
                                             :           +- CometProject
                                             :              +- CometFilter
                                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                             +- BroadcastExchange
                                                +- CometColumnarToRow
                                                   +- CometFilter
                                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_page

Comet accelerated 37 out of 109 eligible operators (33%). Final plan contains 24 transitions between Spark and Comet.