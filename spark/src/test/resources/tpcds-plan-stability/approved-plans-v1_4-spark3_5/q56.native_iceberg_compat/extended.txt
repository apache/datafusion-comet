TakeOrderedAndProject
+- HashAggregate
   +- CometColumnarToRow
      +- CometColumnarExchange
         +- HashAggregate
            +- Union
               :- HashAggregate
               :  +- CometColumnarToRow
               :     +- CometColumnarExchange
               :        +- HashAggregate
               :           +- Project
               :              +- BroadcastHashJoin
               :                 :- Project
               :                 :  +- BroadcastHashJoin
               :                 :     :- Project
               :                 :     :  +- BroadcastHashJoin
               :                 :     :     :- Filter
               :                 :     :     :  +- ColumnarToRow
               :                 :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
               :                 :     :     :           +- SubqueryBroadcast
               :                 :     :     :              +- CometColumnarToRow
               :                 :     :     :                 +- CometBroadcastExchange
               :                 :     :     :                    +- CometProject
               :                 :     :     :                       +- CometFilter
               :                 :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
               :                 :     :     +- BroadcastExchange
               :                 :     :        +- CometColumnarToRow
               :                 :     :           +- CometProject
               :                 :     :              +- CometFilter
               :                 :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
               :                 :     +- BroadcastExchange
               :                 :        +- CometColumnarToRow
               :                 :           +- CometProject
               :                 :              +- CometFilter
               :                 :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_address
               :                 +- BroadcastExchange
               :                    +- CometColumnarToRow
               :                       +- CometProject
               :                          +- CometBroadcastHashJoin
               :                             :- CometFilter
               :                             :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
               :                             +- CometBroadcastExchange
               :                                +- CometProject
               :                                   +- CometFilter
               :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
               :- HashAggregate
               :  +- CometColumnarToRow
               :     +- CometColumnarExchange
               :        +- HashAggregate
               :           +- Project
               :              +- BroadcastHashJoin
               :                 :- Project
               :                 :  +- BroadcastHashJoin
               :                 :     :- Project
               :                 :     :  +- BroadcastHashJoin
               :                 :     :     :- Filter
               :                 :     :     :  +- ColumnarToRow
               :                 :     :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
               :                 :     :     :           +- ReusedSubquery
               :                 :     :     +- BroadcastExchange
               :                 :     :        +- CometColumnarToRow
               :                 :     :           +- CometProject
               :                 :     :              +- CometFilter
               :                 :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
               :                 :     +- BroadcastExchange
               :                 :        +- CometColumnarToRow
               :                 :           +- CometProject
               :                 :              +- CometFilter
               :                 :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_address
               :                 +- BroadcastExchange
               :                    +- CometColumnarToRow
               :                       +- CometProject
               :                          +- CometBroadcastHashJoin
               :                             :- CometFilter
               :                             :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
               :                             +- CometBroadcastExchange
               :                                +- CometProject
               :                                   +- CometFilter
               :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
               +- HashAggregate
                  +- CometColumnarToRow
                     +- CometColumnarExchange
                        +- HashAggregate
                           +- Project
                              +- BroadcastHashJoin
                                 :- Project
                                 :  +- BroadcastHashJoin
                                 :     :- Project
                                 :     :  +- BroadcastHashJoin
                                 :     :     :- Filter
                                 :     :     :  +- ColumnarToRow
                                 :     :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                 :     :     :           +- ReusedSubquery
                                 :     :     +- BroadcastExchange
                                 :     :        +- CometColumnarToRow
                                 :     :           +- CometProject
                                 :     :              +- CometFilter
                                 :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                 :     +- BroadcastExchange
                                 :        +- CometColumnarToRow
                                 :           +- CometProject
                                 :              +- CometFilter
                                 :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_address
                                 +- BroadcastExchange
                                    +- CometColumnarToRow
                                       +- CometProject
                                          +- CometBroadcastHashJoin
                                             :- CometFilter
                                             :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                             +- CometBroadcastExchange
                                                +- CometProject
                                                   +- CometFilter
                                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item

Comet accelerated 50 out of 96 eligible operators (52%). Final plan contains 17 transitions between Spark and Comet.