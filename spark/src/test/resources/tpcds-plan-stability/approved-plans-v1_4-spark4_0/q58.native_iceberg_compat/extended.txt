TakeOrderedAndProject
+- Project
   +- BroadcastHashJoin
      :- Project
      :  +- BroadcastHashJoin
      :     :- Filter
      :     :  +- HashAggregate
      :     :     +- CometColumnarToRow
      :     :        +- CometColumnarExchange
      :     :           +- HashAggregate
      :     :              +- Project
      :     :                 +- BroadcastHashJoin
      :     :                    :- Project
      :     :                    :  +- BroadcastHashJoin
      :     :                    :     :- Filter
      :     :                    :     :  +- ColumnarToRow
      :     :                    :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
      :     :                    :     :           +- SubqueryBroadcast
      :     :                    :     :              +- BroadcastExchange
      :     :                    :     :                 +- CometColumnarToRow
      :     :                    :     :                    +- CometProject
      :     :                    :     :                       +- CometBroadcastHashJoin
      :     :                    :     :                          :- CometFilter
      :     :                    :     :                          :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :     :                    :     :                          +- CometBroadcastExchange
      :     :                    :     :                             +- CometProject
      :     :                    :     :                                +- CometFilter
      :     :                    :     :                                   :  +- ReusedSubquery
      :     :                    :     :                                   +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :     :                    :     :                                         +- Subquery
      :     :                    :     :                                            +- CometColumnarToRow
      :     :                    :     :                                               +- CometProject
      :     :                    :     :                                                  +- CometFilter
      :     :                    :     :                                                     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :     :                    :     +- BroadcastExchange
      :     :                    :        +- CometColumnarToRow
      :     :                    :           +- CometProject
      :     :                    :              +- CometFilter
      :     :                    :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
      :     :                    +- BroadcastExchange
      :     :                       +- CometColumnarToRow
      :     :                          +- CometProject
      :     :                             +- CometBroadcastHashJoin
      :     :                                :- CometFilter
      :     :                                :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :     :                                +- CometBroadcastExchange
      :     :                                   +- CometProject
      :     :                                      +- CometFilter
      :     :                                         :  +- ReusedSubquery
      :     :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :     :                                               +- Subquery
      :     :                                                  +- CometColumnarToRow
      :     :                                                     +- CometProject
      :     :                                                        +- CometFilter
      :     :                                                           +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :     +- BroadcastExchange
      :        +- Filter
      :           +- HashAggregate
      :              +- CometColumnarToRow
      :                 +- CometColumnarExchange
      :                    +- HashAggregate
      :                       +- Project
      :                          +- BroadcastHashJoin
      :                             :- Project
      :                             :  +- BroadcastHashJoin
      :                             :     :- Filter
      :                             :     :  +- ColumnarToRow
      :                             :     :     +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
      :                             :     :           +- ReusedSubquery
      :                             :     +- BroadcastExchange
      :                             :        +- CometColumnarToRow
      :                             :           +- CometProject
      :                             :              +- CometFilter
      :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
      :                             +- BroadcastExchange
      :                                +- CometColumnarToRow
      :                                   +- CometProject
      :                                      +- CometBroadcastHashJoin
      :                                         :- CometFilter
      :                                         :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :                                         +- CometBroadcastExchange
      :                                            +- CometProject
      :                                               +- CometFilter
      :                                                  :  +- ReusedSubquery
      :                                                  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :                                                        +- Subquery
      :                                                           +- CometColumnarToRow
      :                                                              +- CometProject
      :                                                                 +- CometFilter
      :                                                                    +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      +- BroadcastExchange
         +- Filter
            +- HashAggregate
               +- CometColumnarToRow
                  +- CometColumnarExchange
                     +- HashAggregate
                        +- Project
                           +- BroadcastHashJoin
                              :- Project
                              :  +- BroadcastHashJoin
                              :     :- Filter
                              :     :  +- ColumnarToRow
                              :     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                              :     :           +- ReusedSubquery
                              :     +- BroadcastExchange
                              :        +- CometColumnarToRow
                              :           +- CometProject
                              :              +- CometFilter
                              :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                              +- BroadcastExchange
                                 +- CometColumnarToRow
                                    +- CometProject
                                       +- CometBroadcastHashJoin
                                          :- CometFilter
                                          :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          +- CometBroadcastExchange
                                             +- CometProject
                                                +- CometFilter
                                                   :  +- ReusedSubquery
                                                   +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                                         +- Subquery
                                                            +- CometColumnarToRow
                                                               +- CometProject
                                                                  +- CometFilter
                                                                     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim

Comet accelerated 56 out of 108 eligible operators (51%). Final plan contains 17 transitions between Spark and Comet.