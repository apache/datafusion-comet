TakeOrderedAndProject
+- Project
   +- Filter
      +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
         +- CometColumnarToRow
            +- CometSort
               +- CometExchange
                  +- CometHashAggregate
                     +- CometExchange
                        +- CometHashAggregate
                           +- CometProject
                              +- CometBroadcastHashJoin
                                 :- CometProject
                                 :  +- CometBroadcastHashJoin
                                 :     :- CometProject
                                 :     :  +- CometBroadcastHashJoin
                                 :     :     :- CometProject
                                 :     :     :  +- CometFilter
                                 :     :     :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                 :     :     +- CometBroadcastExchange
                                 :     :        +- CometFilter
                                 :     :           +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                                 :     :                 +- SubqueryBroadcast
                                 :     :                    +- BroadcastExchange
                                 :     :                       +- CometColumnarToRow
                                 :     :                          +- CometProject
                                 :     :                             +- CometFilter
                                 :     :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                 :     +- CometBroadcastExchange
                                 :        +- CometProject
                                 :           +- CometFilter
                                 :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                 +- CometBroadcastExchange
                                    +- CometFilter
                                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store

Comet accelerated 27 out of 33 eligible operators (81%). Final plan contains 2 transitions between Spark and Comet.