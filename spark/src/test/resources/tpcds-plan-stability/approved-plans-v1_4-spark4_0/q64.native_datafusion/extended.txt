CometColumnarToRow
+- CometSort
   +- CometExchange
      +- CometProject
         +- CometSortMergeJoin
            :- CometSort
            :  +- CometColumnarExchange
            :     +- HashAggregate
            :        +- HashAggregate
            :           +- Project
            :              +- BroadcastHashJoin
            :                 :- Project
            :                 :  +- BroadcastHashJoin
            :                 :     :- Project
            :                 :     :  +- BroadcastHashJoin
            :                 :     :     :- Project
            :                 :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :- Project
            :                 :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :- Project
            :                 :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- CometSort
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- CometExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometBroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              :- CometBroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              :  +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              :     +- CometNativeScan parquet spark_catalog.default.store_sales
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- CometNativeScan parquet spark_catalog.default.store_returns
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Sort
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Project
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Filter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(cs_item_sk#1, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#2))#3,17,2) AS sale#4, sum(((cr_refunded_cash#5 + cr_reversed_charge#6) + cr_store_credit#7))#8 AS refund#9)]
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- CometExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- CometHashAggregate
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- CometSortMergeJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :- CometSort
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :  +- CometExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :     +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :        +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :           +- CometNativeScan parquet spark_catalog.default.catalog_sales
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- CometSort
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- CometExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                      +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                         +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                            +- CometNativeScan parquet spark_catalog.default.catalog_returns
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.date_dim
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometNativeScan parquet spark_catalog.default.store
            :                 :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.customer
            :                 :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.date_dim
            :                 :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.date_dim
            :                 :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :           +- CometProject
            :                 :     :     :     :     :     :     :     :     :              +- CometFilter
            :                 :     :     :     :     :     :     :     :     :                 +- CometNativeScan parquet spark_catalog.default.customer_demographics
            :                 :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :           +- CometProject
            :                 :     :     :     :     :     :     :     :              +- CometFilter
            :                 :     :     :     :     :     :     :     :                 +- CometNativeScan parquet spark_catalog.default.customer_demographics
            :                 :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.promotion
            :                 :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.household_demographics
            :                 :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.household_demographics
            :                 :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :           +- CometProject
            :                 :     :     :     :              +- CometFilter
            :                 :     :     :     :                 +- CometNativeScan parquet spark_catalog.default.customer_address
            :                 :     :     :     +- BroadcastExchange
            :                 :     :     :        +- CometColumnarToRow
            :                 :     :     :           +- CometProject
            :                 :     :     :              +- CometFilter
            :                 :     :     :                 +- CometNativeScan parquet spark_catalog.default.customer_address
            :                 :     :     +- BroadcastExchange
            :                 :     :        +- CometColumnarToRow
            :                 :     :           +- CometFilter
            :                 :     :              +- CometNativeScan parquet spark_catalog.default.income_band
            :                 :     +- BroadcastExchange
            :                 :        +- CometColumnarToRow
            :                 :           +- CometFilter
            :                 :              +- CometNativeScan parquet spark_catalog.default.income_band
            :                 +- BroadcastExchange
            :                    +- CometColumnarToRow
            :                       +- CometProject
            :                          +- CometFilter
            :                             +- CometNativeScan parquet spark_catalog.default.item
            +- CometSort
               +- CometColumnarExchange
                  +- HashAggregate
                     +- HashAggregate
                        +- Project
                           +- BroadcastHashJoin
                              :- Project
                              :  +- BroadcastHashJoin
                              :     :- Project
                              :     :  +- BroadcastHashJoin
                              :     :     :- Project
                              :     :     :  +- BroadcastHashJoin
                              :     :     :     :- Project
                              :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :- Project
                              :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :- Project
                              :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- CometSort
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- CometExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometBroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              :- CometBroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              :  +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              :     +- CometNativeScan parquet spark_catalog.default.store_sales
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- CometNativeScan parquet spark_catalog.default.store_returns
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- Sort
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- Project
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- Filter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(cs_item_sk#10, MakeDecimal(sum(UnscaledValue(cs_ext_list_price#11))#3,17,2) AS sale#12, sum(((cr_refunded_cash#13 + cr_reversed_charge#14) + cr_store_credit#15))#8 AS refund#16)]
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- CometExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- CometHashAggregate
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- CometSortMergeJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :- CometSort
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :  +- CometExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :     +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :        +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :           +- CometNativeScan parquet spark_catalog.default.catalog_sales
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- CometSort
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- CometExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                      +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                         +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                            +- CometNativeScan parquet spark_catalog.default.catalog_returns
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.date_dim
                              :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometNativeScan parquet spark_catalog.default.store
                              :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.customer
                              :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.date_dim
                              :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.date_dim
                              :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :           +- CometProject
                              :     :     :     :     :     :     :     :     :              +- CometFilter
                              :     :     :     :     :     :     :     :     :                 +- CometNativeScan parquet spark_catalog.default.customer_demographics
                              :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :           +- CometProject
                              :     :     :     :     :     :     :     :              +- CometFilter
                              :     :     :     :     :     :     :     :                 +- CometNativeScan parquet spark_catalog.default.customer_demographics
                              :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.promotion
                              :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.household_demographics
                              :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :           +- CometFilter
                              :     :     :     :     :              +- CometNativeScan parquet spark_catalog.default.household_demographics
                              :     :     :     :     +- BroadcastExchange
                              :     :     :     :        +- CometColumnarToRow
                              :     :     :     :           +- CometProject
                              :     :     :     :              +- CometFilter
                              :     :     :     :                 +- CometNativeScan parquet spark_catalog.default.customer_address
                              :     :     :     +- BroadcastExchange
                              :     :     :        +- CometColumnarToRow
                              :     :     :           +- CometProject
                              :     :     :              +- CometFilter
                              :     :     :                 +- CometNativeScan parquet spark_catalog.default.customer_address
                              :     :     +- BroadcastExchange
                              :     :        +- CometColumnarToRow
                              :     :           +- CometFilter
                              :     :              +- CometNativeScan parquet spark_catalog.default.income_band
                              :     +- BroadcastExchange
                              :        +- CometColumnarToRow
                              :           +- CometFilter
                              :              +- CometNativeScan parquet spark_catalog.default.income_band
                              +- BroadcastExchange
                                 +- CometColumnarToRow
                                    +- CometProject
                                       +- CometFilter
                                          +- CometNativeScan parquet spark_catalog.default.item

Comet accelerated 128 out of 234 eligible operators (54%). Final plan contains 35 transitions between Spark and Comet.