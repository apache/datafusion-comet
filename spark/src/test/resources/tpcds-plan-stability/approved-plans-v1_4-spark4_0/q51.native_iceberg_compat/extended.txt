TakeOrderedAndProject
+- Filter
   +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
      +- CometColumnarToRow
         +- CometSort
            +- CometExchange
               +- CometProject
                  +- CometSortMergeJoin
                     :- CometSort
                     :  +- CometColumnarExchange
                     :     +- Project
                     :        +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                     :           +- CometColumnarToRow
                     :              +- CometSort
                     :                 +- CometColumnarExchange
                     :                    +- HashAggregate
                     :                       +- CometColumnarToRow
                     :                          +- CometColumnarExchange
                     :                             +- HashAggregate
                     :                                +- Project
                     :                                   +- BroadcastHashJoin
                     :                                      :- Filter
                     :                                      :  +- ColumnarToRow
                     :                                      :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                     :                                      :           +- SubqueryBroadcast
                     :                                      :              +- CometColumnarToRow
                     :                                      :                 +- CometBroadcastExchange
                     :                                      :                    +- CometProject
                     :                                      :                       +- CometFilter
                     :                                      :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                     :                                      +- BroadcastExchange
                     :                                         +- CometColumnarToRow
                     :                                            +- CometProject
                     :                                               +- CometFilter
                     :                                                  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                     +- CometSort
                        +- CometColumnarExchange
                           +- Project
                              +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                                 +- CometColumnarToRow
                                    +- CometSort
                                       +- CometColumnarExchange
                                          +- HashAggregate
                                             +- CometColumnarToRow
                                                +- CometColumnarExchange
                                                   +- HashAggregate
                                                      +- Project
                                                         +- BroadcastHashJoin
                                                            :- Filter
                                                            :  +- ColumnarToRow
                                                            :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                                            :           +- ReusedSubquery
                                                            +- BroadcastExchange
                                                               +- CometColumnarToRow
                                                                  +- CometProject
                                                                     +- CometFilter
                                                                        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim

Comet accelerated 24 out of 47 eligible operators (51%). Final plan contains 10 transitions between Spark and Comet.