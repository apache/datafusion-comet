== Physical Plan ==
* CometColumnarToRow (115)
+- CometTakeOrderedAndProject (114)
   +- CometProject (113)
      +- CometBroadcastHashJoin (112)
         :- CometProject (94)
         :  +- CometBroadcastHashJoin (93)
         :     :- CometProject (74)
         :     :  +- CometBroadcastHashJoin (73)
         :     :     :- CometProject (55)
         :     :     :  +- CometBroadcastHashJoin (54)
         :     :     :     :- CometBroadcastHashJoin (35)
         :     :     :     :  :- CometFilter (17)
         :     :     :     :  :  +- CometHashAggregate (16)
         :     :     :     :  :     +- CometColumnarExchange (15)
         :     :     :     :  :        +- * HashAggregate (14)
         :     :     :     :  :           +- * Project (13)
         :     :     :     :  :              +- * BroadcastHashJoin Inner BuildRight (12)
         :     :     :     :  :                 :- * Project (10)
         :     :     :     :  :                 :  +- * BroadcastHashJoin Inner BuildRight (9)
         :     :     :     :  :                 :     :- * CometColumnarToRow (4)
         :     :     :     :  :                 :     :  +- CometProject (3)
         :     :     :     :  :                 :     :     +- CometFilter (2)
         :     :     :     :  :                 :     :        +- CometNativeScan parquet spark_catalog.default.customer (1)
         :     :     :     :  :                 :     +- BroadcastExchange (8)
         :     :     :     :  :                 :        +- * Filter (7)
         :     :     :     :  :                 :           +- * ColumnarToRow (6)
         :     :     :     :  :                 :              +- Scan parquet spark_catalog.default.store_sales (5)
         :     :     :     :  :                 +- ReusedExchange (11)
         :     :     :     :  +- CometBroadcastExchange (34)
         :     :     :     :     +- CometHashAggregate (33)
         :     :     :     :        +- CometColumnarExchange (32)
         :     :     :     :           +- * HashAggregate (31)
         :     :     :     :              +- * Project (30)
         :     :     :     :                 +- * BroadcastHashJoin Inner BuildRight (29)
         :     :     :     :                    :- * Project (27)
         :     :     :     :                    :  +- * BroadcastHashJoin Inner BuildRight (26)
         :     :     :     :                    :     :- * CometColumnarToRow (21)
         :     :     :     :                    :     :  +- CometProject (20)
         :     :     :     :                    :     :     +- CometFilter (19)
         :     :     :     :                    :     :        +- CometNativeScan parquet spark_catalog.default.customer (18)
         :     :     :     :                    :     +- BroadcastExchange (25)
         :     :     :     :                    :        +- * Filter (24)
         :     :     :     :                    :           +- * ColumnarToRow (23)
         :     :     :     :                    :              +- Scan parquet spark_catalog.default.store_sales (22)
         :     :     :     :                    +- ReusedExchange (28)
         :     :     :     +- CometBroadcastExchange (53)
         :     :     :        +- CometFilter (52)
         :     :     :           +- CometHashAggregate (51)
         :     :     :              +- CometColumnarExchange (50)
         :     :     :                 +- * HashAggregate (49)
         :     :     :                    +- * Project (48)
         :     :     :                       +- * BroadcastHashJoin Inner BuildRight (47)
         :     :     :                          :- * Project (45)
         :     :     :                          :  +- * BroadcastHashJoin Inner BuildRight (44)
         :     :     :                          :     :- * CometColumnarToRow (39)
         :     :     :                          :     :  +- CometProject (38)
         :     :     :                          :     :     +- CometFilter (37)
         :     :     :                          :     :        +- CometNativeScan parquet spark_catalog.default.customer (36)
         :     :     :                          :     +- BroadcastExchange (43)
         :     :     :                          :        +- * Filter (42)
         :     :     :                          :           +- * ColumnarToRow (41)
         :     :     :                          :              +- Scan parquet spark_catalog.default.catalog_sales (40)
         :     :     :                          +- ReusedExchange (46)
         :     :     +- CometBroadcastExchange (72)
         :     :        +- CometHashAggregate (71)
         :     :           +- CometColumnarExchange (70)
         :     :              +- * HashAggregate (69)
         :     :                 +- * Project (68)
         :     :                    +- * BroadcastHashJoin Inner BuildRight (67)
         :     :                       :- * Project (65)
         :     :                       :  +- * BroadcastHashJoin Inner BuildRight (64)
         :     :                       :     :- * CometColumnarToRow (59)
         :     :                       :     :  +- CometProject (58)
         :     :                       :     :     +- CometFilter (57)
         :     :                       :     :        +- CometNativeScan parquet spark_catalog.default.customer (56)
         :     :                       :     +- BroadcastExchange (63)
         :     :                       :        +- * Filter (62)
         :     :                       :           +- * ColumnarToRow (61)
         :     :                       :              +- Scan parquet spark_catalog.default.catalog_sales (60)
         :     :                       +- ReusedExchange (66)
         :     +- CometBroadcastExchange (92)
         :        +- CometFilter (91)
         :           +- CometHashAggregate (90)
         :              +- CometColumnarExchange (89)
         :                 +- * HashAggregate (88)
         :                    +- * Project (87)
         :                       +- * BroadcastHashJoin Inner BuildRight (86)
         :                          :- * Project (84)
         :                          :  +- * BroadcastHashJoin Inner BuildRight (83)
         :                          :     :- * CometColumnarToRow (78)
         :                          :     :  +- CometProject (77)
         :                          :     :     +- CometFilter (76)
         :                          :     :        +- CometNativeScan parquet spark_catalog.default.customer (75)
         :                          :     +- BroadcastExchange (82)
         :                          :        +- * Filter (81)
         :                          :           +- * ColumnarToRow (80)
         :                          :              +- Scan parquet spark_catalog.default.web_sales (79)
         :                          +- ReusedExchange (85)
         +- CometBroadcastExchange (111)
            +- CometHashAggregate (110)
               +- CometColumnarExchange (109)
                  +- * HashAggregate (108)
                     +- * Project (107)
                        +- * BroadcastHashJoin Inner BuildRight (106)
                           :- * Project (104)
                           :  +- * BroadcastHashJoin Inner BuildRight (103)
                           :     :- * CometColumnarToRow (98)
                           :     :  +- CometProject (97)
                           :     :     +- CometFilter (96)
                           :     :        +- CometNativeScan parquet spark_catalog.default.customer (95)
                           :     +- BroadcastExchange (102)
                           :        +- * Filter (101)
                           :           +- * ColumnarToRow (100)
                           :              +- Scan parquet spark_catalog.default.web_sales (99)
                           +- ReusedExchange (105)


(1) CometNativeScan parquet spark_catalog.default.customer
Output [8]: [c_customer_sk#1, c_customer_id#2, c_first_name#3, c_last_name#4, c_preferred_cust_flag#5, c_birth_country#6, c_login#7, c_email_address#8]
Batched: true
Location [not included in comparison]/{warehouse_dir}/customer]
PushedFilters: [IsNotNull(c_customer_sk)]
ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_country:string,c_login:string,c_email_address:string>

(2) CometFilter
Input [8]: [c_customer_sk#1, c_customer_id#2, c_first_name#3, c_last_name#4, c_preferred_cust_flag#5, c_birth_country#6, c_login#7, c_email_address#8]
Condition : (isnotnull(c_customer_sk#1) AND isnotnull(static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#2, 16))))

(3) CometProject
Input [8]: [c_customer_sk#1, c_customer_id#2, c_first_name#3, c_last_name#4, c_preferred_cust_flag#5, c_birth_country#6, c_login#7, c_email_address#8]
Arguments: [c_customer_sk#1, c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14], [c_customer_sk#1, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#2, 16)) AS c_customer_id#9, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_first_name#3, 20)) AS c_first_name#10, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_last_name#4, 30)) AS c_last_name#11, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_preferred_cust_flag#5, 1)) AS c_preferred_cust_flag#12, c_birth_country#6, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_login#7, 13)) AS c_login#13, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_email_address#8, 50)) AS c_email_address#14]

(4) CometColumnarToRow [codegen id : 3]
Input [8]: [c_customer_sk#1, c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14]

(5) Scan parquet spark_catalog.default.store_sales
Output [6]: [ss_customer_sk#15, ss_ext_discount_amt#16, ss_ext_sales_price#17, ss_ext_wholesale_cost#18, ss_ext_list_price#19, ss_sold_date_sk#20]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(ss_sold_date_sk#20), dynamicpruningexpression(ss_sold_date_sk#20 IN dynamicpruning#21)]
PushedFilters: [IsNotNull(ss_customer_sk)]
ReadSchema: struct<ss_customer_sk:int,ss_ext_discount_amt:decimal(7,2),ss_ext_sales_price:decimal(7,2),ss_ext_wholesale_cost:decimal(7,2),ss_ext_list_price:decimal(7,2)>

(6) ColumnarToRow [codegen id : 1]
Input [6]: [ss_customer_sk#15, ss_ext_discount_amt#16, ss_ext_sales_price#17, ss_ext_wholesale_cost#18, ss_ext_list_price#19, ss_sold_date_sk#20]

(7) Filter [codegen id : 1]
Input [6]: [ss_customer_sk#15, ss_ext_discount_amt#16, ss_ext_sales_price#17, ss_ext_wholesale_cost#18, ss_ext_list_price#19, ss_sold_date_sk#20]
Condition : isnotnull(ss_customer_sk#15)

(8) BroadcastExchange
Input [6]: [ss_customer_sk#15, ss_ext_discount_amt#16, ss_ext_sales_price#17, ss_ext_wholesale_cost#18, ss_ext_list_price#19, ss_sold_date_sk#20]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1]

(9) BroadcastHashJoin [codegen id : 3]
Left keys [1]: [c_customer_sk#1]
Right keys [1]: [ss_customer_sk#15]
Join type: Inner
Join condition: None

(10) Project [codegen id : 3]
Output [12]: [c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, ss_ext_discount_amt#16, ss_ext_sales_price#17, ss_ext_wholesale_cost#18, ss_ext_list_price#19, ss_sold_date_sk#20]
Input [14]: [c_customer_sk#1, c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, ss_customer_sk#15, ss_ext_discount_amt#16, ss_ext_sales_price#17, ss_ext_wholesale_cost#18, ss_ext_list_price#19, ss_sold_date_sk#20]

(11) ReusedExchange [Reuses operator id: 119]
Output [2]: [d_date_sk#22, d_year#23]

(12) BroadcastHashJoin [codegen id : 3]
Left keys [1]: [ss_sold_date_sk#20]
Right keys [1]: [d_date_sk#22]
Join type: Inner
Join condition: None

(13) Project [codegen id : 3]
Output [12]: [c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, ss_ext_discount_amt#16, ss_ext_sales_price#17, ss_ext_wholesale_cost#18, ss_ext_list_price#19, d_year#23]
Input [14]: [c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, ss_ext_discount_amt#16, ss_ext_sales_price#17, ss_ext_wholesale_cost#18, ss_ext_list_price#19, ss_sold_date_sk#20, d_date_sk#22, d_year#23]

(14) HashAggregate [codegen id : 3]
Input [12]: [c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, ss_ext_discount_amt#16, ss_ext_sales_price#17, ss_ext_wholesale_cost#18, ss_ext_list_price#19, d_year#23]
Keys [8]: [c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, d_year#23]
Functions [1]: [partial_sum(((((ss_ext_list_price#19 - ss_ext_wholesale_cost#18) - ss_ext_discount_amt#16) + ss_ext_sales_price#17) / 2))]
Aggregate Attributes [2]: [sum#24, isEmpty#25]
Results [10]: [c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, d_year#23, sum#26, isEmpty#27]

(15) CometColumnarExchange
Input [10]: [c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, d_year#23, sum#26, isEmpty#27]
Arguments: hashpartitioning(c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, d_year#23, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=2]

(16) CometHashAggregate
Input [10]: [c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, d_year#23, sum#26, isEmpty#27]
Keys [8]: [c_customer_id#9, c_first_name#10, c_last_name#11, c_preferred_cust_flag#12, c_birth_country#6, c_login#13, c_email_address#14, d_year#23]
Functions [1]: [sum(((((ss_ext_list_price#19 - ss_ext_wholesale_cost#18) - ss_ext_discount_amt#16) + ss_ext_sales_price#17) / 2))]

(17) CometFilter
Input [2]: [customer_id#28, year_total#29]
Condition : (isnotnull(year_total#29) AND (year_total#29 > 0.000000))

(18) CometNativeScan parquet spark_catalog.default.customer
Output [8]: [c_customer_sk#30, c_customer_id#31, c_first_name#32, c_last_name#33, c_preferred_cust_flag#34, c_birth_country#35, c_login#36, c_email_address#37]
Batched: true
Location [not included in comparison]/{warehouse_dir}/customer]
PushedFilters: [IsNotNull(c_customer_sk)]
ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_country:string,c_login:string,c_email_address:string>

(19) CometFilter
Input [8]: [c_customer_sk#30, c_customer_id#31, c_first_name#32, c_last_name#33, c_preferred_cust_flag#34, c_birth_country#35, c_login#36, c_email_address#37]
Condition : (isnotnull(c_customer_sk#30) AND isnotnull(static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#31, 16))))

(20) CometProject
Input [8]: [c_customer_sk#30, c_customer_id#31, c_first_name#32, c_last_name#33, c_preferred_cust_flag#34, c_birth_country#35, c_login#36, c_email_address#37]
Arguments: [c_customer_sk#30, c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43], [c_customer_sk#30, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#31, 16)) AS c_customer_id#38, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_first_name#32, 20)) AS c_first_name#39, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_last_name#33, 30)) AS c_last_name#40, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_preferred_cust_flag#34, 1)) AS c_preferred_cust_flag#41, c_birth_country#35, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_login#36, 13)) AS c_login#42, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_email_address#37, 50)) AS c_email_address#43]

(21) CometColumnarToRow [codegen id : 6]
Input [8]: [c_customer_sk#30, c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43]

(22) Scan parquet spark_catalog.default.store_sales
Output [6]: [ss_customer_sk#44, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, ss_sold_date_sk#49]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(ss_sold_date_sk#49), dynamicpruningexpression(ss_sold_date_sk#49 IN dynamicpruning#50)]
PushedFilters: [IsNotNull(ss_customer_sk)]
ReadSchema: struct<ss_customer_sk:int,ss_ext_discount_amt:decimal(7,2),ss_ext_sales_price:decimal(7,2),ss_ext_wholesale_cost:decimal(7,2),ss_ext_list_price:decimal(7,2)>

(23) ColumnarToRow [codegen id : 4]
Input [6]: [ss_customer_sk#44, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, ss_sold_date_sk#49]

(24) Filter [codegen id : 4]
Input [6]: [ss_customer_sk#44, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, ss_sold_date_sk#49]
Condition : isnotnull(ss_customer_sk#44)

(25) BroadcastExchange
Input [6]: [ss_customer_sk#44, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, ss_sold_date_sk#49]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3]

(26) BroadcastHashJoin [codegen id : 6]
Left keys [1]: [c_customer_sk#30]
Right keys [1]: [ss_customer_sk#44]
Join type: Inner
Join condition: None

(27) Project [codegen id : 6]
Output [12]: [c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, ss_sold_date_sk#49]
Input [14]: [c_customer_sk#30, c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, ss_customer_sk#44, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, ss_sold_date_sk#49]

(28) ReusedExchange [Reuses operator id: 123]
Output [2]: [d_date_sk#51, d_year#52]

(29) BroadcastHashJoin [codegen id : 6]
Left keys [1]: [ss_sold_date_sk#49]
Right keys [1]: [d_date_sk#51]
Join type: Inner
Join condition: None

(30) Project [codegen id : 6]
Output [12]: [c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, d_year#52]
Input [14]: [c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, ss_sold_date_sk#49, d_date_sk#51, d_year#52]

(31) HashAggregate [codegen id : 6]
Input [12]: [c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, ss_ext_discount_amt#45, ss_ext_sales_price#46, ss_ext_wholesale_cost#47, ss_ext_list_price#48, d_year#52]
Keys [8]: [c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, d_year#52]
Functions [1]: [partial_sum(((((ss_ext_list_price#48 - ss_ext_wholesale_cost#47) - ss_ext_discount_amt#45) + ss_ext_sales_price#46) / 2))]
Aggregate Attributes [2]: [sum#53, isEmpty#54]
Results [10]: [c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, d_year#52, sum#55, isEmpty#56]

(32) CometColumnarExchange
Input [10]: [c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, d_year#52, sum#55, isEmpty#56]
Arguments: hashpartitioning(c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, d_year#52, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=4]

(33) CometHashAggregate
Input [10]: [c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, d_year#52, sum#55, isEmpty#56]
Keys [8]: [c_customer_id#38, c_first_name#39, c_last_name#40, c_preferred_cust_flag#41, c_birth_country#35, c_login#42, c_email_address#43, d_year#52]
Functions [1]: [sum(((((ss_ext_list_price#48 - ss_ext_wholesale_cost#47) - ss_ext_discount_amt#45) + ss_ext_sales_price#46) / 2))]

(34) CometBroadcastExchange
Input [8]: [customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#64]
Arguments: [customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#64]

(35) CometBroadcastHashJoin
Left output [2]: [customer_id#28, year_total#29]
Right output [8]: [customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#64]
Arguments: [customer_id#28], [customer_id#57], Inner, BuildRight

(36) CometNativeScan parquet spark_catalog.default.customer
Output [8]: [c_customer_sk#65, c_customer_id#66, c_first_name#67, c_last_name#68, c_preferred_cust_flag#69, c_birth_country#70, c_login#71, c_email_address#72]
Batched: true
Location [not included in comparison]/{warehouse_dir}/customer]
PushedFilters: [IsNotNull(c_customer_sk)]
ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_country:string,c_login:string,c_email_address:string>

(37) CometFilter
Input [8]: [c_customer_sk#65, c_customer_id#66, c_first_name#67, c_last_name#68, c_preferred_cust_flag#69, c_birth_country#70, c_login#71, c_email_address#72]
Condition : (isnotnull(c_customer_sk#65) AND isnotnull(static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#66, 16))))

(38) CometProject
Input [8]: [c_customer_sk#65, c_customer_id#66, c_first_name#67, c_last_name#68, c_preferred_cust_flag#69, c_birth_country#70, c_login#71, c_email_address#72]
Arguments: [c_customer_sk#65, c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78], [c_customer_sk#65, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#66, 16)) AS c_customer_id#73, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_first_name#67, 20)) AS c_first_name#74, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_last_name#68, 30)) AS c_last_name#75, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_preferred_cust_flag#69, 1)) AS c_preferred_cust_flag#76, c_birth_country#70, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_login#71, 13)) AS c_login#77, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_email_address#72, 50)) AS c_email_address#78]

(39) CometColumnarToRow [codegen id : 9]
Input [8]: [c_customer_sk#65, c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78]

(40) Scan parquet spark_catalog.default.catalog_sales
Output [6]: [cs_bill_customer_sk#79, cs_ext_discount_amt#80, cs_ext_sales_price#81, cs_ext_wholesale_cost#82, cs_ext_list_price#83, cs_sold_date_sk#84]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(cs_sold_date_sk#84), dynamicpruningexpression(cs_sold_date_sk#84 IN dynamicpruning#21)]
PushedFilters: [IsNotNull(cs_bill_customer_sk)]
ReadSchema: struct<cs_bill_customer_sk:int,cs_ext_discount_amt:decimal(7,2),cs_ext_sales_price:decimal(7,2),cs_ext_wholesale_cost:decimal(7,2),cs_ext_list_price:decimal(7,2)>

(41) ColumnarToRow [codegen id : 7]
Input [6]: [cs_bill_customer_sk#79, cs_ext_discount_amt#80, cs_ext_sales_price#81, cs_ext_wholesale_cost#82, cs_ext_list_price#83, cs_sold_date_sk#84]

(42) Filter [codegen id : 7]
Input [6]: [cs_bill_customer_sk#79, cs_ext_discount_amt#80, cs_ext_sales_price#81, cs_ext_wholesale_cost#82, cs_ext_list_price#83, cs_sold_date_sk#84]
Condition : isnotnull(cs_bill_customer_sk#79)

(43) BroadcastExchange
Input [6]: [cs_bill_customer_sk#79, cs_ext_discount_amt#80, cs_ext_sales_price#81, cs_ext_wholesale_cost#82, cs_ext_list_price#83, cs_sold_date_sk#84]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5]

(44) BroadcastHashJoin [codegen id : 9]
Left keys [1]: [c_customer_sk#65]
Right keys [1]: [cs_bill_customer_sk#79]
Join type: Inner
Join condition: None

(45) Project [codegen id : 9]
Output [12]: [c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, cs_ext_discount_amt#80, cs_ext_sales_price#81, cs_ext_wholesale_cost#82, cs_ext_list_price#83, cs_sold_date_sk#84]
Input [14]: [c_customer_sk#65, c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, cs_bill_customer_sk#79, cs_ext_discount_amt#80, cs_ext_sales_price#81, cs_ext_wholesale_cost#82, cs_ext_list_price#83, cs_sold_date_sk#84]

(46) ReusedExchange [Reuses operator id: 119]
Output [2]: [d_date_sk#85, d_year#86]

(47) BroadcastHashJoin [codegen id : 9]
Left keys [1]: [cs_sold_date_sk#84]
Right keys [1]: [d_date_sk#85]
Join type: Inner
Join condition: None

(48) Project [codegen id : 9]
Output [12]: [c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, cs_ext_discount_amt#80, cs_ext_sales_price#81, cs_ext_wholesale_cost#82, cs_ext_list_price#83, d_year#86]
Input [14]: [c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, cs_ext_discount_amt#80, cs_ext_sales_price#81, cs_ext_wholesale_cost#82, cs_ext_list_price#83, cs_sold_date_sk#84, d_date_sk#85, d_year#86]

(49) HashAggregate [codegen id : 9]
Input [12]: [c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, cs_ext_discount_amt#80, cs_ext_sales_price#81, cs_ext_wholesale_cost#82, cs_ext_list_price#83, d_year#86]
Keys [8]: [c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, d_year#86]
Functions [1]: [partial_sum(((((cs_ext_list_price#83 - cs_ext_wholesale_cost#82) - cs_ext_discount_amt#80) + cs_ext_sales_price#81) / 2))]
Aggregate Attributes [2]: [sum#87, isEmpty#88]
Results [10]: [c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, d_year#86, sum#89, isEmpty#90]

(50) CometColumnarExchange
Input [10]: [c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, d_year#86, sum#89, isEmpty#90]
Arguments: hashpartitioning(c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, d_year#86, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=6]

(51) CometHashAggregate
Input [10]: [c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, d_year#86, sum#89, isEmpty#90]
Keys [8]: [c_customer_id#73, c_first_name#74, c_last_name#75, c_preferred_cust_flag#76, c_birth_country#70, c_login#77, c_email_address#78, d_year#86]
Functions [1]: [sum(((((cs_ext_list_price#83 - cs_ext_wholesale_cost#82) - cs_ext_discount_amt#80) + cs_ext_sales_price#81) / 2))]

(52) CometFilter
Input [2]: [customer_id#91, year_total#92]
Condition : (isnotnull(year_total#92) AND (year_total#92 > 0.000000))

(53) CometBroadcastExchange
Input [2]: [customer_id#91, year_total#92]
Arguments: [customer_id#91, year_total#92]

(54) CometBroadcastHashJoin
Left output [10]: [customer_id#28, year_total#29, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#64]
Right output [2]: [customer_id#91, year_total#92]
Arguments: [customer_id#28], [customer_id#91], Inner, BuildRight

(55) CometProject
Input [12]: [customer_id#28, year_total#29, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#64, customer_id#91, year_total#92]
Arguments: [customer_id#28, year_total#29, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#64, year_total#92], [customer_id#28, year_total#29, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#64, year_total#92]

(56) CometNativeScan parquet spark_catalog.default.customer
Output [8]: [c_customer_sk#93, c_customer_id#94, c_first_name#95, c_last_name#96, c_preferred_cust_flag#97, c_birth_country#98, c_login#99, c_email_address#100]
Batched: true
Location [not included in comparison]/{warehouse_dir}/customer]
PushedFilters: [IsNotNull(c_customer_sk)]
ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_country:string,c_login:string,c_email_address:string>

(57) CometFilter
Input [8]: [c_customer_sk#93, c_customer_id#94, c_first_name#95, c_last_name#96, c_preferred_cust_flag#97, c_birth_country#98, c_login#99, c_email_address#100]
Condition : (isnotnull(c_customer_sk#93) AND isnotnull(static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#94, 16))))

(58) CometProject
Input [8]: [c_customer_sk#93, c_customer_id#94, c_first_name#95, c_last_name#96, c_preferred_cust_flag#97, c_birth_country#98, c_login#99, c_email_address#100]
Arguments: [c_customer_sk#93, c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106], [c_customer_sk#93, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#94, 16)) AS c_customer_id#101, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_first_name#95, 20)) AS c_first_name#102, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_last_name#96, 30)) AS c_last_name#103, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_preferred_cust_flag#97, 1)) AS c_preferred_cust_flag#104, c_birth_country#98, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_login#99, 13)) AS c_login#105, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_email_address#100, 50)) AS c_email_address#106]

(59) CometColumnarToRow [codegen id : 12]
Input [8]: [c_customer_sk#93, c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106]

(60) Scan parquet spark_catalog.default.catalog_sales
Output [6]: [cs_bill_customer_sk#107, cs_ext_discount_amt#108, cs_ext_sales_price#109, cs_ext_wholesale_cost#110, cs_ext_list_price#111, cs_sold_date_sk#112]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(cs_sold_date_sk#112), dynamicpruningexpression(cs_sold_date_sk#112 IN dynamicpruning#50)]
PushedFilters: [IsNotNull(cs_bill_customer_sk)]
ReadSchema: struct<cs_bill_customer_sk:int,cs_ext_discount_amt:decimal(7,2),cs_ext_sales_price:decimal(7,2),cs_ext_wholesale_cost:decimal(7,2),cs_ext_list_price:decimal(7,2)>

(61) ColumnarToRow [codegen id : 10]
Input [6]: [cs_bill_customer_sk#107, cs_ext_discount_amt#108, cs_ext_sales_price#109, cs_ext_wholesale_cost#110, cs_ext_list_price#111, cs_sold_date_sk#112]

(62) Filter [codegen id : 10]
Input [6]: [cs_bill_customer_sk#107, cs_ext_discount_amt#108, cs_ext_sales_price#109, cs_ext_wholesale_cost#110, cs_ext_list_price#111, cs_sold_date_sk#112]
Condition : isnotnull(cs_bill_customer_sk#107)

(63) BroadcastExchange
Input [6]: [cs_bill_customer_sk#107, cs_ext_discount_amt#108, cs_ext_sales_price#109, cs_ext_wholesale_cost#110, cs_ext_list_price#111, cs_sold_date_sk#112]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7]

(64) BroadcastHashJoin [codegen id : 12]
Left keys [1]: [c_customer_sk#93]
Right keys [1]: [cs_bill_customer_sk#107]
Join type: Inner
Join condition: None

(65) Project [codegen id : 12]
Output [12]: [c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, cs_ext_discount_amt#108, cs_ext_sales_price#109, cs_ext_wholesale_cost#110, cs_ext_list_price#111, cs_sold_date_sk#112]
Input [14]: [c_customer_sk#93, c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, cs_bill_customer_sk#107, cs_ext_discount_amt#108, cs_ext_sales_price#109, cs_ext_wholesale_cost#110, cs_ext_list_price#111, cs_sold_date_sk#112]

(66) ReusedExchange [Reuses operator id: 123]
Output [2]: [d_date_sk#113, d_year#114]

(67) BroadcastHashJoin [codegen id : 12]
Left keys [1]: [cs_sold_date_sk#112]
Right keys [1]: [d_date_sk#113]
Join type: Inner
Join condition: None

(68) Project [codegen id : 12]
Output [12]: [c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, cs_ext_discount_amt#108, cs_ext_sales_price#109, cs_ext_wholesale_cost#110, cs_ext_list_price#111, d_year#114]
Input [14]: [c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, cs_ext_discount_amt#108, cs_ext_sales_price#109, cs_ext_wholesale_cost#110, cs_ext_list_price#111, cs_sold_date_sk#112, d_date_sk#113, d_year#114]

(69) HashAggregate [codegen id : 12]
Input [12]: [c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, cs_ext_discount_amt#108, cs_ext_sales_price#109, cs_ext_wholesale_cost#110, cs_ext_list_price#111, d_year#114]
Keys [8]: [c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, d_year#114]
Functions [1]: [partial_sum(((((cs_ext_list_price#111 - cs_ext_wholesale_cost#110) - cs_ext_discount_amt#108) + cs_ext_sales_price#109) / 2))]
Aggregate Attributes [2]: [sum#115, isEmpty#116]
Results [10]: [c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, d_year#114, sum#117, isEmpty#118]

(70) CometColumnarExchange
Input [10]: [c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, d_year#114, sum#117, isEmpty#118]
Arguments: hashpartitioning(c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, d_year#114, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=8]

(71) CometHashAggregate
Input [10]: [c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, d_year#114, sum#117, isEmpty#118]
Keys [8]: [c_customer_id#101, c_first_name#102, c_last_name#103, c_preferred_cust_flag#104, c_birth_country#98, c_login#105, c_email_address#106, d_year#114]
Functions [1]: [sum(((((cs_ext_list_price#111 - cs_ext_wholesale_cost#110) - cs_ext_discount_amt#108) + cs_ext_sales_price#109) / 2))]

(72) CometBroadcastExchange
Input [2]: [customer_id#119, year_total#120]
Arguments: [customer_id#119, year_total#120]

(73) CometBroadcastHashJoin
Left output [11]: [customer_id#28, year_total#29, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#64, year_total#92]
Right output [2]: [customer_id#119, year_total#120]
Arguments: [customer_id#28], [customer_id#119], Inner, (CASE WHEN (year_total#92 > 0.000000) THEN (year_total#120 / year_total#92) END > CASE WHEN (year_total#29 > 0.000000) THEN (year_total#64 / year_total#29) END), BuildRight

(74) CometProject
Input [13]: [customer_id#28, year_total#29, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#64, year_total#92, customer_id#119, year_total#120]
Arguments: [customer_id#28, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#92, year_total#120], [customer_id#28, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#92, year_total#120]

(75) CometNativeScan parquet spark_catalog.default.customer
Output [8]: [c_customer_sk#121, c_customer_id#122, c_first_name#123, c_last_name#124, c_preferred_cust_flag#125, c_birth_country#126, c_login#127, c_email_address#128]
Batched: true
Location [not included in comparison]/{warehouse_dir}/customer]
PushedFilters: [IsNotNull(c_customer_sk)]
ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_country:string,c_login:string,c_email_address:string>

(76) CometFilter
Input [8]: [c_customer_sk#121, c_customer_id#122, c_first_name#123, c_last_name#124, c_preferred_cust_flag#125, c_birth_country#126, c_login#127, c_email_address#128]
Condition : (isnotnull(c_customer_sk#121) AND isnotnull(static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#122, 16))))

(77) CometProject
Input [8]: [c_customer_sk#121, c_customer_id#122, c_first_name#123, c_last_name#124, c_preferred_cust_flag#125, c_birth_country#126, c_login#127, c_email_address#128]
Arguments: [c_customer_sk#121, c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134], [c_customer_sk#121, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#122, 16)) AS c_customer_id#129, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_first_name#123, 20)) AS c_first_name#130, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_last_name#124, 30)) AS c_last_name#131, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_preferred_cust_flag#125, 1)) AS c_preferred_cust_flag#132, c_birth_country#126, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_login#127, 13)) AS c_login#133, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_email_address#128, 50)) AS c_email_address#134]

(78) CometColumnarToRow [codegen id : 15]
Input [8]: [c_customer_sk#121, c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134]

(79) Scan parquet spark_catalog.default.web_sales
Output [6]: [ws_bill_customer_sk#135, ws_ext_discount_amt#136, ws_ext_sales_price#137, ws_ext_wholesale_cost#138, ws_ext_list_price#139, ws_sold_date_sk#140]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(ws_sold_date_sk#140), dynamicpruningexpression(ws_sold_date_sk#140 IN dynamicpruning#21)]
PushedFilters: [IsNotNull(ws_bill_customer_sk)]
ReadSchema: struct<ws_bill_customer_sk:int,ws_ext_discount_amt:decimal(7,2),ws_ext_sales_price:decimal(7,2),ws_ext_wholesale_cost:decimal(7,2),ws_ext_list_price:decimal(7,2)>

(80) ColumnarToRow [codegen id : 13]
Input [6]: [ws_bill_customer_sk#135, ws_ext_discount_amt#136, ws_ext_sales_price#137, ws_ext_wholesale_cost#138, ws_ext_list_price#139, ws_sold_date_sk#140]

(81) Filter [codegen id : 13]
Input [6]: [ws_bill_customer_sk#135, ws_ext_discount_amt#136, ws_ext_sales_price#137, ws_ext_wholesale_cost#138, ws_ext_list_price#139, ws_sold_date_sk#140]
Condition : isnotnull(ws_bill_customer_sk#135)

(82) BroadcastExchange
Input [6]: [ws_bill_customer_sk#135, ws_ext_discount_amt#136, ws_ext_sales_price#137, ws_ext_wholesale_cost#138, ws_ext_list_price#139, ws_sold_date_sk#140]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=9]

(83) BroadcastHashJoin [codegen id : 15]
Left keys [1]: [c_customer_sk#121]
Right keys [1]: [ws_bill_customer_sk#135]
Join type: Inner
Join condition: None

(84) Project [codegen id : 15]
Output [12]: [c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, ws_ext_discount_amt#136, ws_ext_sales_price#137, ws_ext_wholesale_cost#138, ws_ext_list_price#139, ws_sold_date_sk#140]
Input [14]: [c_customer_sk#121, c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, ws_bill_customer_sk#135, ws_ext_discount_amt#136, ws_ext_sales_price#137, ws_ext_wholesale_cost#138, ws_ext_list_price#139, ws_sold_date_sk#140]

(85) ReusedExchange [Reuses operator id: 119]
Output [2]: [d_date_sk#141, d_year#142]

(86) BroadcastHashJoin [codegen id : 15]
Left keys [1]: [ws_sold_date_sk#140]
Right keys [1]: [d_date_sk#141]
Join type: Inner
Join condition: None

(87) Project [codegen id : 15]
Output [12]: [c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, ws_ext_discount_amt#136, ws_ext_sales_price#137, ws_ext_wholesale_cost#138, ws_ext_list_price#139, d_year#142]
Input [14]: [c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, ws_ext_discount_amt#136, ws_ext_sales_price#137, ws_ext_wholesale_cost#138, ws_ext_list_price#139, ws_sold_date_sk#140, d_date_sk#141, d_year#142]

(88) HashAggregate [codegen id : 15]
Input [12]: [c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, ws_ext_discount_amt#136, ws_ext_sales_price#137, ws_ext_wholesale_cost#138, ws_ext_list_price#139, d_year#142]
Keys [8]: [c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, d_year#142]
Functions [1]: [partial_sum(((((ws_ext_list_price#139 - ws_ext_wholesale_cost#138) - ws_ext_discount_amt#136) + ws_ext_sales_price#137) / 2))]
Aggregate Attributes [2]: [sum#143, isEmpty#144]
Results [10]: [c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, d_year#142, sum#145, isEmpty#146]

(89) CometColumnarExchange
Input [10]: [c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, d_year#142, sum#145, isEmpty#146]
Arguments: hashpartitioning(c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, d_year#142, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=10]

(90) CometHashAggregate
Input [10]: [c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, d_year#142, sum#145, isEmpty#146]
Keys [8]: [c_customer_id#129, c_first_name#130, c_last_name#131, c_preferred_cust_flag#132, c_birth_country#126, c_login#133, c_email_address#134, d_year#142]
Functions [1]: [sum(((((ws_ext_list_price#139 - ws_ext_wholesale_cost#138) - ws_ext_discount_amt#136) + ws_ext_sales_price#137) / 2))]

(91) CometFilter
Input [2]: [customer_id#147, year_total#148]
Condition : (isnotnull(year_total#148) AND (year_total#148 > 0.000000))

(92) CometBroadcastExchange
Input [2]: [customer_id#147, year_total#148]
Arguments: [customer_id#147, year_total#148]

(93) CometBroadcastHashJoin
Left output [10]: [customer_id#28, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#92, year_total#120]
Right output [2]: [customer_id#147, year_total#148]
Arguments: [customer_id#28], [customer_id#147], Inner, BuildRight

(94) CometProject
Input [12]: [customer_id#28, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#92, year_total#120, customer_id#147, year_total#148]
Arguments: [customer_id#28, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#92, year_total#120, year_total#148], [customer_id#28, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#92, year_total#120, year_total#148]

(95) CometNativeScan parquet spark_catalog.default.customer
Output [8]: [c_customer_sk#149, c_customer_id#150, c_first_name#151, c_last_name#152, c_preferred_cust_flag#153, c_birth_country#154, c_login#155, c_email_address#156]
Batched: true
Location [not included in comparison]/{warehouse_dir}/customer]
PushedFilters: [IsNotNull(c_customer_sk)]
ReadSchema: struct<c_customer_sk:int,c_customer_id:string,c_first_name:string,c_last_name:string,c_preferred_cust_flag:string,c_birth_country:string,c_login:string,c_email_address:string>

(96) CometFilter
Input [8]: [c_customer_sk#149, c_customer_id#150, c_first_name#151, c_last_name#152, c_preferred_cust_flag#153, c_birth_country#154, c_login#155, c_email_address#156]
Condition : (isnotnull(c_customer_sk#149) AND isnotnull(static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#150, 16))))

(97) CometProject
Input [8]: [c_customer_sk#149, c_customer_id#150, c_first_name#151, c_last_name#152, c_preferred_cust_flag#153, c_birth_country#154, c_login#155, c_email_address#156]
Arguments: [c_customer_sk#149, c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162], [c_customer_sk#149, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_customer_id#150, 16)) AS c_customer_id#157, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_first_name#151, 20)) AS c_first_name#158, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_last_name#152, 30)) AS c_last_name#159, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_preferred_cust_flag#153, 1)) AS c_preferred_cust_flag#160, c_birth_country#154, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_login#155, 13)) AS c_login#161, static_invoke(CharVarcharCodegenUtils.readSidePadding(c_email_address#156, 50)) AS c_email_address#162]

(98) CometColumnarToRow [codegen id : 18]
Input [8]: [c_customer_sk#149, c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162]

(99) Scan parquet spark_catalog.default.web_sales
Output [6]: [ws_bill_customer_sk#163, ws_ext_discount_amt#164, ws_ext_sales_price#165, ws_ext_wholesale_cost#166, ws_ext_list_price#167, ws_sold_date_sk#168]
Batched: true
Location: InMemoryFileIndex []
PartitionFilters: [isnotnull(ws_sold_date_sk#168), dynamicpruningexpression(ws_sold_date_sk#168 IN dynamicpruning#50)]
PushedFilters: [IsNotNull(ws_bill_customer_sk)]
ReadSchema: struct<ws_bill_customer_sk:int,ws_ext_discount_amt:decimal(7,2),ws_ext_sales_price:decimal(7,2),ws_ext_wholesale_cost:decimal(7,2),ws_ext_list_price:decimal(7,2)>

(100) ColumnarToRow [codegen id : 16]
Input [6]: [ws_bill_customer_sk#163, ws_ext_discount_amt#164, ws_ext_sales_price#165, ws_ext_wholesale_cost#166, ws_ext_list_price#167, ws_sold_date_sk#168]

(101) Filter [codegen id : 16]
Input [6]: [ws_bill_customer_sk#163, ws_ext_discount_amt#164, ws_ext_sales_price#165, ws_ext_wholesale_cost#166, ws_ext_list_price#167, ws_sold_date_sk#168]
Condition : isnotnull(ws_bill_customer_sk#163)

(102) BroadcastExchange
Input [6]: [ws_bill_customer_sk#163, ws_ext_discount_amt#164, ws_ext_sales_price#165, ws_ext_wholesale_cost#166, ws_ext_list_price#167, ws_sold_date_sk#168]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=11]

(103) BroadcastHashJoin [codegen id : 18]
Left keys [1]: [c_customer_sk#149]
Right keys [1]: [ws_bill_customer_sk#163]
Join type: Inner
Join condition: None

(104) Project [codegen id : 18]
Output [12]: [c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, ws_ext_discount_amt#164, ws_ext_sales_price#165, ws_ext_wholesale_cost#166, ws_ext_list_price#167, ws_sold_date_sk#168]
Input [14]: [c_customer_sk#149, c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, ws_bill_customer_sk#163, ws_ext_discount_amt#164, ws_ext_sales_price#165, ws_ext_wholesale_cost#166, ws_ext_list_price#167, ws_sold_date_sk#168]

(105) ReusedExchange [Reuses operator id: 123]
Output [2]: [d_date_sk#169, d_year#170]

(106) BroadcastHashJoin [codegen id : 18]
Left keys [1]: [ws_sold_date_sk#168]
Right keys [1]: [d_date_sk#169]
Join type: Inner
Join condition: None

(107) Project [codegen id : 18]
Output [12]: [c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, ws_ext_discount_amt#164, ws_ext_sales_price#165, ws_ext_wholesale_cost#166, ws_ext_list_price#167, d_year#170]
Input [14]: [c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, ws_ext_discount_amt#164, ws_ext_sales_price#165, ws_ext_wholesale_cost#166, ws_ext_list_price#167, ws_sold_date_sk#168, d_date_sk#169, d_year#170]

(108) HashAggregate [codegen id : 18]
Input [12]: [c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, ws_ext_discount_amt#164, ws_ext_sales_price#165, ws_ext_wholesale_cost#166, ws_ext_list_price#167, d_year#170]
Keys [8]: [c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, d_year#170]
Functions [1]: [partial_sum(((((ws_ext_list_price#167 - ws_ext_wholesale_cost#166) - ws_ext_discount_amt#164) + ws_ext_sales_price#165) / 2))]
Aggregate Attributes [2]: [sum#171, isEmpty#172]
Results [10]: [c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, d_year#170, sum#173, isEmpty#174]

(109) CometColumnarExchange
Input [10]: [c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, d_year#170, sum#173, isEmpty#174]
Arguments: hashpartitioning(c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, d_year#170, 5), ENSURE_REQUIREMENTS, CometColumnarShuffle, [plan_id=12]

(110) CometHashAggregate
Input [10]: [c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, d_year#170, sum#173, isEmpty#174]
Keys [8]: [c_customer_id#157, c_first_name#158, c_last_name#159, c_preferred_cust_flag#160, c_birth_country#154, c_login#161, c_email_address#162, d_year#170]
Functions [1]: [sum(((((ws_ext_list_price#167 - ws_ext_wholesale_cost#166) - ws_ext_discount_amt#164) + ws_ext_sales_price#165) / 2))]

(111) CometBroadcastExchange
Input [2]: [customer_id#175, year_total#176]
Arguments: [customer_id#175, year_total#176]

(112) CometBroadcastHashJoin
Left output [11]: [customer_id#28, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#92, year_total#120, year_total#148]
Right output [2]: [customer_id#175, year_total#176]
Arguments: [customer_id#28], [customer_id#175], Inner, (CASE WHEN (year_total#92 > 0.000000) THEN (year_total#120 / year_total#92) END > CASE WHEN (year_total#148 > 0.000000) THEN (year_total#176 / year_total#148) END), BuildRight

(113) CometProject
Input [13]: [customer_id#28, customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63, year_total#92, year_total#120, year_total#148, customer_id#175, year_total#176]
Arguments: [customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63], [customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63]

(114) CometTakeOrderedAndProject
Input [7]: [customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63]
Arguments: TakeOrderedAndProject(limit=100, orderBy=[customer_id#57 ASC NULLS FIRST,customer_first_name#58 ASC NULLS FIRST,customer_last_name#59 ASC NULLS FIRST,customer_preferred_cust_flag#60 ASC NULLS FIRST,customer_birth_country#61 ASC NULLS FIRST,customer_login#62 ASC NULLS FIRST,customer_email_address#63 ASC NULLS FIRST], output=[customer_id#57,customer_first_name#58,customer_last_name#59,customer_preferred_cust_flag#60,customer_birth_country#61,customer_login#62,customer_email_address#63]), [customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63], 100, 0, [customer_id#57 ASC NULLS FIRST, customer_first_name#58 ASC NULLS FIRST, customer_last_name#59 ASC NULLS FIRST, customer_preferred_cust_flag#60 ASC NULLS FIRST, customer_birth_country#61 ASC NULLS FIRST, customer_login#62 ASC NULLS FIRST, customer_email_address#63 ASC NULLS FIRST], [customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63]

(115) CometColumnarToRow [codegen id : 19]
Input [7]: [customer_id#57, customer_first_name#58, customer_last_name#59, customer_preferred_cust_flag#60, customer_birth_country#61, customer_login#62, customer_email_address#63]

===== Subqueries =====

Subquery:1 Hosting operator id = 5 Hosting Expression = ss_sold_date_sk#20 IN dynamicpruning#21
BroadcastExchange (119)
+- * CometColumnarToRow (118)
   +- CometFilter (117)
      +- CometNativeScan parquet spark_catalog.default.date_dim (116)


(116) CometNativeScan parquet spark_catalog.default.date_dim
Output [2]: [d_date_sk#22, d_year#23]
Batched: true
Location [not included in comparison]/{warehouse_dir}/date_dim]
PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_year:int>

(117) CometFilter
Input [2]: [d_date_sk#22, d_year#23]
Condition : ((isnotnull(d_year#23) AND (d_year#23 = 2001)) AND isnotnull(d_date_sk#22))

(118) CometColumnarToRow [codegen id : 1]
Input [2]: [d_date_sk#22, d_year#23]

(119) BroadcastExchange
Input [2]: [d_date_sk#22, d_year#23]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=13]

Subquery:2 Hosting operator id = 22 Hosting Expression = ss_sold_date_sk#49 IN dynamicpruning#50
BroadcastExchange (123)
+- * CometColumnarToRow (122)
   +- CometFilter (121)
      +- CometNativeScan parquet spark_catalog.default.date_dim (120)


(120) CometNativeScan parquet spark_catalog.default.date_dim
Output [2]: [d_date_sk#51, d_year#52]
Batched: true
Location [not included in comparison]/{warehouse_dir}/date_dim]
PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)]
ReadSchema: struct<d_date_sk:int,d_year:int>

(121) CometFilter
Input [2]: [d_date_sk#51, d_year#52]
Condition : ((isnotnull(d_year#52) AND (d_year#52 = 2002)) AND isnotnull(d_date_sk#51))

(122) CometColumnarToRow [codegen id : 1]
Input [2]: [d_date_sk#51, d_year#52]

(123) BroadcastExchange
Input [2]: [d_date_sk#51, d_year#52]
Arguments: HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=14]

Subquery:3 Hosting operator id = 40 Hosting Expression = cs_sold_date_sk#84 IN dynamicpruning#21

Subquery:4 Hosting operator id = 60 Hosting Expression = cs_sold_date_sk#112 IN dynamicpruning#50

Subquery:5 Hosting operator id = 79 Hosting Expression = ws_sold_date_sk#140 IN dynamicpruning#21

Subquery:6 Hosting operator id = 99 Hosting Expression = ws_sold_date_sk#168 IN dynamicpruning#50


