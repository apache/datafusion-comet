TakeOrderedAndProject
+- HashAggregate
   +- HashAggregate
      +- Union
         :- Project
         :  +- Filter
         :     +- Window
         :        +- Sort
         :           +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
         :              +- CometColumnarToRow
         :                 +- CometSort
         :                    +- CometExchange
         :                       +- CometHashAggregate
         :                          +- CometExchange
         :                             +- CometHashAggregate
         :                                +- CometProject
         :                                   +- CometBroadcastHashJoin
         :                                      :- CometProject
         :                                      :  +- CometBroadcastHashJoin
         :                                      :     :- CometBroadcastExchange
         :                                      :     :  +- CometProject
         :                                      :     :     +- CometFilter
         :                                      :     :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_sales
         :                                      :     :              +- SubqueryBroadcast
         :                                      :     :                 +- BroadcastExchange
         :                                      :     :                    +- CometColumnarToRow
         :                                      :     :                       +- CometProject
         :                                      :     :                          +- CometFilter
         :                                      :     :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
         :                                      :     +- CometProject
         :                                      :        +- CometFilter
         :                                      :           +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_returns
         :                                      +- CometBroadcastExchange
         :                                         +- CometProject
         :                                            +- CometFilter
         :                                               +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
         :- Project
         :  +- Filter
         :     +- Window
         :        +- Sort
         :           +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
         :              +- CometColumnarToRow
         :                 +- CometSort
         :                    +- CometExchange
         :                       +- CometHashAggregate
         :                          +- CometExchange
         :                             +- CometHashAggregate
         :                                +- CometProject
         :                                   +- CometBroadcastHashJoin
         :                                      :- CometProject
         :                                      :  +- CometBroadcastHashJoin
         :                                      :     :- CometBroadcastExchange
         :                                      :     :  +- CometProject
         :                                      :     :     +- CometFilter
         :                                      :     :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.catalog_sales
         :                                      :     :              +- ReusedSubquery
         :                                      :     +- CometProject
         :                                      :        +- CometFilter
         :                                      :           +- CometScan [native_iceberg_compat] parquet spark_catalog.default.catalog_returns
         :                                      +- CometBroadcastExchange
         :                                         +- CometProject
         :                                            +- CometFilter
         :                                               +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
         +- Project
            +- Filter
               +- Window
                  +- Sort
                     +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                        +- CometColumnarToRow
                           +- CometSort
                              +- CometExchange
                                 +- CometHashAggregate
                                    +- CometExchange
                                       +- CometHashAggregate
                                          +- CometProject
                                             +- CometBroadcastHashJoin
                                                :- CometProject
                                                :  +- CometBroadcastHashJoin
                                                :     :- CometBroadcastExchange
                                                :     :  +- CometProject
                                                :     :     +- CometFilter
                                                :     :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                                                :     :              +- ReusedSubquery
                                                :     +- CometProject
                                                :        +- CometFilter
                                                :           +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_returns
                                                +- CometBroadcastExchange
                                                   +- CometProject
                                                      +- CometFilter
                                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim

Comet accelerated 63 out of 86 eligible operators (73%). Final plan contains 4 transitions between Spark and Comet.