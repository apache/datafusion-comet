TakeOrderedAndProject
+- Project
   +- BroadcastHashJoin
      :- Project
      :  +- BroadcastHashJoin
      :     :- Project
      :     :  +- Filter
      :     :     +- Window
      :     :        +- Filter
      :     :           +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
      :     :              +- CometColumnarToRow
      :     :                 +- CometSort
      :     :                    +- CometColumnarExchange
      :     :                       +- HashAggregate
      :     :                          +- CometColumnarToRow
      :     :                             +- CometColumnarExchange
      :     :                                +- HashAggregate
      :     :                                   +- Project
      :     :                                      +- BroadcastHashJoin
      :     :                                         :- Project
      :     :                                         :  +- BroadcastHashJoin
      :     :                                         :     :- Project
      :     :                                         :     :  +- BroadcastHashJoin
      :     :                                         :     :     :- CometColumnarToRow
      :     :                                         :     :     :  +- CometProject
      :     :                                         :     :     :     +- CometFilter
      :     :                                         :     :     :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
      :     :                                         :     :     +- BroadcastExchange
      :     :                                         :     :        +- Filter
      :     :                                         :     :           +- ColumnarToRow
      :     :                                         :     :              +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
      :     :                                         :     :                    +- SubqueryBroadcast
      :     :                                         :     :                       +- CometColumnarToRow
      :     :                                         :     :                          +- CometBroadcastExchange
      :     :                                         :     :                             +- CometFilter
      :     :                                         :     :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :     :                                         :     +- BroadcastExchange
      :     :                                         :        +- CometColumnarToRow
      :     :                                         :           +- CometFilter
      :     :                                         :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :     :                                         +- BroadcastExchange
      :     :                                            +- CometColumnarToRow
      :     :                                               +- CometFilter
      :     :                                                  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
      :     +- BroadcastExchange
      :        +- Project
      :           +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
      :              +- CometColumnarToRow
      :                 +- CometSort
      :                    +- CometColumnarExchange
      :                       +- HashAggregate
      :                          +- CometColumnarToRow
      :                             +- CometColumnarExchange
      :                                +- HashAggregate
      :                                   +- Project
      :                                      +- BroadcastHashJoin
      :                                         :- Project
      :                                         :  +- BroadcastHashJoin
      :                                         :     :- Project
      :                                         :     :  +- BroadcastHashJoin
      :                                         :     :     :- CometColumnarToRow
      :                                         :     :     :  +- CometProject
      :                                         :     :     :     +- CometFilter
      :                                         :     :     :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
      :                                         :     :     +- BroadcastExchange
      :                                         :     :        +- Filter
      :                                         :     :           +- ColumnarToRow
      :                                         :     :              +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
      :                                         :     :                    +- SubqueryBroadcast
      :                                         :     :                       +- CometColumnarToRow
      :                                         :     :                          +- CometBroadcastExchange
      :                                         :     :                             +- CometFilter
      :                                         :     :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :                                         :     +- BroadcastExchange
      :                                         :        +- CometColumnarToRow
      :                                         :           +- CometFilter
      :                                         :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
      :                                         +- BroadcastExchange
      :                                            +- CometColumnarToRow
      :                                               +- CometFilter
      :                                                  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
      +- BroadcastExchange
         +- Project
            +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               +- CometColumnarToRow
                  +- CometSort
                     +- CometColumnarExchange
                        +- HashAggregate
                           +- CometColumnarToRow
                              +- CometColumnarExchange
                                 +- HashAggregate
                                    +- Project
                                       +- BroadcastHashJoin
                                          :- Project
                                          :  +- BroadcastHashJoin
                                          :     :- Project
                                          :     :  +- BroadcastHashJoin
                                          :     :     :- CometColumnarToRow
                                          :     :     :  +- CometProject
                                          :     :     :     +- CometFilter
                                          :     :     :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                          :     :     +- BroadcastExchange
                                          :     :        +- Filter
                                          :     :           +- ColumnarToRow
                                          :     :              +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                          :     :                    +- SubqueryBroadcast
                                          :     :                       +- CometColumnarToRow
                                          :     :                          +- CometBroadcastExchange
                                          :     :                             +- CometFilter
                                          :     :                                +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          :     +- BroadcastExchange
                                          :        +- CometColumnarToRow
                                          :           +- CometFilter
                                          :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                          +- BroadcastExchange
                                             +- CometColumnarToRow
                                                +- CometFilter
                                                   +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store

Comet accelerated 39 out of 97 eligible operators (40%). Final plan contains 21 transitions between Spark and Comet.