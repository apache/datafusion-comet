CometColumnarToRow
+- CometTakeOrderedAndProject
   +- RowToColumnar
      +- Project
         +- SortMergeJoin
            :- Project
            :  +- SortMergeJoin
            :     :- Sort
            :     :  +- HashAggregate
            :     :     +- CometColumnarToRow
            :     :        +- CometColumnarExchange
            :     :           +- HashAggregate
            :     :              +- Project
            :     :                 +- BroadcastHashJoin
            :     :                    :- CometColumnarToRow
            :     :                    :  +- CometProject
            :     :                    :     +- CometFilter
            :     :                    :        +- CometSortMergeJoin
            :     :                    :           :- CometSort
            :     :                    :           :  +- CometExchange
            :     :                    :           :     +- CometFilter
            :     :                    :           :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
            :     :                    :           :              +- SubqueryBroadcast
            :     :                    :           :                 +- BroadcastExchange
            :     :                    :           :                    +- CometColumnarToRow
            :     :                    :           :                       +- CometFilter
            :     :                    :           :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :     :                    :           +- CometSort
            :     :                    :              +- CometExchange
            :     :                    :                 +- CometProject
            :     :                    :                    +- CometFilter
            :     :                    :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_returns
            :     :                    +- BroadcastExchange
            :     :                       +- CometColumnarToRow
            :     :                          +- CometFilter
            :     :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :     +- Sort
            :        +- Filter
            :           +- HashAggregate
            :              +- CometColumnarToRow
            :                 +- CometColumnarExchange
            :                    +- HashAggregate
            :                       +- Project
            :                          +- BroadcastHashJoin
            :                             :- CometColumnarToRow
            :                             :  +- CometProject
            :                             :     +- CometFilter
            :                             :        +- CometSortMergeJoin
            :                             :           :- CometSort
            :                             :           :  +- CometExchange
            :                             :           :     +- CometFilter
            :                             :           :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_sales
            :                             :           :              +- ReusedSubquery
            :                             :           +- CometSort
            :                             :              +- CometExchange
            :                             :                 +- CometProject
            :                             :                    +- CometFilter
            :                             :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.web_returns
            :                             +- BroadcastExchange
            :                                +- CometColumnarToRow
            :                                   +- CometFilter
            :                                      +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            +- Sort
               +- Filter
                  +- HashAggregate
                     +- CometColumnarToRow
                        +- CometColumnarExchange
                           +- HashAggregate
                              +- Project
                                 +- BroadcastHashJoin
                                    :- CometColumnarToRow
                                    :  +- CometProject
                                    :     +- CometFilter
                                    :        +- CometSortMergeJoin
                                    :           :- CometSort
                                    :           :  +- CometExchange
                                    :           :     +- CometFilter
                                    :           :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.catalog_sales
                                    :           :              +- ReusedSubquery
                                    :           +- CometSort
                                    :              +- CometExchange
                                    :                 +- CometProject
                                    :                    +- CometFilter
                                    :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.catalog_returns
                                    +- BroadcastExchange
                                       +- CometColumnarToRow
                                          +- CometFilter
                                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim

Comet accelerated 48 out of 76 eligible operators (63%). Final plan contains 12 transitions between Spark and Comet.