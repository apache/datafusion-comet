TakeOrderedAndProject
+- Filter
   +- Window
      +-  WindowGroupLimit [COMET: WindowGroupLimit is not supported]
         +- CometColumnarToRow
            +- CometSort
               +- CometColumnarExchange
                  +- WindowGroupLimit
                     +- Sort
                        +- Union
                           :- HashAggregate
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +- Project
                           :              +- BroadcastHashJoin
                           :                 :- Project
                           :                 :  +- BroadcastHashJoin
                           :                 :     :- Project
                           :                 :     :  +- BroadcastHashJoin
                           :                 :     :     :- Filter
                           :                 :     :     :  +- ColumnarToRow
                           :                 :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                           :                 :     :     :           +- SubqueryBroadcast
                           :                 :     :     :              +- BroadcastExchange
                           :                 :     :     :                 +- CometColumnarToRow
                           :                 :     :     :                    +- CometProject
                           :                 :     :     :                       +- CometFilter
                           :                 :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                 :     :     +- BroadcastExchange
                           :                 :     :        +- CometColumnarToRow
                           :                 :     :           +- CometProject
                           :                 :     :              +- CometFilter
                           :                 :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                 :     +- BroadcastExchange
                           :                 :        +- CometColumnarToRow
                           :                 :           +- CometProject
                           :                 :              +- CometFilter
                           :                 :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                           :                 +- BroadcastExchange
                           :                    +- CometColumnarToRow
                           :                       +- CometProject
                           :                          +- CometFilter
                           :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                           :- HashAggregate
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +- HashAggregate
                           :              +- CometColumnarToRow
                           :                 +- CometColumnarExchange
                           :                    +- HashAggregate
                           :                       +- Project
                           :                          +- BroadcastHashJoin
                           :                             :- Project
                           :                             :  +- BroadcastHashJoin
                           :                             :     :- Project
                           :                             :     :  +- BroadcastHashJoin
                           :                             :     :     :- Filter
                           :                             :     :     :  +- ColumnarToRow
                           :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                           :                             :     :     :           +- SubqueryBroadcast
                           :                             :     :     :              +- BroadcastExchange
                           :                             :     :     :                 +- CometColumnarToRow
                           :                             :     :     :                    +- CometProject
                           :                             :     :     :                       +- CometFilter
                           :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     :     +- BroadcastExchange
                           :                             :     :        +- CometColumnarToRow
                           :                             :     :           +- CometProject
                           :                             :     :              +- CometFilter
                           :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     +- BroadcastExchange
                           :                             :        +- CometColumnarToRow
                           :                             :           +- CometProject
                           :                             :              +- CometFilter
                           :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                           :                             +- BroadcastExchange
                           :                                +- CometColumnarToRow
                           :                                   +- CometProject
                           :                                      +- CometFilter
                           :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                           :- HashAggregate
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +- HashAggregate
                           :              +- CometColumnarToRow
                           :                 +- CometColumnarExchange
                           :                    +- HashAggregate
                           :                       +- Project
                           :                          +- BroadcastHashJoin
                           :                             :- Project
                           :                             :  +- BroadcastHashJoin
                           :                             :     :- Project
                           :                             :     :  +- BroadcastHashJoin
                           :                             :     :     :- Filter
                           :                             :     :     :  +- ColumnarToRow
                           :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                           :                             :     :     :           +- SubqueryBroadcast
                           :                             :     :     :              +- BroadcastExchange
                           :                             :     :     :                 +- CometColumnarToRow
                           :                             :     :     :                    +- CometProject
                           :                             :     :     :                       +- CometFilter
                           :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     :     +- BroadcastExchange
                           :                             :     :        +- CometColumnarToRow
                           :                             :     :           +- CometProject
                           :                             :     :              +- CometFilter
                           :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     +- BroadcastExchange
                           :                             :        +- CometColumnarToRow
                           :                             :           +- CometProject
                           :                             :              +- CometFilter
                           :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                           :                             +- BroadcastExchange
                           :                                +- CometColumnarToRow
                           :                                   +- CometProject
                           :                                      +- CometFilter
                           :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                           :- HashAggregate
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +- HashAggregate
                           :              +- CometColumnarToRow
                           :                 +- CometColumnarExchange
                           :                    +- HashAggregate
                           :                       +- Project
                           :                          +- BroadcastHashJoin
                           :                             :- Project
                           :                             :  +- BroadcastHashJoin
                           :                             :     :- Project
                           :                             :     :  +- BroadcastHashJoin
                           :                             :     :     :- Filter
                           :                             :     :     :  +- ColumnarToRow
                           :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                           :                             :     :     :           +- SubqueryBroadcast
                           :                             :     :     :              +- BroadcastExchange
                           :                             :     :     :                 +- CometColumnarToRow
                           :                             :     :     :                    +- CometProject
                           :                             :     :     :                       +- CometFilter
                           :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     :     +- BroadcastExchange
                           :                             :     :        +- CometColumnarToRow
                           :                             :     :           +- CometProject
                           :                             :     :              +- CometFilter
                           :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     +- BroadcastExchange
                           :                             :        +- CometColumnarToRow
                           :                             :           +- CometProject
                           :                             :              +- CometFilter
                           :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                           :                             +- BroadcastExchange
                           :                                +- CometColumnarToRow
                           :                                   +- CometProject
                           :                                      +- CometFilter
                           :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                           :- HashAggregate
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +- HashAggregate
                           :              +- CometColumnarToRow
                           :                 +- CometColumnarExchange
                           :                    +- HashAggregate
                           :                       +- Project
                           :                          +- BroadcastHashJoin
                           :                             :- Project
                           :                             :  +- BroadcastHashJoin
                           :                             :     :- Project
                           :                             :     :  +- BroadcastHashJoin
                           :                             :     :     :- Filter
                           :                             :     :     :  +- ColumnarToRow
                           :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                           :                             :     :     :           +- SubqueryBroadcast
                           :                             :     :     :              +- BroadcastExchange
                           :                             :     :     :                 +- CometColumnarToRow
                           :                             :     :     :                    +- CometProject
                           :                             :     :     :                       +- CometFilter
                           :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     :     +- BroadcastExchange
                           :                             :     :        +- CometColumnarToRow
                           :                             :     :           +- CometProject
                           :                             :     :              +- CometFilter
                           :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     +- BroadcastExchange
                           :                             :        +- CometColumnarToRow
                           :                             :           +- CometProject
                           :                             :              +- CometFilter
                           :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                           :                             +- BroadcastExchange
                           :                                +- CometColumnarToRow
                           :                                   +- CometProject
                           :                                      +- CometFilter
                           :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                           :- HashAggregate
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +- HashAggregate
                           :              +- CometColumnarToRow
                           :                 +- CometColumnarExchange
                           :                    +- HashAggregate
                           :                       +- Project
                           :                          +- BroadcastHashJoin
                           :                             :- Project
                           :                             :  +- BroadcastHashJoin
                           :                             :     :- Project
                           :                             :     :  +- BroadcastHashJoin
                           :                             :     :     :- Filter
                           :                             :     :     :  +- ColumnarToRow
                           :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                           :                             :     :     :           +- SubqueryBroadcast
                           :                             :     :     :              +- BroadcastExchange
                           :                             :     :     :                 +- CometColumnarToRow
                           :                             :     :     :                    +- CometProject
                           :                             :     :     :                       +- CometFilter
                           :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     :     +- BroadcastExchange
                           :                             :     :        +- CometColumnarToRow
                           :                             :     :           +- CometProject
                           :                             :     :              +- CometFilter
                           :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     +- BroadcastExchange
                           :                             :        +- CometColumnarToRow
                           :                             :           +- CometProject
                           :                             :              +- CometFilter
                           :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                           :                             +- BroadcastExchange
                           :                                +- CometColumnarToRow
                           :                                   +- CometProject
                           :                                      +- CometFilter
                           :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                           :- HashAggregate
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +- HashAggregate
                           :              +- CometColumnarToRow
                           :                 +- CometColumnarExchange
                           :                    +- HashAggregate
                           :                       +- Project
                           :                          +- BroadcastHashJoin
                           :                             :- Project
                           :                             :  +- BroadcastHashJoin
                           :                             :     :- Project
                           :                             :     :  +- BroadcastHashJoin
                           :                             :     :     :- Filter
                           :                             :     :     :  +- ColumnarToRow
                           :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                           :                             :     :     :           +- SubqueryBroadcast
                           :                             :     :     :              +- BroadcastExchange
                           :                             :     :     :                 +- CometColumnarToRow
                           :                             :     :     :                    +- CometProject
                           :                             :     :     :                       +- CometFilter
                           :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     :     +- BroadcastExchange
                           :                             :     :        +- CometColumnarToRow
                           :                             :     :           +- CometProject
                           :                             :     :              +- CometFilter
                           :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     +- BroadcastExchange
                           :                             :        +- CometColumnarToRow
                           :                             :           +- CometProject
                           :                             :              +- CometFilter
                           :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                           :                             +- BroadcastExchange
                           :                                +- CometColumnarToRow
                           :                                   +- CometProject
                           :                                      +- CometFilter
                           :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                           :- HashAggregate
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +- HashAggregate
                           :              +- CometColumnarToRow
                           :                 +- CometColumnarExchange
                           :                    +- HashAggregate
                           :                       +- Project
                           :                          +- BroadcastHashJoin
                           :                             :- Project
                           :                             :  +- BroadcastHashJoin
                           :                             :     :- Project
                           :                             :     :  +- BroadcastHashJoin
                           :                             :     :     :- Filter
                           :                             :     :     :  +- ColumnarToRow
                           :                             :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                           :                             :     :     :           +- SubqueryBroadcast
                           :                             :     :     :              +- BroadcastExchange
                           :                             :     :     :                 +- CometColumnarToRow
                           :                             :     :     :                    +- CometProject
                           :                             :     :     :                       +- CometFilter
                           :                             :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     :     +- BroadcastExchange
                           :                             :     :        +- CometColumnarToRow
                           :                             :     :           +- CometProject
                           :                             :     :              +- CometFilter
                           :                             :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                           :                             :     +- BroadcastExchange
                           :                             :        +- CometColumnarToRow
                           :                             :           +- CometProject
                           :                             :              +- CometFilter
                           :                             :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                           :                             +- BroadcastExchange
                           :                                +- CometColumnarToRow
                           :                                   +- CometProject
                           :                                      +- CometFilter
                           :                                         +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                           +- HashAggregate
                              +- CometColumnarToRow
                                 +- CometColumnarExchange
                                    +- HashAggregate
                                       +- HashAggregate
                                          +- CometColumnarToRow
                                             +- CometColumnarExchange
                                                +- HashAggregate
                                                   +- Project
                                                      +- BroadcastHashJoin
                                                         :- Project
                                                         :  +- BroadcastHashJoin
                                                         :     :- Project
                                                         :     :  +- BroadcastHashJoin
                                                         :     :     :- Filter
                                                         :     :     :  +- ColumnarToRow
                                                         :     :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Dynamic Partition Pruning is not supported with spark.comet.scan.impl=native_iceberg_compat.]
                                                         :     :     :           +- SubqueryBroadcast
                                                         :     :     :              +- BroadcastExchange
                                                         :     :     :                 +- CometColumnarToRow
                                                         :     :     :                    +- CometProject
                                                         :     :     :                       +- CometFilter
                                                         :     :     :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                                         :     :     +- BroadcastExchange
                                                         :     :        +- CometColumnarToRow
                                                         :     :           +- CometProject
                                                         :     :              +- CometFilter
                                                         :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                                         :     +- BroadcastExchange
                                                         :        +- CometColumnarToRow
                                                         :           +- CometProject
                                                         :              +- CometFilter
                                                         :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                                                         +- BroadcastExchange
                                                            +- CometColumnarToRow
                                                               +- CometProject
                                                                  +- CometFilter
                                                                     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item

Comet accelerated 127 out of 285 eligible operators (44%). Final plan contains 63 transitions between Spark and Comet.