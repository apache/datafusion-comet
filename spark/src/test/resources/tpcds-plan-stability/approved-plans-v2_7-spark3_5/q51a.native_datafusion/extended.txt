TakeOrderedAndProject
+- Filter
   +- HashAggregate
      +- HashAggregate
         +- Project
            +- BroadcastHashJoin
               :-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :  +- CometColumnarToRow
               :     +- CometSort
               :        +- CometExchange
               :           +- CometProject
               :              +- CometFilter
               :                 +- CometSortMergeJoin
               :                    :- CometSort
               :                    :  +- CometExchange
               :                    :     +- CometHashAggregate
               :                    :        +- CometColumnarExchange
               :                    :           +- HashAggregate
               :                    :              +- Project
               :                    :                 +- BroadcastHashJoin
               :                    :                    :- Project
               :                    :                    :  +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :                    :                    :     +- CometColumnarToRow
               :                    :                    :        +- CometSort
               :                    :                    :           +- CometExchange
               :                    :                    :              +- CometHashAggregate
               :                    :                    :                 +- CometColumnarExchange
               :                    :                    :                    +- HashAggregate
               :                    :                    :                       +- Project
               :                    :                    :                          +- BroadcastHashJoin
               :                    :                    :                             :- Filter
               :                    :                    :                             :  +- ColumnarToRow
               :                    :                    :                             :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                    :                    :                             :           +- SubqueryBroadcast
               :                    :                    :                             :              +- BroadcastExchange
               :                    :                    :                             :                 +- CometColumnarToRow
               :                    :                    :                             :                    +- CometProject
               :                    :                    :                             :                       +- CometFilter
               :                    :                    :                             :                          +- CometNativeScan parquet spark_catalog.default.date_dim
               :                    :                    :                             +- BroadcastExchange
               :                    :                    :                                +- CometColumnarToRow
               :                    :                    :                                   +- CometProject
               :                    :                    :                                      +- CometFilter
               :                    :                    :                                         +- CometNativeScan parquet spark_catalog.default.date_dim
               :                    :                    +- BroadcastExchange
               :                    :                       +- Project
               :                    :                          +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :                    :                             +- CometColumnarToRow
               :                    :                                +- CometSort
               :                    :                                   +- CometExchange
               :                    :                                      +- CometHashAggregate
               :                    :                                         +- CometColumnarExchange
               :                    :                                            +- HashAggregate
               :                    :                                               +- Project
               :                    :                                                  +- BroadcastHashJoin
               :                    :                                                     :- Filter
               :                    :                                                     :  +- ColumnarToRow
               :                    :                                                     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                    :                                                     :           +- SubqueryBroadcast
               :                    :                                                     :              +- BroadcastExchange
               :                    :                                                     :                 +- CometColumnarToRow
               :                    :                                                     :                    +- CometProject
               :                    :                                                     :                       +- CometFilter
               :                    :                                                     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
               :                    :                                                     +- BroadcastExchange
               :                    :                                                        +- CometColumnarToRow
               :                    :                                                           +- CometProject
               :                    :                                                              +- CometFilter
               :                    :                                                                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                    +- CometSort
               :                       +- CometExchange
               :                          +- CometHashAggregate
               :                             +- CometColumnarExchange
               :                                +- HashAggregate
               :                                   +- Project
               :                                      +- BroadcastHashJoin
               :                                         :- Project
               :                                         :  +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :                                         :     +- CometColumnarToRow
               :                                         :        +- CometSort
               :                                         :           +- CometExchange
               :                                         :              +- CometHashAggregate
               :                                         :                 +- CometColumnarExchange
               :                                         :                    +- HashAggregate
               :                                         :                       +- Project
               :                                         :                          +- BroadcastHashJoin
               :                                         :                             :- Filter
               :                                         :                             :  +- ColumnarToRow
               :                                         :                             :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                                         :                             :           +- ReusedSubquery
               :                                         :                             +- BroadcastExchange
               :                                         :                                +- CometColumnarToRow
               :                                         :                                   +- CometProject
               :                                         :                                      +- CometFilter
               :                                         :                                         +- CometNativeScan parquet spark_catalog.default.date_dim
               :                                         +- BroadcastExchange
               :                                            +- Project
               :                                               +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
               :                                                  +- CometColumnarToRow
               :                                                     +- CometSort
               :                                                        +- CometExchange
               :                                                           +- CometHashAggregate
               :                                                              +- CometColumnarExchange
               :                                                                 +- HashAggregate
               :                                                                    +- Project
               :                                                                       +- BroadcastHashJoin
               :                                                                          :- Filter
               :                                                                          :  +- ColumnarToRow
               :                                                                          :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                                                                          :           +- ReusedSubquery
               :                                                                          +- BroadcastExchange
               :                                                                             +- CometColumnarToRow
               :                                                                                +- CometProject
               :                                                                                   +- CometFilter
               :                                                                                      +- CometNativeScan parquet spark_catalog.default.date_dim
               +- BroadcastExchange
                  +- Project
                     +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                        +- CometColumnarToRow
                           +- CometSort
                              +- CometExchange
                                 +- CometProject
                                    +- CometFilter
                                       +- CometSortMergeJoin
                                          :- CometSort
                                          :  +- CometExchange
                                          :     +- CometHashAggregate
                                          :        +- CometColumnarExchange
                                          :           +- HashAggregate
                                          :              +- Project
                                          :                 +- BroadcastHashJoin
                                          :                    :- Project
                                          :                    :  +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                                          :                    :     +- CometColumnarToRow
                                          :                    :        +- CometSort
                                          :                    :           +- CometExchange
                                          :                    :              +- CometHashAggregate
                                          :                    :                 +- CometColumnarExchange
                                          :                    :                    +- HashAggregate
                                          :                    :                       +- Project
                                          :                    :                          +- BroadcastHashJoin
                                          :                    :                             :- Filter
                                          :                    :                             :  +- ColumnarToRow
                                          :                    :                             :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                          :                    :                             :           +- SubqueryBroadcast
                                          :                    :                             :              +- BroadcastExchange
                                          :                    :                             :                 +- CometColumnarToRow
                                          :                    :                             :                    +- CometProject
                                          :                    :                             :                       +- CometFilter
                                          :                    :                             :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                                          :                    :                             +- BroadcastExchange
                                          :                    :                                +- CometColumnarToRow
                                          :                    :                                   +- CometProject
                                          :                    :                                      +- CometFilter
                                          :                    :                                         +- CometNativeScan parquet spark_catalog.default.date_dim
                                          :                    +- BroadcastExchange
                                          :                       +- Project
                                          :                          +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                                          :                             +- CometColumnarToRow
                                          :                                +- CometSort
                                          :                                   +- CometExchange
                                          :                                      +- CometHashAggregate
                                          :                                         +- CometColumnarExchange
                                          :                                            +- HashAggregate
                                          :                                               +- Project
                                          :                                                  +- BroadcastHashJoin
                                          :                                                     :- Filter
                                          :                                                     :  +- ColumnarToRow
                                          :                                                     :     +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                          :                                                     :           +- SubqueryBroadcast
                                          :                                                     :              +- BroadcastExchange
                                          :                                                     :                 +- CometColumnarToRow
                                          :                                                     :                    +- CometProject
                                          :                                                     :                       +- CometFilter
                                          :                                                     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                                          :                                                     +- BroadcastExchange
                                          :                                                        +- CometColumnarToRow
                                          :                                                           +- CometProject
                                          :                                                              +- CometFilter
                                          :                                                                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                          +- CometSort
                                             +- CometExchange
                                                +- CometHashAggregate
                                                   +- CometColumnarExchange
                                                      +- HashAggregate
                                                         +- Project
                                                            +- BroadcastHashJoin
                                                               :- Project
                                                               :  +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                                                               :     +- CometColumnarToRow
                                                               :        +- CometSort
                                                               :           +- CometExchange
                                                               :              +- CometHashAggregate
                                                               :                 +- CometColumnarExchange
                                                               :                    +- HashAggregate
                                                               :                       +- Project
                                                               :                          +- BroadcastHashJoin
                                                               :                             :- Filter
                                                               :                             :  +- ColumnarToRow
                                                               :                             :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                                               :                             :           +- ReusedSubquery
                                                               :                             +- BroadcastExchange
                                                               :                                +- CometColumnarToRow
                                                               :                                   +- CometProject
                                                               :                                      +- CometFilter
                                                               :                                         +- CometNativeScan parquet spark_catalog.default.date_dim
                                                               +- BroadcastExchange
                                                                  +- Project
                                                                     +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
                                                                        +- CometColumnarToRow
                                                                           +- CometSort
                                                                              +- CometExchange
                                                                                 +- CometHashAggregate
                                                                                    +- CometColumnarExchange
                                                                                       +- HashAggregate
                                                                                          +- Project
                                                                                             +- BroadcastHashJoin
                                                                                                :- Filter
                                                                                                :  +- ColumnarToRow
                                                                                                :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                                                                                :           +- ReusedSubquery
                                                                                                +- BroadcastExchange
                                                                                                   +- CometColumnarToRow
                                                                                                      +- CometProject
                                                                                                         +- CometFilter
                                                                                                            +- CometNativeScan parquet spark_catalog.default.date_dim

Comet accelerated 94 out of 196 eligible operators (47%). Final plan contains 30 transitions between Spark and Comet.