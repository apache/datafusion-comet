CometColumnarToRow
+- CometTakeOrderedAndProject
   +- CometHashAggregate
      +- CometExchange
         +- CometHashAggregate
            +- CometUnion
               :- CometHashAggregate
               :  +- CometExchange
               :     +- CometHashAggregate
               :        +- CometUnion
               :           :- CometHashAggregate
               :           :  +- CometColumnarExchange
               :           :     +- HashAggregate
               :           :        +- Project
               :           :           +- BroadcastHashJoin
               :           :              :- Project
               :           :              :  +- BroadcastHashJoin
               :           :              :     :- Union
               :           :              :     :  :- Project
               :           :              :     :  :  +- Filter
               :           :              :     :  :     +- ColumnarToRow
               :           :              :     :  :        +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :           :              :     :  :              +- SubqueryBroadcast
               :           :              :     :  :                 +- BroadcastExchange
               :           :              :     :  :                    +- CometColumnarToRow
               :           :              :     :  :                       +- CometProject
               :           :              :     :  :                          +- CometFilter
               :           :              :     :  :                             +- CometNativeScan parquet spark_catalog.default.date_dim
               :           :              :     :  +- Project
               :           :              :     :     +- Filter
               :           :              :     :        +- ColumnarToRow
               :           :              :     :           +-  Scan parquet spark_catalog.default.store_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :           :              :     :                 +- ReusedSubquery
               :           :              :     +- BroadcastExchange
               :           :              :        +- CometColumnarToRow
               :           :              :           +- CometProject
               :           :              :              +- CometFilter
               :           :              :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :           :              +- BroadcastExchange
               :           :                 +- CometColumnarToRow
               :           :                    +- CometProject
               :           :                       +- CometFilter
               :           :                          +- CometNativeScan parquet spark_catalog.default.store
               :           :- CometHashAggregate
               :           :  +- CometColumnarExchange
               :           :     +- HashAggregate
               :           :        +- Project
               :           :           +- BroadcastHashJoin
               :           :              :- Project
               :           :              :  +- BroadcastHashJoin
               :           :              :     :- Union
               :           :              :     :  :- Project
               :           :              :     :  :  +- Filter
               :           :              :     :  :     +- ColumnarToRow
               :           :              :     :  :        +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :           :              :     :  :              +- ReusedSubquery
               :           :              :     :  +- Project
               :           :              :     :     +- Filter
               :           :              :     :        +- ColumnarToRow
               :           :              :     :           +-  Scan parquet spark_catalog.default.catalog_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :           :              :     :                 +- ReusedSubquery
               :           :              :     +- BroadcastExchange
               :           :              :        +- CometColumnarToRow
               :           :              :           +- CometProject
               :           :              :              +- CometFilter
               :           :              :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :           :              +- BroadcastExchange
               :           :                 +- CometColumnarToRow
               :           :                    +- CometProject
               :           :                       +- CometFilter
               :           :                          +- CometNativeScan parquet spark_catalog.default.catalog_page
               :           +- CometHashAggregate
               :              +- CometColumnarExchange
               :                 +- HashAggregate
               :                    +- Project
               :                       +- BroadcastHashJoin
               :                          :- Project
               :                          :  +- BroadcastHashJoin
               :                          :     :- Union
               :                          :     :  :- Project
               :                          :     :  :  +- Filter
               :                          :     :  :     +- ColumnarToRow
               :                          :     :  :        +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                          :     :  :              +- ReusedSubquery
               :                          :     :  +- Project
               :                          :     :     +- BroadcastHashJoin
               :                          :     :        :- BroadcastExchange
               :                          :     :        :  +- ColumnarToRow
               :                          :     :        :     +-  Scan parquet spark_catalog.default.web_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                          :     :        :           +- ReusedSubquery
               :                          :     :        +- CometColumnarToRow
               :                          :     :           +- CometProject
               :                          :     :              +- CometFilter
               :                          :     :                 +- CometNativeScan parquet spark_catalog.default.web_sales
               :                          :     +- BroadcastExchange
               :                          :        +- CometColumnarToRow
               :                          :           +- CometProject
               :                          :              +- CometFilter
               :                          :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                          +- BroadcastExchange
               :                             +- CometColumnarToRow
               :                                +- CometProject
               :                                   +- CometFilter
               :                                      +- CometNativeScan parquet spark_catalog.default.web_site
               :- CometHashAggregate
               :  +- CometExchange
               :     +- CometHashAggregate
               :        +- CometHashAggregate
               :           +- CometExchange
               :              +- CometHashAggregate
               :                 +- CometUnion
               :                    :- CometHashAggregate
               :                    :  +- CometColumnarExchange
               :                    :     +- HashAggregate
               :                    :        +- Project
               :                    :           +- BroadcastHashJoin
               :                    :              :- Project
               :                    :              :  +- BroadcastHashJoin
               :                    :              :     :- Union
               :                    :              :     :  :- Project
               :                    :              :     :  :  +- Filter
               :                    :              :     :  :     +- ColumnarToRow
               :                    :              :     :  :        +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                    :              :     :  :              +- SubqueryBroadcast
               :                    :              :     :  :                 +- BroadcastExchange
               :                    :              :     :  :                    +- CometColumnarToRow
               :                    :              :     :  :                       +- CometProject
               :                    :              :     :  :                          +- CometFilter
               :                    :              :     :  :                             +- CometNativeScan parquet spark_catalog.default.date_dim
               :                    :              :     :  +- Project
               :                    :              :     :     +- Filter
               :                    :              :     :        +- ColumnarToRow
               :                    :              :     :           +-  Scan parquet spark_catalog.default.store_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                    :              :     :                 +- ReusedSubquery
               :                    :              :     +- BroadcastExchange
               :                    :              :        +- CometColumnarToRow
               :                    :              :           +- CometProject
               :                    :              :              +- CometFilter
               :                    :              :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                    :              +- BroadcastExchange
               :                    :                 +- CometColumnarToRow
               :                    :                    +- CometProject
               :                    :                       +- CometFilter
               :                    :                          +- CometNativeScan parquet spark_catalog.default.store
               :                    :- CometHashAggregate
               :                    :  +- CometColumnarExchange
               :                    :     +- HashAggregate
               :                    :        +- Project
               :                    :           +- BroadcastHashJoin
               :                    :              :- Project
               :                    :              :  +- BroadcastHashJoin
               :                    :              :     :- Union
               :                    :              :     :  :- Project
               :                    :              :     :  :  +- Filter
               :                    :              :     :  :     +- ColumnarToRow
               :                    :              :     :  :        +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                    :              :     :  :              +- ReusedSubquery
               :                    :              :     :  +- Project
               :                    :              :     :     +- Filter
               :                    :              :     :        +- ColumnarToRow
               :                    :              :     :           +-  Scan parquet spark_catalog.default.catalog_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                    :              :     :                 +- ReusedSubquery
               :                    :              :     +- BroadcastExchange
               :                    :              :        +- CometColumnarToRow
               :                    :              :           +- CometProject
               :                    :              :              +- CometFilter
               :                    :              :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                    :              +- BroadcastExchange
               :                    :                 +- CometColumnarToRow
               :                    :                    +- CometProject
               :                    :                       +- CometFilter
               :                    :                          +- CometNativeScan parquet spark_catalog.default.catalog_page
               :                    +- CometHashAggregate
               :                       +- CometColumnarExchange
               :                          +- HashAggregate
               :                             +- Project
               :                                +- BroadcastHashJoin
               :                                   :- Project
               :                                   :  +- BroadcastHashJoin
               :                                   :     :- Union
               :                                   :     :  :- Project
               :                                   :     :  :  +- Filter
               :                                   :     :  :     +- ColumnarToRow
               :                                   :     :  :        +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                                   :     :  :              +- ReusedSubquery
               :                                   :     :  +- Project
               :                                   :     :     +- BroadcastHashJoin
               :                                   :     :        :- BroadcastExchange
               :                                   :     :        :  +- ColumnarToRow
               :                                   :     :        :     +-  Scan parquet spark_catalog.default.web_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
               :                                   :     :        :           +- ReusedSubquery
               :                                   :     :        +- CometColumnarToRow
               :                                   :     :           +- CometProject
               :                                   :     :              +- CometFilter
               :                                   :     :                 +- CometNativeScan parquet spark_catalog.default.web_sales
               :                                   :     +- BroadcastExchange
               :                                   :        +- CometColumnarToRow
               :                                   :           +- CometProject
               :                                   :              +- CometFilter
               :                                   :                 +- CometNativeScan parquet spark_catalog.default.date_dim
               :                                   +- BroadcastExchange
               :                                      +- CometColumnarToRow
               :                                         +- CometProject
               :                                            +- CometFilter
               :                                               +- CometNativeScan parquet spark_catalog.default.web_site
               +- CometHashAggregate
                  +- CometExchange
                     +- CometHashAggregate
                        +- CometHashAggregate
                           +- CometExchange
                              +- CometHashAggregate
                                 +- CometUnion
                                    :- CometHashAggregate
                                    :  +- CometColumnarExchange
                                    :     +- HashAggregate
                                    :        +- Project
                                    :           +- BroadcastHashJoin
                                    :              :- Project
                                    :              :  +- BroadcastHashJoin
                                    :              :     :- Union
                                    :              :     :  :- Project
                                    :              :     :  :  +- Filter
                                    :              :     :  :     +- ColumnarToRow
                                    :              :     :  :        +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                    :              :     :  :              +- SubqueryBroadcast
                                    :              :     :  :                 +- BroadcastExchange
                                    :              :     :  :                    +- CometColumnarToRow
                                    :              :     :  :                       +- CometProject
                                    :              :     :  :                          +- CometFilter
                                    :              :     :  :                             +- CometNativeScan parquet spark_catalog.default.date_dim
                                    :              :     :  +- Project
                                    :              :     :     +- Filter
                                    :              :     :        +- ColumnarToRow
                                    :              :     :           +-  Scan parquet spark_catalog.default.store_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                    :              :     :                 +- ReusedSubquery
                                    :              :     +- BroadcastExchange
                                    :              :        +- CometColumnarToRow
                                    :              :           +- CometProject
                                    :              :              +- CometFilter
                                    :              :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                    :              +- BroadcastExchange
                                    :                 +- CometColumnarToRow
                                    :                    +- CometProject
                                    :                       +- CometFilter
                                    :                          +- CometNativeScan parquet spark_catalog.default.store
                                    :- CometHashAggregate
                                    :  +- CometColumnarExchange
                                    :     +- HashAggregate
                                    :        +- Project
                                    :           +- BroadcastHashJoin
                                    :              :- Project
                                    :              :  +- BroadcastHashJoin
                                    :              :     :- Union
                                    :              :     :  :- Project
                                    :              :     :  :  +- Filter
                                    :              :     :  :     +- ColumnarToRow
                                    :              :     :  :        +-  Scan parquet spark_catalog.default.catalog_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                    :              :     :  :              +- ReusedSubquery
                                    :              :     :  +- Project
                                    :              :     :     +- Filter
                                    :              :     :        +- ColumnarToRow
                                    :              :     :           +-  Scan parquet spark_catalog.default.catalog_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                    :              :     :                 +- ReusedSubquery
                                    :              :     +- BroadcastExchange
                                    :              :        +- CometColumnarToRow
                                    :              :           +- CometProject
                                    :              :              +- CometFilter
                                    :              :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                    :              +- BroadcastExchange
                                    :                 +- CometColumnarToRow
                                    :                    +- CometProject
                                    :                       +- CometFilter
                                    :                          +- CometNativeScan parquet spark_catalog.default.catalog_page
                                    +- CometHashAggregate
                                       +- CometColumnarExchange
                                          +- HashAggregate
                                             +- Project
                                                +- BroadcastHashJoin
                                                   :- Project
                                                   :  +- BroadcastHashJoin
                                                   :     :- Union
                                                   :     :  :- Project
                                                   :     :  :  +- Filter
                                                   :     :  :     +- ColumnarToRow
                                                   :     :  :        +-  Scan parquet spark_catalog.default.web_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                                   :     :  :              +- ReusedSubquery
                                                   :     :  +- Project
                                                   :     :     +- BroadcastHashJoin
                                                   :     :        :- BroadcastExchange
                                                   :     :        :  +- ColumnarToRow
                                                   :     :        :     +-  Scan parquet spark_catalog.default.web_returns [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                                   :     :        :           +- ReusedSubquery
                                                   :     :        +- CometColumnarToRow
                                                   :     :           +- CometProject
                                                   :     :              +- CometFilter
                                                   :     :                 +- CometNativeScan parquet spark_catalog.default.web_sales
                                                   :     +- BroadcastExchange
                                                   :        +- CometColumnarToRow
                                                   :           +- CometProject
                                                   :              +- CometFilter
                                                   :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                                   +- BroadcastExchange
                                                      +- CometColumnarToRow
                                                         +- CometProject
                                                            +- CometFilter
                                                               +- CometNativeScan parquet spark_catalog.default.web_site

Comet accelerated 113 out of 263 eligible operators (42%). Final plan contains 43 transitions between Spark and Comet.