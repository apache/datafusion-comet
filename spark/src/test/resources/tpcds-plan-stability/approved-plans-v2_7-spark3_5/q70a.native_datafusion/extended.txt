TakeOrderedAndProject
+- Project
   +-  Window [COMET: WindowExec is not fully compatible with Spark (Native WindowExec has known correctness issues). To enable it anyway, set spark.comet.operator.WindowExec.allowIncompatible=true. For more information, refer to the Comet Compatibility Guide (https://datafusion.apache.org/comet/user-guide/compatibility.html).]
      +- CometColumnarToRow
         +- CometSort
            +- CometExchange
               +- CometHashAggregate
                  +- CometColumnarExchange
                     +- HashAggregate
                        +- Union
                           :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +- Project
                           :              +- BroadcastHashJoin
                           :                 :- Project
                           :                 :  +- BroadcastHashJoin
                           :                 :     :- Filter
                           :                 :     :  +- ColumnarToRow
                           :                 :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :                 :     :           +- SubqueryBroadcast
                           :                 :     :              +- BroadcastExchange
                           :                 :     :                 +- CometColumnarToRow
                           :                 :     :                    +- CometProject
                           :                 :     :                       +- CometFilter
                           :                 :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                           :                 :     +- BroadcastExchange
                           :                 :        +- CometColumnarToRow
                           :                 :           +- CometProject
                           :                 :              +- CometFilter
                           :                 :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                           :                 +- BroadcastExchange
                           :                    +- Project
                           :                       +- BroadcastHashJoin
                           :                          :- CometColumnarToRow
                           :                          :  +- CometFilter
                           :                          :     +- CometNativeScan parquet spark_catalog.default.store
                           :                          +- BroadcastExchange
                           :                             +- Project
                           :                                +- Filter
                           :                                   +- Window
                           :                                      +- WindowGroupLimit
                           :                                         +- Sort
                           :                                            +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                           :                                               +- CometColumnarToRow
                           :                                                  +- CometColumnarExchange
                           :                                                     +- HashAggregate
                           :                                                        +- Project
                           :                                                           +- BroadcastHashJoin
                           :                                                              :- Project
                           :                                                              :  +- BroadcastHashJoin
                           :                                                              :     :- Filter
                           :                                                              :     :  +- ColumnarToRow
                           :                                                              :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :                                                              :     :           +- ReusedSubquery
                           :                                                              :     +- BroadcastExchange
                           :                                                              :        +- CometColumnarToRow
                           :                                                              :           +- CometProject
                           :                                                              :              +- CometFilter
                           :                                                              :                 +- CometNativeScan parquet spark_catalog.default.store
                           :                                                              +- BroadcastExchange
                           :                                                                 +- CometColumnarToRow
                           :                                                                    +- CometProject
                           :                                                                       +- CometFilter
                           :                                                                          +- CometNativeScan parquet spark_catalog.default.date_dim
                           :-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                           :  +- CometColumnarToRow
                           :     +- CometColumnarExchange
                           :        +- HashAggregate
                           :           +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                           :              +- CometColumnarToRow
                           :                 +- CometColumnarExchange
                           :                    +- HashAggregate
                           :                       +- Project
                           :                          +- BroadcastHashJoin
                           :                             :- Project
                           :                             :  +- BroadcastHashJoin
                           :                             :     :- Filter
                           :                             :     :  +- ColumnarToRow
                           :                             :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :                             :     :           +- SubqueryBroadcast
                           :                             :     :              +- BroadcastExchange
                           :                             :     :                 +- CometColumnarToRow
                           :                             :     :                    +- CometProject
                           :                             :     :                       +- CometFilter
                           :                             :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                           :                             :     +- BroadcastExchange
                           :                             :        +- CometColumnarToRow
                           :                             :           +- CometProject
                           :                             :              +- CometFilter
                           :                             :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                           :                             +- BroadcastExchange
                           :                                +- Project
                           :                                   +- BroadcastHashJoin
                           :                                      :- CometColumnarToRow
                           :                                      :  +- CometFilter
                           :                                      :     +- CometNativeScan parquet spark_catalog.default.store
                           :                                      +- BroadcastExchange
                           :                                         +- Project
                           :                                            +- Filter
                           :                                               +- Window
                           :                                                  +- WindowGroupLimit
                           :                                                     +- Sort
                           :                                                        +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                           :                                                           +- CometColumnarToRow
                           :                                                              +- CometColumnarExchange
                           :                                                                 +- HashAggregate
                           :                                                                    +- Project
                           :                                                                       +- BroadcastHashJoin
                           :                                                                          :- Project
                           :                                                                          :  +- BroadcastHashJoin
                           :                                                                          :     :- Filter
                           :                                                                          :     :  +- ColumnarToRow
                           :                                                                          :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                           :                                                                          :     :           +- ReusedSubquery
                           :                                                                          :     +- BroadcastExchange
                           :                                                                          :        +- CometColumnarToRow
                           :                                                                          :           +- CometProject
                           :                                                                          :              +- CometFilter
                           :                                                                          :                 +- CometNativeScan parquet spark_catalog.default.store
                           :                                                                          +- BroadcastExchange
                           :                                                                             +- CometColumnarToRow
                           :                                                                                +- CometProject
                           :                                                                                   +- CometFilter
                           :                                                                                      +- CometNativeScan parquet spark_catalog.default.date_dim
                           +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                              +- CometColumnarToRow
                                 +- CometColumnarExchange
                                    +- HashAggregate
                                       +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                                          +- CometColumnarToRow
                                             +- CometColumnarExchange
                                                +- HashAggregate
                                                   +- Project
                                                      +- BroadcastHashJoin
                                                         :- Project
                                                         :  +- BroadcastHashJoin
                                                         :     :- Filter
                                                         :     :  +- ColumnarToRow
                                                         :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                                         :     :           +- SubqueryBroadcast
                                                         :     :              +- BroadcastExchange
                                                         :     :                 +- CometColumnarToRow
                                                         :     :                    +- CometProject
                                                         :     :                       +- CometFilter
                                                         :     :                          +- CometNativeScan parquet spark_catalog.default.date_dim
                                                         :     +- BroadcastExchange
                                                         :        +- CometColumnarToRow
                                                         :           +- CometProject
                                                         :              +- CometFilter
                                                         :                 +- CometNativeScan parquet spark_catalog.default.date_dim
                                                         +- BroadcastExchange
                                                            +- Project
                                                               +- BroadcastHashJoin
                                                                  :- CometColumnarToRow
                                                                  :  +- CometFilter
                                                                  :     +- CometNativeScan parquet spark_catalog.default.store
                                                                  +- BroadcastExchange
                                                                     +- Project
                                                                        +- Filter
                                                                           +- Window
                                                                              +- WindowGroupLimit
                                                                                 +- Sort
                                                                                    +-  HashAggregate [COMET: Final mode hash aggregation requires Comet partial aggregation in the child plan]
                                                                                       +- CometColumnarToRow
                                                                                          +- CometColumnarExchange
                                                                                             +- HashAggregate
                                                                                                +- Project
                                                                                                   +- BroadcastHashJoin
                                                                                                      :- Project
                                                                                                      :  +- BroadcastHashJoin
                                                                                                      :     :- Filter
                                                                                                      :     :  +- ColumnarToRow
                                                                                                      :     :     +-  Scan parquet spark_catalog.default.store_sales [COMET: Native DataFusion scan does not support subqueries/dynamic pruning]
                                                                                                      :     :           +- ReusedSubquery
                                                                                                      :     +- BroadcastExchange
                                                                                                      :        +- CometColumnarToRow
                                                                                                      :           +- CometProject
                                                                                                      :              +- CometFilter
                                                                                                      :                 +- CometNativeScan parquet spark_catalog.default.store
                                                                                                      +- BroadcastExchange
                                                                                                         +- CometColumnarToRow
                                                                                                            +- CometProject
                                                                                                               +- CometFilter
                                                                                                                  +- CometNativeScan parquet spark_catalog.default.date_dim

Comet accelerated 54 out of 156 eligible operators (34%). Final plan contains 30 transitions between Spark and Comet.