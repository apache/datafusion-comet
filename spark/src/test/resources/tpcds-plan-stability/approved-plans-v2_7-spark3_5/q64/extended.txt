CometColumnarToRow
+- CometSort
   +- CometExchange
      +- CometProject
         +- CometSortMergeJoin
            :- CometSort
            :  +- CometColumnarExchange
            :     +- HashAggregate
            :        +- HashAggregate
            :           +- Project
            :              +- BroadcastHashJoin
            :                 :- Project
            :                 :  +- BroadcastHashJoin
            :                 :     :- Project
            :                 :     :  +- BroadcastHashJoin
            :                 :     :     :- Project
            :                 :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :- Project
            :                 :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :- Project
            :                 :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- CometSortMergeJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :- CometSort
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :  +- CometColumnarExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :     +- Project
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :        +- BroadcastHashJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :  +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :     +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :              +- SubqueryBroadcast
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :                 +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :                    +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :                       +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :              +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :                 +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :                    +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_returns
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometSort
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometHashAggregate
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- CometExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- CometHashAggregate
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- CometSortMergeJoin
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :- CometSort
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :  +- CometExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :     +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :        +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :           +- CometScan [native_iceberg_compat] parquet spark_catalog.default.catalog_sales
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- CometSort
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- CometExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                      +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                         +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                            +- CometScan [native_iceberg_compat] parquet spark_catalog.default.catalog_returns
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometProject
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
            :                 :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer
            :                 :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :                 :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
            :                 :     :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :     :           +- CometProject
            :                 :     :     :     :     :     :     :     :     :              +- CometFilter
            :                 :     :     :     :     :     :     :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_demographics
            :                 :     :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :     :           +- CometProject
            :                 :     :     :     :     :     :     :     :              +- CometFilter
            :                 :     :     :     :     :     :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_demographics
            :                 :     :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.promotion
            :                 :     :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.household_demographics
            :                 :     :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :     :           +- CometFilter
            :                 :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.household_demographics
            :                 :     :     :     :     +- BroadcastExchange
            :                 :     :     :     :        +- CometColumnarToRow
            :                 :     :     :     :           +- CometProject
            :                 :     :     :     :              +- CometFilter
            :                 :     :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_address
            :                 :     :     :     +- BroadcastExchange
            :                 :     :     :        +- CometColumnarToRow
            :                 :     :     :           +- CometProject
            :                 :     :     :              +- CometFilter
            :                 :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_address
            :                 :     :     +- BroadcastExchange
            :                 :     :        +- CometColumnarToRow
            :                 :     :           +- CometFilter
            :                 :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.income_band
            :                 :     +- BroadcastExchange
            :                 :        +- CometColumnarToRow
            :                 :           +- CometFilter
            :                 :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.income_band
            :                 +- BroadcastExchange
            :                    +- CometColumnarToRow
            :                       +- CometProject
            :                          +- CometFilter
            :                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
            +- CometSort
               +- CometColumnarExchange
                  +- HashAggregate
                     +- HashAggregate
                        +- Project
                           +- BroadcastHashJoin
                              :- Project
                              :  +- BroadcastHashJoin
                              :     :- Project
                              :     :  +- BroadcastHashJoin
                              :     :     :- Project
                              :     :     :  +- BroadcastHashJoin
                              :     :     :     :- Project
                              :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :- Project
                              :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :- Project
                              :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :- Project
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :  +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- CometSortMergeJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :- CometSort
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :  +- CometColumnarExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :     +- Project
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :        +- BroadcastHashJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :  +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :     +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :        +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :              +- SubqueryBroadcast
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :                 +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :                    +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :                       +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           :                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :           +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :              +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :                 +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        :                    +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_returns
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometSort
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometHashAggregate
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                    +- CometExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                       +- CometHashAggregate
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                          +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                             +- CometSortMergeJoin
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :- CometSort
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :  +- CometExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :     +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :        +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                :           +- CometScan [native_iceberg_compat] parquet spark_catalog.default.catalog_sales
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                +- CometSort
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                   +- CometExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                      +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                         +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     :                                            +- CometScan [native_iceberg_compat] parquet spark_catalog.default.catalog_returns
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                              :     :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :     :           +- CometProject
                              :     :     :     :     :     :     :     :     :     :     :     :     :              +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                              :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer
                              :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                              :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                              :     :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :     :           +- CometProject
                              :     :     :     :     :     :     :     :     :              +- CometFilter
                              :     :     :     :     :     :     :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_demographics
                              :     :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :     :           +- CometProject
                              :     :     :     :     :     :     :     :              +- CometFilter
                              :     :     :     :     :     :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_demographics
                              :     :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.promotion
                              :     :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :     :           +- CometFilter
                              :     :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.household_demographics
                              :     :     :     :     :     +- BroadcastExchange
                              :     :     :     :     :        +- CometColumnarToRow
                              :     :     :     :     :           +- CometFilter
                              :     :     :     :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.household_demographics
                              :     :     :     :     +- BroadcastExchange
                              :     :     :     :        +- CometColumnarToRow
                              :     :     :     :           +- CometProject
                              :     :     :     :              +- CometFilter
                              :     :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_address
                              :     :     :     +- BroadcastExchange
                              :     :     :        +- CometColumnarToRow
                              :     :     :           +- CometProject
                              :     :     :              +- CometFilter
                              :     :     :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.customer_address
                              :     :     +- BroadcastExchange
                              :     :        +- CometColumnarToRow
                              :     :           +- CometFilter
                              :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.income_band
                              :     +- BroadcastExchange
                              :        +- CometColumnarToRow
                              :           +- CometFilter
                              :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.income_band
                              +- BroadcastExchange
                                 +- CometColumnarToRow
                                    +- CometProject
                                       +- CometFilter
                                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item

Comet accelerated 138 out of 242 eligible operators (57%). Final plan contains 39 transitions between Spark and Comet.